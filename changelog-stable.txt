commit f6b977ba24f54aef6652e485e249299563efe9eb
Author: Brad Spengler <spender@grsecurity.net>
Date:   Fri Apr 13 16:45:12 2012 -0400

    Remove size_overflow checks from vmx_set_msr and kvm_set_msr_common

 arch/x86/include/asm/kvm_host.h |    2 +-
 arch/x86/kvm/vmx.c              |    1 -
 2 files changed, 1 insertions(+), 2 deletions(-)

commit 719c976838b078635923a4f7985f84582994ab52
Author: Oleg Nesterov <oleg@redhat.com>
Date:   Mon Apr 9 21:03:50 2012 +0200

    cred: copy_process() should clear child->replacement_session_keyring
    
    keyctl_session_to_parent(task) sets ->replacement_session_keyring,
    it should be processed and cleared by key_replace_session_keyring().
    
    However, this task can fork before it notices TIF_NOTIFY_RESUME and
    the new child gets the bogus ->replacement_session_keyring copied by
    dup_task_struct(). This is obviously wrong and, if nothing else, this
    leads to put_cred(already_freed_cred).
    
    change copy_creds() to clear this member. If copy_process() fails
    before this point the wrong ->replacement_session_keyring doesn't
    matter, exit_creds() won't be called.
    
    Cc: <stable@vger.kernel.org>
    Signed-off-by: Oleg Nesterov <oleg@redhat.com>
    Acked-by: David Howells <dhowells@redhat.com>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
    
    Conflicts:
    
    	kernel/cred.c

 kernel/cred.c |    2 ++
 1 files changed, 2 insertions(+), 0 deletions(-)

commit 40887a42590f38fe694147499524af726cc1e27e
Author: Jason Wessel <jason.wessel@windriver.com>
Date:   Thu Apr 12 12:49:17 2012 -0700

    panic: fix stack dump print on direct call to panic()
    
    Commit 6e6f0a1f0fa6 ("panic: don't print redundant backtraces on oops")
    causes a regression where no stack trace will be printed at all for the
    case where kernel code calls panic() directly while not processing an
    oops, and of course there are 100's of instances of this type of call.
    
    The original commit executed the check (!oops_in_progress), but this will
    always be false because just before the dump_stack() there is a call to
    bust_spinlocks(1), which does the following:
    
      void __attribute__((weak)) bust_spinlocks(int yes)
      {
    	if (yes) {
    		++oops_in_progress;
    
    The proper way to resolve the problem that original commit tried to
    solve is to avoid printing a stack dump from panic() when the either of
    the following conditions is true:
    
      1) TAINT_DIE has been set (this is done by oops_end())
         This indicates and oops has already been printed.
      2) oops_in_progress > 1
         This guards against the rare case where panic() is invoked
         a second time, or in between oops_begin() and oops_end()
    
    Signed-off-by: Jason Wessel <jason.wessel@windriver.com>
    Cc: Andi Kleen <ak@linux.intel.com>
    Cc: <stable@vger.kernel.org>	[3.3+]
    Signed-off-by: Andrew Morton <akpm@linux-foundation.org>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>

 kernel/panic.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit 26334c7beadf9b5970ebef2407731ca1975928cc
Author: Mathieu Desnoyers <mathieu.desnoyers@efficios.com>
Date:   Thu Apr 12 12:49:12 2012 -0700

    drivers/char/random.c: fix boot id uniqueness race
    
    /proc/sys/kernel/random/boot_id can be read concurrently by userspace
    processes.  If two (or more) user-space processes concurrently read
    boot_id when sysctl_bootid is not yet assigned, a race can occur making
    boot_id differ between the reads.  Because the whole point of the boot id
    is to be unique across a kernel execution, fix this by protecting this
    operation with a spinlock.
    
    Given that this operation is not frequently used, hitting the spinlock
    on each call should not be an issue.
    
    Signed-off-by: Mathieu Desnoyers <mathieu.desnoyers@efficios.com>
    Cc: "Theodore Ts'o" <tytso@mit.edu>
    Cc: Matt Mackall <mpm@selenic.com>
    Signed-off-by: Eric Dumazet <eric.dumazet@gmail.com>
    Cc: Greg Kroah-Hartman <greg@kroah.com>
    Signed-off-by: Andrew Morton <akpm@linux-foundation.org>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>

 drivers/char/random.c |   11 ++++++++---
 1 files changed, 8 insertions(+), 3 deletions(-)

commit 5a440b87c7c63e5a885d5f96d52b35d69fa66eee
Merge: 63c9ff2 6e6ac3c
Author: Brad Spengler <spender@grsecurity.net>
Date:   Mon Apr 9 17:03:45 2012 -0400

    Merge branch 'pax-stable' into grsec-stable

commit 6e6ac3c2789aa2f74af9f512e552c3a065f1f52e
Author: Brad Spengler <spender@grsecurity.net>
Date:   Mon Apr 9 17:03:02 2012 -0400

    Update to pax-linux-2.6.32.59-test158.patch

 arch/x86/kernel/kdebugfs.c |    2 ++
 arch/x86/mm/pgtable.c      |    4 ++++
 2 files changed, 6 insertions(+), 0 deletions(-)

commit 63c9ff2bf26de5dc709284af66983d64af0b8aed
Merge: 4c35a7c ddd693a
Author: Brad Spengler <spender@grsecurity.net>
Date:   Sun Apr 8 18:08:56 2012 -0400

    Merge branch 'pax-stable' into grsec-stable
    
    Conflicts:
    	mm/mmap.c

commit ddd693a5102b6e053fd7eb41dec841bd064a7924
Author: Brad Spengler <spender@grsecurity.net>
Date:   Sun Apr 8 18:07:35 2012 -0400

    Update to pax-linux-2.6.32.59-test157.patch

 arch/x86/kernel/ldt.c                       |    1 +
 arch/x86/kernel/tlb_uv.c                    |    2 +
 arch/x86/kvm/mmu.c                          |    2 +
 drivers/media/video/cpia.c                  |    1 +
 drivers/media/video/cpia2/cpia2_core.c      |    1 +
 drivers/media/video/cx231xx/cx231xx-audio.c |    2 +
 drivers/media/video/em28xx/em28xx-audio.c   |    2 +
 drivers/media/video/gspca/gspca.c           |    1 +
 drivers/media/video/meye.c                  |    1 +
 drivers/media/video/ov511.c                 |    2 +
 drivers/media/video/se401.c                 |    1 +
 drivers/media/video/stv680.c                |    1 +
 drivers/media/video/usbvideo/vicam.c        |    1 +
 drivers/media/video/videobuf-dma-sg.c       |    4 +
 drivers/media/video/videobuf-vmalloc.c      |    4 +
 drivers/media/video/w9968cf.c               |    2 +-
 drivers/net/chelsio/sge.c                   |    2 +
 drivers/net/cxgb3/sge.c                     |    2 +
 fs/binfmt_elf.c                             |    1 +
 fs/configfs/file.c                          |    2 +
 fs/sysfs/file.c                             |    2 +
 include/linux/kvm_host.h                    |    2 +-
 include/linux/mm_types.h                    |    4 +-
 init/do_mounts.h                            |    2 +-
 mm/mmap.c                                   |    5 +
 net/bridge/netfilter/ebt_ulog.c             |    1 +
 net/ipv4/netfilter/ip_tables.c              |    4 +
 net/ipv4/netfilter/ipt_ULOG.c               |    1 +
 net/ipv6/netfilter/ip6_tables.c             |    4 +
 sound/drivers/vx/vx_pcm.c                   |    1 +
 sound/pcmcia/pdaudiocf/pdaudiocf_pcm.c      |    1 +
 sound/usb/usbaudio.c                        |    1 +
 tools/gcc/size_overflow_hash1.h             | 2012 ++++++++++++++++++++++-----
 tools/gcc/size_overflow_hash2.h             |   24 +-
 tools/gcc/size_overflow_plugin.c            |   47 +-
 35 files changed, 1785 insertions(+), 361 deletions(-)

commit 4c35a7ca87711f9ffca8a694439ac3aaa4c779f7
Author: Brad Spengler <spender@grsecurity.net>
Date:   Sun Apr 8 18:04:03 2012 -0400

    Revert "Fix RLIMIT_AS accounting with brk randomization"
    
    This reverts commit 803069c97a11ac7a2dd6c1a0b441437ae711c8ed.

 fs/binfmt_elf.c |    2 +-
 mm/mmap.c       |    3 ---
 2 files changed, 1 insertions(+), 4 deletions(-)

commit 50696aa13c836d621d87e0ca15955e3ea554e887
Author: Brad Spengler <spender@grsecurity.net>
Date:   Sun Apr 8 18:03:50 2012 -0400

    Revert "Fix RLIMIT_AS checking with brk randomization"
    
    This reverts commit 0f2c6b5fcbae1edf1ec5e262aee88d40a8272d4d.

 fs/binfmt_elf.c |    2 --
 mm/mmap.c       |    5 +----
 2 files changed, 1 insertions(+), 6 deletions(-)

commit 5f28bcddf2646cb3de6a69d65f10c30707b8083a
Author: Brad Spengler <spender@grsecurity.net>
Date:   Sun Apr 8 18:03:29 2012 -0400

    Revert "Fix RLIMIT_AS checking with brk randomization"
    
    This reverts commit 99f21df37ebbcd2a642f9438dacd63343fcbf461.

 fs/binfmt_elf.c |    2 ++
 mm/mmap.c       |    2 +-
 2 files changed, 3 insertions(+), 1 deletions(-)

commit 0ae0ecebc365be11bacd58087038e7b38e0b6572
Author: Brad Spengler <spender@grsecurity.net>
Date:   Sun Apr 8 18:03:16 2012 -0400

    Revert "fix wraparound"
    
    This reverts commit def8ef9790858a20befe1805af78dea8dbe56546.

 fs/binfmt_elf.c |    3 +--
 1 files changed, 1 insertions(+), 2 deletions(-)

commit 43e869262e3c228da91a64bb941bfcecd46e520e
Author: Brad Spengler <spender@grsecurity.net>
Date:   Sun Apr 8 18:03:03 2012 -0400

    Revert "fake start_brk value before mmap is processed"
    
    This reverts commit bb93be2e87f25458e13c43ff321c36fa748eaba6.

 fs/binfmt_elf.c |    1 -
 1 files changed, 0 insertions(+), 1 deletions(-)

commit d5a8bba439ce0efd7340c707e9968a4d3bc8d0f6
Merge: 491867d a1d9451
Author: Brad Spengler <spender@grsecurity.net>
Date:   Sun Apr 8 16:11:57 2012 -0400

    Merge branch 'pax-stable' into grsec-stable

commit a1d94512b12eb1e9605194a7a822b3ea2cb143a9
Author: Brad Spengler <spender@grsecurity.net>
Date:   Sun Apr 8 16:11:22 2012 -0400

    Update to pax-linux-2.6.32.59-test156.patch

 arch/x86/kernel/tls.c            |    4 +-
 arch/x86/mm/pgtable.c            |   12 +-
 drivers/mtd/ubi/build.c          |   16 +-
 include/linux/mm_types.h         |    2 +-
 scripts/mod/modpost.c            |    2 +-
 scripts/tags.sh                  |    2 +-
 tools/gcc/kernexec_plugin.c      |    2 +-
 tools/gcc/size_overflow_plugin.c |  501 +++++++++++++++++++++-----------------
 8 files changed, 297 insertions(+), 244 deletions(-)

commit 491867d2cfae87045687ba36e006973562db065c
Author: Brad Spengler <spender@grsecurity.net>
Date:   Sun Apr 8 15:40:58 2012 -0400

    Always allow use of AF_UNSPEC for already-connected sockets to disconnect

 grsecurity/gracl_ip.c |    3 +++
 1 files changed, 3 insertions(+), 0 deletions(-)

commit 7729bad29806b17f42163b018be9c087edd31338
Author: Eric Dumazet <eric.dumazet@gmail.com>
Date:   Fri Apr 6 10:49:10 2012 +0200

    net: fix a race in sock_queue_err_skb()
    
    As soon as an skb is queued into socket error queue, another thread
    can consume it, so we are not allowed to reference skb anymore, or risk
    use after free.
    
    Signed-off-by: Eric Dumazet <eric.dumazet@gmail.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

 net/core/skbuff.c |    4 +++-
 1 files changed, 3 insertions(+), 1 deletions(-)

commit 1db2fc9aacec613c8459dce30983181ce71838a4
Author: Brad Spengler <spender@grsecurity.net>
Date:   Sun Apr 8 10:13:28 2012 -0400

    always allow admin to follow ptrace'd execs
    no need for task_lock

 grsecurity/gracl.c |   19 ++++++++++++++++---
 1 files changed, 16 insertions(+), 3 deletions(-)

commit 336845b2bd3dd3e2c63f7ef2d901b79548c60a19
Author: Brad Spengler <spender@grsecurity.net>
Date:   Sun Apr 8 07:04:45 2012 -0400

    Require CAP_SYS_ADMIN for /proc/sysrq-trigger

 drivers/char/sysrq.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit 626905f29e3c9bbef3fd4f9179e247e422d01b84
Author: Brad Spengler <spender@grsecurity.net>
Date:   Sun Apr 8 07:01:20 2012 -0400

    Require CAP_SYS_ADMIN for /sys/kernel/uevent_helper

 kernel/ksysfs.c |    2 ++
 1 files changed, 2 insertions(+), 0 deletions(-)

commit bb93be2e87f25458e13c43ff321c36fa748eaba6
Author: Brad Spengler <spender@grsecurity.net>
Date:   Fri Apr 6 19:45:36 2012 -0400

    fake start_brk value before mmap is processed

 fs/binfmt_elf.c |    1 +
 1 files changed, 1 insertions(+), 0 deletions(-)

commit def8ef9790858a20befe1805af78dea8dbe56546
Author: Brad Spengler <spender@grsecurity.net>
Date:   Fri Apr 6 18:56:24 2012 -0400

    fix wraparound
    
    Conflicts:
    
    	fs/binfmt_elf.c

 fs/binfmt_elf.c |    3 ++-
 1 files changed, 2 insertions(+), 1 deletions(-)

commit 99f21df37ebbcd2a642f9438dacd63343fcbf461
Author: Brad Spengler <spender@grsecurity.net>
Date:   Fri Apr 6 18:14:20 2012 -0400

    Fix RLIMIT_AS checking with brk randomization

 fs/binfmt_elf.c |    2 --
 mm/mmap.c       |    2 +-
 2 files changed, 1 insertions(+), 3 deletions(-)

commit 0f2c6b5fcbae1edf1ec5e262aee88d40a8272d4d
Author: Brad Spengler <spender@grsecurity.net>
Date:   Thu Apr 5 20:54:16 2012 -0400

    Fix RLIMIT_AS checking with brk randomization

 fs/binfmt_elf.c |    2 ++
 mm/mmap.c       |    5 ++++-
 2 files changed, 6 insertions(+), 1 deletions(-)

commit 803069c97a11ac7a2dd6c1a0b441437ae711c8ed
Author: Brad Spengler <spender@grsecurity.net>
Date:   Thu Apr 5 19:53:46 2012 -0400

    Fix RLIMIT_AS accounting with brk randomization
    
    Conflicts:
    
    	mm/mmap.c

 fs/binfmt_elf.c |    2 +-
 mm/mmap.c       |    3 +++
 2 files changed, 4 insertions(+), 1 deletions(-)

commit effbefd3bd6d1718fe830f30247e459ae94306e5
Author: Dan Carpenter <dan.carpenter@oracle.com>
Date:   Sat Mar 24 10:52:50 2012 +0300

    x86, tls: Off by one limit check
    
    These are used as offsets into an array of GDT_ENTRY_TLS_ENTRIES members
    so GDT_ENTRY_TLS_ENTRIES is one past the end of the array.
    
    Signed-off-by: Dan Carpenter <dan.carpenter@oracle.com>
    Link: http://lkml.kernel.org/r/20120324075250.GA28258@elgon.mountain
    Cc: <stable@vger.kernel.org>
    Signed-off-by: H. Peter Anvin <hpa@zytor.com>

 arch/x86/kernel/tls.c |    4 ++--
 1 files changed, 2 insertions(+), 2 deletions(-)

commit f5bb3d336d7b233a175ea8513f3ddb547609ec25
Author: Brad Spengler <spender@grsecurity.net>
Date:   Sun Mar 25 18:53:56 2012 -0400

    make const

 fs/dcache.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit 65c3acadbb73db2a7158230af93e4a0d37de1b70
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Mon Mar 19 16:19:53 2012 -0700

    vfs: get rid of batshit-insane pointless dentry hash calculations
    
    For some odd historical reason, the final mixing round for the dentry
    cache hash table lookup had an insane "xor with big constant" logic.  In
    two places.
    
    The big constant that is being xor'ed is GOLDEN_RATIO_PRIME, which is a
    fairly random-looking number that is designed to be *multiplied* with so
    that the bits get spread out over a whole long-word.
    
    But xor'ing with it is insane.  It doesn't really even change the hash -
    it really only shifts the hash around in the hash table.  To make
    matters worse, the insane big constant is different on 32-bit and 64-bit
    builds, even though the name hash bits we use are always 32-bit (and the
    bits from the pointer we mix in effectively are too).
    
    It's all total voodoo programming, in other words.
    
    Now, some testing and analysis of the hash chains shows that the rest of
    the hash function seems to be fairly good.  It does pick the right bits
    of the parent dentry pointer, for example, and while it's generally a
    bad idea to use an xor to mix down the upper bits (because if there is a
    repeating pattern, the xor can cause "destructive interference"), it
    seems to not have been a disaster.
    
    For example, replacing the hash with the normal "hash_long()" code (that
    uses the GOLDEN_RATIO_PRIME constant correctly, btw) actually just makes
    the hash worse.  The hand-picked hash knew which bits of the pointer had
    the highest entropy, and hash_long() ends up mixing bits less optimally
    at least in some trivial tests.
    
    So the hash function overall seems fine, it just has that really odd
    "shift result around by a constant xor".
    
    So get rid of the silly xor, and replace the down-mixing of the bits
    with an add instead of an xor that tends to not have the same kind of
    destructive interference issues.  Some stats on the resulting hash
    chains shows that they look statistically identical before and after,
    but the code is simpler and no longer makes you go "WTF?".
    
    Also, the incoming hash really is just "unsigned int", not a long, and
    there's no real point to worry about the high 26 bits of the dentry
    pointer for the 64-bit case, because they are all going to be identical
    anyway.
    
    So also change the hashing to be done in the more natural 'unsigned int'
    that is the real size of the actual hashed data anyway.
    
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
    
    Conflicts:
    
    	fs/dcache.c

 fs/dcache.c |    6 +++---
 1 files changed, 3 insertions(+), 3 deletions(-)

commit 3092cd4378943ed81d3bbf5c389ec97e0421beb8
Author: Dmitry Adamushko <dmitry.adamushko@gmail.com>
Date:   Thu Mar 22 21:39:25 2012 +0100

    x86-32: Fix endless loop when processing signals for kernel tasks
    
    The problem occurs on !CONFIG_VM86 kernels [1] when a kernel-mode task
    returns from a system call with a pending signal.
    
    A real-life scenario is a child of 'khelper' returning from a failed
    kernel_execve() in ____call_usermodehelper() [ kernel/kmod.c ].
    kernel_execve() fails due to a pending SIGKILL, which is the result of
    "kill -9 -1" (at least, busybox's init does it upon reboot).
    
    The loop is as follows:
    
    * syscall_exit_work:
     - work_pending:            // start_of_the_loop
     - work_notify_sig:
       - do_notify_resume()
         - do_signal()
           - if (!user_mode(regs)) return;
     - resume_userspace         // TIF_SIGPENDING is still set
     - work_pending             // so we call work_pending => goto
                                // start_of_the_loop
    
    More information can be found in another LKML thread:
    http://www.serverphorums.com/read.php?12,457826
    
    [1] the problem was also seen on MIPS.
    
    Signed-off-by: Dmitry Adamushko <dmitry.adamushko@gmail.com>
    Link: http://lkml.kernel.org/r/1332448765.2299.68.camel@dimm
    Cc: Oleg Nesterov <oleg@redhat.com>
    Cc: Roland McGrath <roland@hack.frob.com>
    Cc: Andrew Morton <akpm@linux-foundation.org>
    Cc: <stable@vger.kernel.org>
    Signed-off-by: H. Peter Anvin <hpa@zytor.com>

 arch/x86/kernel/entry_32.S |   17 ++++++++++-------
 1 files changed, 10 insertions(+), 7 deletions(-)

commit a154c18cbe88325f24ac14149c6a4e23f52f9eb3
Merge: 3166067 f86aad9
Author: Brad Spengler <spender@grsecurity.net>
Date:   Sun Mar 25 18:33:32 2012 -0400

    Merge branch 'pax-stable' into grsec-stable

commit f86aad96630478e3987a4b115a2c5af1f39edf77
Author: Brad Spengler <spender@grsecurity.net>
Date:   Sun Mar 25 18:33:18 2012 -0400

    Update to pax-linux-2.6.32.59-test155.patch

 fs/binfmt_elf.c |    8 ++++----
 1 files changed, 4 insertions(+), 4 deletions(-)

commit 31660670d1896830d0c39392a131d970a1bae28b
Author: Brad Spengler <spender@grsecurity.net>
Date:   Sat Mar 24 22:13:21 2012 -0400

    Backport L2TP fix for cilly
    http://lists.debian.org/debian-kernel/2011/12/msg00484.html

 drivers/net/pppol2tp.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit 22d074672125f6a246d65a77353206c59aa1385a
Merge: 5a975e9 b3f064e
Author: Brad Spengler <spender@grsecurity.net>
Date:   Sat Mar 24 19:37:19 2012 -0400

    Merge branch 'pax-stable' into grsec-stable

commit b3f064e6423ded0dcba59eecd1dfb05bd470c38d
Author: Brad Spengler <spender@grsecurity.net>
Date:   Sat Mar 24 19:36:57 2012 -0400

    Update to pax-linux-2.6.32.59-test154.patch
    reduces overcommit amount from recently increased brk entropy

 arch/arm/include/asm/atomic.h |    5 +++++
 fs/binfmt_elf.c               |   27 ++++++++++++++++++++++-----
 fs/bio.c                      |    2 +-
 3 files changed, 28 insertions(+), 6 deletions(-)

commit 5a975e95af53a673289b91bfb55927f087c809bf
Merge: 092dcb6 7cdca8e
Author: Brad Spengler <spender@grsecurity.net>
Date:   Thu Mar 22 19:02:29 2012 -0400

    Merge branch 'pax-stable' into grsec-stable

commit 7cdca8e93bd1da5b9bbba51df4f7215847584d22
Author: Brad Spengler <spender@grsecurity.net>
Date:   Thu Mar 22 19:01:45 2012 -0400

    Update to pax-linux-2.6.32.59-test153.patch

 arch/x86/include/asm/uaccess_32.h |    6 +++---
 arch/x86/include/asm/uaccess_64.h |    8 ++++----
 arch/x86/lib/usercopy_32.c        |    6 +++---
 arch/x86/lib/usercopy_64.c        |    8 ++++----
 4 files changed, 14 insertions(+), 14 deletions(-)

commit 092dcb6735f33f0d18072df70563cd44315b28c2
Author: Brad Spengler <spender@grsecurity.net>
Date:   Thu Mar 22 18:59:57 2012 -0400

    Use umode_t instead of mode_t

 grsecurity/gracl_fs.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit 566b256dd1cbcc88922a844ecebdd762e56d623e
Author: Brad Spengler <spender@grsecurity.net>
Date:   Thu Mar 22 18:56:48 2012 -0400

    Use umode_t instead of mode_t for umask type

 grsecurity/gracl_fs.c |    2 +-
 include/linux/gracl.h |    3 ++-
 2 files changed, 3 insertions(+), 2 deletions(-)

commit 3dd5abd5214d9ed2904d324c785e72e87bf8a2b1
Merge: 9176a87 c6ac106
Author: Brad Spengler <spender@grsecurity.net>
Date:   Wed Mar 21 20:13:42 2012 -0400

    Merge branch 'pax-stable' into grsec-stable

commit c6ac106b9ef3213892bf710ecd0ecb7a0f8821bf
Author: Brad Spengler <spender@grsecurity.net>
Date:   Wed Mar 21 20:13:23 2012 -0400

    Update to pax-linux-2.6.32.59-test152.patch

 arch/x86/kvm/x86.c            |    6 ++----
 include/asm-generic/uaccess.h |    1 -
 2 files changed, 2 insertions(+), 5 deletions(-)

commit 9176a87f2544c9fd30585685c03c5842c9e62a25
Author: Brad Spengler <spender@grsecurity.net>
Date:   Wed Mar 21 19:42:42 2012 -0400

    compile fix

 grsecurity/gracl.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit 03edf9eb83b4480bedfa23d556b67aff52f3ca66
Author: Brad Spengler <spender@grsecurity.net>
Date:   Wed Mar 21 19:34:56 2012 -0400

    Resolve some very tricky hash table manipulations that resulted in an infinite loop in certain
    uses of domains with particular hash collisions

 grsecurity/gracl.c |   62 +++++++++++++++++++++++++++++++++++++++++----------
 1 files changed, 50 insertions(+), 12 deletions(-)

commit 552418c6ff6c53e998627093f37c5fa174d46db6
Author: Brad Spengler <spender@grsecurity.net>
Date:   Tue Mar 20 20:25:49 2012 -0400

    zero kernel_role

 grsecurity/gracl.c |    1 +
 1 files changed, 1 insertions(+), 0 deletions(-)

commit 1b365b8b1a0e4db724b805b8fc5528ac33e7e0c7
Merge: 92afdf4 4045ead
Author: Brad Spengler <spender@grsecurity.net>
Date:   Tue Mar 20 19:10:11 2012 -0400

    Merge branch 'pax-stable' into grsec-stable

commit 4045eaddde5586993007853c5361b0410014656f
Author: Brad Spengler <spender@grsecurity.net>
Date:   Tue Mar 20 19:08:29 2012 -0400

    Temporary workaround for (most) size_overflow plugin false-positives
    Increase randomization for brk-managed heap to 21 bits
    Update to pax-linux-2.6.32.59-test151.patch

 arch/x86/include/asm/uaccess_32.h |    4 ++--
 arch/x86/include/asm/uaccess_64.h |    8 ++++----
 fs/binfmt_elf.c                   |    2 +-
 include/asm-generic/uaccess.h     |    4 ----
 4 files changed, 7 insertions(+), 11 deletions(-)

commit 92afdf49876fe40ab3bc6c513b96a7859c7667e5
Author: Brad Spengler <spender@grsecurity.net>
Date:   Tue Mar 20 18:58:53 2012 -0400

    compile fix

 grsecurity/gracl.c |    9 +++------
 1 files changed, 3 insertions(+), 6 deletions(-)

commit 2c803141acfcfd076cb932d7a87fca735a84ebaa
Author: Brad Spengler <spender@grsecurity.net>
Date:   Tue Mar 20 18:52:23 2012 -0400

    Require default and kernel role

 grsecurity/gracl.c |    3 +++
 1 files changed, 3 insertions(+), 0 deletions(-)

commit b7c346bcb1dc0362cd3280c1326c4e7329877248
Author: Brad Spengler <spender@grsecurity.net>
Date:   Tue Mar 20 18:47:28 2012 -0400

    Allow policies without special roles
    don't call free_variables in error path of copy_user_acl, we'll call it later (triggered by a policy without special roles)

 grsecurity/gracl.c |  113 +++++++++++++++++++---------------------------------
 1 files changed, 41 insertions(+), 72 deletions(-)

commit b700dd101238a1d1691ed2345447e0d631993fc3
Author: Ryusuke Konishi <konishi.ryusuke@lab.ntt.co.jp>
Date:   Fri Mar 16 17:08:39 2012 -0700

    nilfs2: fix NULL pointer dereference in nilfs_load_super_block()
    
    According to the report from Slicky Devil, nilfs caused kernel oops at
    nilfs_load_super_block function during mount after he shrank the
    partition without resizing the filesystem:
    
     BUG: unable to handle kernel NULL pointer dereference at 00000048
     IP: [<d0d7a08e>] nilfs_load_super_block+0x17e/0x280 [nilfs2]
     *pde = 00000000
     Oops: 0000 [#1] PREEMPT SMP
     ...
     Call Trace:
      [<d0d7a87b>] init_nilfs+0x4b/0x2e0 [nilfs2]
      [<d0d6f707>] nilfs_mount+0x447/0x5b0 [nilfs2]
      [<c0226636>] mount_fs+0x36/0x180
      [<c023d961>] vfs_kern_mount+0x51/0xa0
      [<c023ddae>] do_kern_mount+0x3e/0xe0
      [<c023f189>] do_mount+0x169/0x700
      [<c023fa9b>] sys_mount+0x6b/0xa0
      [<c04abd1f>] sysenter_do_call+0x12/0x28
     Code: 53 18 8b 43 20 89 4b 18 8b 4b 24 89 53 1c 89 43 24 89 4b 20 8b 43
     20 c7 43 2c 00 00 00 00 23 75 e8 8b 50 68 89 53 28 8b 54 b3 20 <8b> 72
     48 8b 7a 4c 8b 55 08 89 b3 84 00 00 00 89 bb 88 00 00 00
     EIP: [<d0d7a08e>] nilfs_load_super_block+0x17e/0x280 [nilfs2] SS:ESP 0068:ca9bbdcc
     CR2: 0000000000000048
    
    This turned out due to a defect in an error path which runs if the
    calculated location of the secondary super block was invalid.
    
    This patch fixes it and eliminates the reported oops.
    
    Reported-by: Slicky Devil <slicky.dvl@gmail.com>
    Signed-off-by: Ryusuke Konishi <konishi.ryusuke@lab.ntt.co.jp>
    Tested-by: Slicky Devil <slicky.dvl@gmail.com>
    Cc: <stable@vger.kernel.org>	[2.6.30+]
    Signed-off-by: Andrew Morton <akpm@linux-foundation.org>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>

 fs/nilfs2/the_nilfs.c |    1 +
 1 files changed, 1 insertions(+), 0 deletions(-)

commit 5672d417a051626d95d85de5153c02076b504cbc
Author: Thomas Gleixner <tglx@linutronix.de>
Date:   Fri Mar 9 20:55:10 2012 +0100

    x86: Derandom delay_tsc for 64 bit
    
    Commit f0fbf0abc093 ("x86: integrate delay functions") converted
    delay_tsc() into a random delay generator for 64 bit.  The reason is
    that it merged the mostly identical versions of delay_32.c and
    delay_64.c.  Though the subtle difference of the result was:
    
     static void delay_tsc(unsigned long loops)
     {
    -	unsigned bclock, now;
    +	unsigned long bclock, now;
    
    Now the function uses rdtscl() which returns the lower 32bit of the
    TSC. On 32bit that's not problematic as unsigned long is 32bit. On 64
    bit this fails when the lower 32bit are close to wrap around when
    bclock is read, because the following check
    
           if ((now - bclock) >= loops)
           	  	break;
    
    evaluated to true on 64bit for e.g. bclock = 0xffffffff and now = 0
    because the unsigned long (now - bclock) of these values results in
    0xffffffff00000001 which is definitely larger than the loops
    value. That explains Tvortkos observation:
    
    "Because I am seeing udelay(500) (_occasionally_) being short, and
     that by delaying for some duration between 0us (yep) and 491us."
    
    Make those variables explicitely u32 again, so this works for both 32
    and 64 bit.
    
    Reported-by: Tvrtko Ursulin <tvrtko.ursulin@onelan.co.uk>
    Signed-off-by: Thomas Gleixner <tglx@linutronix.de>
    Cc: stable@vger.kernel.org # >= 2.6.27
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>

 arch/x86/lib/delay.c |    4 ++--
 1 files changed, 2 insertions(+), 2 deletions(-)

commit b126508f5718c6a4b35414c6c351c7a9c5959191
Merge: 8d86e79 1b49f3c
Author: Brad Spengler <spender@grsecurity.net>
Date:   Sun Mar 18 13:02:57 2012 -0400

    Merge branch 'pax-stable' into grsec-stable

commit 1b49f3cdfbdc0048bcba385860de08c046409518
Author: Brad Spengler <spender@grsecurity.net>
Date:   Sun Mar 18 13:02:37 2012 -0400

    Update to pax-linux-2.6.32.59-test150.patch

 tools/gcc/colorize_plugin.c |  147 +++++++++++++++++++++++++++++++++++++++++++
 1 files changed, 147 insertions(+), 0 deletions(-)

commit 8d86e79dd59cb66dbb2c901c7a5becb7aa7494a6
Merge: 2f2cdf7 fcdef7b
Author: Brad Spengler <spender@grsecurity.net>
Date:   Sun Mar 18 12:55:35 2012 -0400

    Merge branch 'pax-stable' into grsec-stable

commit fcdef7bf28af43260197999b45cb848594c3f570
Merge: 0d2a9ed 6d22460
Author: Brad Spengler <spender@grsecurity.net>
Date:   Sun Mar 18 12:55:25 2012 -0400

    Merge branch 'linux-2.6.32.y' into pax-stable

commit 2f2cdf7082dda96b6d508bf344a455967c75c5ea
Merge: e8e1661 0d2a9ed
Author: Brad Spengler <spender@grsecurity.net>
Date:   Fri Mar 16 21:07:17 2012 -0400

    Merge branch 'pax-stable' into grsec-stable

commit 0d2a9ed427a1aa6e75bf961e6851357d33f96c0e
Author: Brad Spengler <spender@grsecurity.net>
Date:   Fri Mar 16 21:05:34 2012 -0400

    Update to pax-linux-2.6.32.58-test150.patch
    Introduce size_overflow plugin from Emese Revfy
    Many thanks to Emese for her hard work! :)

 Documentation/dontdiff                  |    1 +
 Makefile                                |    7 +-
 arch/x86/include/asm/floppy.h           |    1 +
 arch/x86/include/asm/kvm_host.h         |    8 +-
 arch/x86/include/asm/syscalls.h         |    2 +-
 arch/x86/include/asm/uaccess_32.h       |   37 +-
 arch/x86/include/asm/uaccess_64.h       |   37 +-
 arch/x86/kernel/cpu/mcheck/mce-inject.c |    2 +
 arch/x86/kernel/cpu/mtrr/if.c           |    2 +
 arch/x86/kernel/i387.c                  |   14 +
 arch/x86/kernel/ldt.c                   |    1 +
 arch/x86/kernel/microcode_intel.c       |    1 +
 arch/x86/kernel/ptrace.c                |    4 +
 arch/x86/kernel/setup_percpu.c          |    4 +
 arch/x86/kernel/tls.h                   |    2 +-
 arch/x86/kernel/vm86_32.c               |    3 +
 arch/x86/kvm/svm.c                      |    1 +
 arch/x86/kvm/vmx.c                      |    1 +
 arch/x86/kvm/x86.c                      |   10 +-
 arch/x86/lib/usercopy_32.c              |   12 +-
 arch/x86/lib/usercopy_64.c              |    8 +-
 crypto/ablkcipher.c                     |    4 +
 crypto/aead.c                           |    3 +
 crypto/blkcipher.c                      |    3 +
 crypto/cipher.c                         |    3 +
 drivers/acpi/battery.c                  |    3 +
 drivers/acpi/sbs.c                      |    3 +
 drivers/infiniband/hw/ipath/ipath_fs.c  |    2 +
 drivers/lguest/lguest_user.c            |    1 +
 drivers/media/video/videobuf-dma-sg.c   |    3 +
 drivers/media/video/videobuf-vmalloc.c  |    3 +
 drivers/mtd/ubi/build.c                 |    2 +-
 drivers/net/wireless/ath/ath5k/debug.c  |    3 +
 drivers/net/wireless/ath/ath9k/debug.c  |    2 +
 drivers/oprofile/oprofile_files.c       |    5 +
 drivers/oprofile/oprofilefs.c           |    1 +
 drivers/usb/core/message.c              |    4 +-
 fs/autofs/root.c                        |    3 +-
 fs/cifs/asn1.c                          |    3 +
 fs/exec.c                               |   10 +
 fs/ncpfs/ncplib_kernel.h                |    4 +-
 fs/seq_file.c                           |   12 +-
 fs/sysfs/bin.c                          |    2 +
 include/asm-generic/int-l64.h           |    2 -
 include/asm-generic/int-ll64.h          |    2 -
 include/asm-generic/uaccess.h           |   16 +
 include/linux/compiler-gcc4.h           |    3 +
 include/linux/compiler.h                |    3 +
 include/linux/crash_dump.h              |    2 +-
 include/linux/kvm_host.h                |    2 +-
 include/linux/moduleloader.h            |    2 +-
 include/linux/oprofile.h                |    2 +-
 include/linux/slab.h                    |   41 +--
 include/linux/slab_def.h                |    6 +-
 include/linux/slob_def.h                |    5 +-
 include/linux/slub_def.h                |    8 +-
 include/linux/uaccess.h                 |    2 +-
 include/linux/vmalloc.h                 |   95 +---
 lib/parser.c                            |    2 +-
 mm/vmalloc.c                            |    7 -
 net/ipv4/netfilter/arp_tables.c         |    7 +
 net/ipv4/netfilter/ip_tables.c          |    6 +
 net/ipv4/netfilter/nf_nat_snmp_basic.c  |    6 +-
 net/ipv6/netfilter/ip6_tables.c         |    7 +
 security/Kconfig                        |   14 +-
 tools/gcc/Makefile                      |    3 +
 tools/gcc/size_overflow_hash1.h         | 1055 +++++++++++++++++++++++++++++++
 tools/gcc/size_overflow_hash2.h         |   14 +
 tools/gcc/size_overflow_plugin.c        | 1042 ++++++++++++++++++++++++++++++
 tools/gcc/stackleak_plugin.c            |    4 +-
 70 files changed, 2396 insertions(+), 199 deletions(-)

commit e8e1661d3e1fc0f5f9ade35bc4f11b7109042435
Merge: e6ce86e f892d75
Author: Brad Spengler <spender@grsecurity.net>
Date:   Thu Mar 15 20:44:49 2012 -0400

    Merge branch 'pax-stable' into grsec-stable

commit f892d7567ae8ee6916093d7353fc3d5122424f24
Author: Brad Spengler <spender@grsecurity.net>
Date:   Thu Mar 15 20:44:30 2012 -0400

    Update to pax-linux-2.6.32.58-test148.patch

 include/asm-generic/local.h  |    1 +
 tools/gcc/stackleak_plugin.c |   41 +++++++++++++----------------------------
 2 files changed, 14 insertions(+), 28 deletions(-)

commit e6ce86e41acc7bd19e07ee8594394cbecf1adb63
Author: Brad Spengler <spender@grsecurity.net>
Date:   Tue Mar 13 18:19:41 2012 -0400

    Add backported be2net driver for BladeEngine 10GbE card used in HP blade servers
    Fix compilation of driver and make compatible with PaX
    source tarball was hp-be2net-4.0.479.0.tar.gz from:
    ftp://ftp.hp.com/pub/softlib2/software1/pubsw-linux/p834914788/v72405/
    2/2/12

 drivers/net/benet/Makefile     |    6 +-
 drivers/net/benet/be.h         |  390 ++++-
 drivers/net/benet/be_cmds.c    | 2049 ++++++++++++++++++++---
 drivers/net/benet/be_cmds.h    | 1001 ++++++++++--
 drivers/net/benet/be_compat.c  |  630 +++++++
 drivers/net/benet/be_compat.h  |  621 +++++++
 drivers/net/benet/be_ethtool.c |  842 ++++++++--
 drivers/net/benet/be_hw.h      |  351 ++++-
 drivers/net/benet/be_main.c    | 3539 ++++++++++++++++++++++++++++++----------
 drivers/net/benet/be_misc.c    |  106 ++
 drivers/net/benet/be_proc.c    |  513 ++++++
 drivers/net/benet/version.h    |   51 +
 include/linux/skbuff.h         |   16 +
 13 files changed, 8631 insertions(+), 1484 deletions(-)

commit 3d5fb2b1fb3e86f7e74d4c011a8fa6d4596767c0
Author: Brad Spengler <spender@grsecurity.net>
Date:   Tue Mar 13 17:45:05 2012 -0400

    Backport LSI 3ware SAS/SATA-RAID driver
    Backport paravirt SCSI driver for VMware's virtual HBA

 MAINTAINERS               |    8 +
 drivers/scsi/3w-sas.c     | 1933 +++++++++++++++++++++++++++++++++++++++++++++
 drivers/scsi/3w-sas.h     |  396 +++++++++
 drivers/scsi/Kconfig      |   19 +
 drivers/scsi/Makefile     |    2 +
 drivers/scsi/vmw_pvscsi.c | 1401 ++++++++++++++++++++++++++++++++
 drivers/scsi/vmw_pvscsi.h |  397 ++++++++++
 include/scsi/scsi_host.h  |    6 +
 8 files changed, 4162 insertions(+), 0 deletions(-)

commit 97184e329c4834f2f260fcbf4bf586de1b2d8fb5
Author: Brad Spengler <spender@grsecurity.net>
Date:   Tue Mar 13 17:32:02 2012 -0400

    add colorize plugin

 tools/gcc/colorize_plugin.c |  147 +++++++++++++++++++++++++++++++++++++++++++
 1 files changed, 147 insertions(+), 0 deletions(-)

commit a94359164c627ad70aab734d356b5c41d5ec9baf
Merge: ff3cefb 7a5b5f6
Author: Brad Spengler <spender@grsecurity.net>
Date:   Tue Mar 13 17:31:48 2012 -0400

    Merge branch 'pax-stable' into grsec-stable
    
    Conflicts:
    	fs/exec.c
    	security/Kconfig

commit 7a5b5f6c6975ffa07249855e2afffa7c7f594450
Author: Brad Spengler <spender@grsecurity.net>
Date:   Tue Mar 13 17:29:06 2012 -0400

    Update to pax-linux-2.6.32.58-test147.patch

 Documentation/dontdiff                  |    1 +
 Makefile                                |    4 +-
 arch/arm/include/asm/atomic.h           |  164 ++++++++++++++++++++++++++++++-
 arch/arm/include/asm/cache.h            |    2 +-
 arch/arm/include/asm/system.h           |   11 ++-
 arch/arm/kernel/process.c               |    6 +-
 arch/arm/kernel/setup.c                 |    2 +-
 arch/arm/kernel/vmlinux.lds.S           |    4 +
 arch/arm/lib/copy_page.S                |    1 +
 arch/arm/mm/fault.c                     |   14 +++
 arch/powerpc/kernel/irq.c               |   10 +-
 arch/sparc/include/asm/atomic.h         |    1 -
 arch/sparc/include/asm/atomic_32.h      |    2 +
 arch/x86/kernel/entry_64.S              |    2 +-
 fs/exec.c                               |    2 +-
 include/asm-generic/emergency-restart.h |    2 +-
 include/linux/prefetch.h                |    1 +
 include/linux/sched.h                   |    4 +-
 kernel/exit.c                           |    2 +-
 kernel/module.c                         |    2 +-
 mm/mmap.c                               |   11 ++-
 net/ipv6/xfrm6_tunnel.c                 |    2 +-
 security/Kconfig                        |    2 +-
 tools/gcc/Makefile                      |    2 +
 tools/gcc/stackleak_plugin.c            |    4 +-
 25 files changed, 232 insertions(+), 26 deletions(-)

commit ff3cefbd0ae5ac9ce4c4c71bdc72a0d6ea2eeecb
Merge: 3dbbafe 0f17ad8e
Author: Brad Spengler <spender@grsecurity.net>
Date:   Mon Mar 12 18:05:05 2012 -0400

    Merge branch 'pax-stable' into grsec-stable

commit 0f17ad8e070b85769823443fcd8c6173f29587f1
Author: Brad Spengler <spender@grsecurity.net>
Date:   Sun Mar 11 21:10:20 2012 -0400

    Fix ARM compilation while waiting for new PaX patch

 arch/arm/include/asm/cacheflush.h |    4 ++--
 arch/arm/include/asm/page.h       |    2 +-
 arch/arm/kernel/setup.c           |    6 +++---
 3 files changed, 6 insertions(+), 6 deletions(-)

commit 3dbbafeb7c01010ce35ad795e2a9cba5b5d57098
Merge: 7b9ded6 505c298
Author: Brad Spengler <spender@grsecurity.net>
Date:   Sun Mar 11 21:10:44 2012 -0400

    Merge branch 'pax-stable' into grsec-stable

commit 505c29854744a3ddefa6401ef8a05f2e4e254447
Author: Brad Spengler <spender@grsecurity.net>
Date:   Sun Mar 11 21:10:20 2012 -0400

    Fix ARM compilation while waiting for new PaX patch

 arch/arm/include/asm/cacheflush.h |    4 ++--
 arch/arm/include/asm/page.h       |    2 +-
 arch/arm/kernel/setup.c           |    6 +++---
 3 files changed, 6 insertions(+), 6 deletions(-)

commit 7b9ded6de0ab5de306417770283bf16cd701de35
Author: Brad Spengler <spender@grsecurity.net>
Date:   Sun Mar 11 12:55:56 2012 -0400

    Use &per_cpu instead of per_cpu_ptr

 include/linux/sched.h |    6 ++++--
 1 files changed, 4 insertions(+), 2 deletions(-)

commit 6ef65bf93136f0c3d8814bdb5999c920cd974855
Author: Brad Spengler <spender@grsecurity.net>
Date:   Sun Mar 11 11:01:33 2012 -0400

    Allow 4096 CPUs

 include/linux/sched.h |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit fd6dc475c468a04780dfcc4f69d09f0b9fe01c69
Author: Brad Spengler <spender@grsecurity.net>
Date:   Sun Mar 11 10:25:58 2012 -0400

    Use a per-cpu 48-bit counter instead of a global atomic64
    Initialize each counter to have the cpu number in the lower 16 bits
    instead of incrementing the counter each time by 1, perform the increments
    above the cpu number so that wrapping/exhausting the counter doesn't corrupt
    any state
    idea from PaX Team
    
    this version can't use this_cpu_add_return, so use something equivalent
    and make it available for fs/compat.c as well

 fs/compat.c           |    8 +-------
 fs/exec.c             |   17 +++++++++++++----
 include/linux/sched.h |   15 +++++++++++++++
 3 files changed, 29 insertions(+), 11 deletions(-)

commit a4d89db00d0cad860f2a19ce5a47f142e636fa03
Author: Brad Spengler <spender@grsecurity.net>
Date:   Sat Mar 10 20:22:51 2012 -0500

    Special vnsec edition! :)
    Further reduce argv/env allowance for suid/sgid apps to 512KB
    Clamp suid/sgid stack resource limit to 8MB (preventing compat mmap layout fallback/too large stack gap)
    Clear 3GB personality on suid/sgid binaries
    Restore 4 bits entropy in the lowest bits of arg/env strings (now 28 bits on x86, 39 bits on x64)
      with the main purpose of throwing off program stack -> arg/env alignment
    Update documentation

 fs/compat.c                 |   57 +++++++++++++++++++++-----------------
 fs/exec.c                   |   64 ++++++++++++++++++++++++-------------------
 grsecurity/Kconfig          |   15 ++++++----
 include/linux/personality.h |    1 +
 4 files changed, 78 insertions(+), 59 deletions(-)

commit e446f370b76e2eaa7cfbba40f8c3d63905d030a0
Author: Brad Spengler <spender@grsecurity.net>
Date:   Sat Mar 10 20:09:55 2012 -0500

    Resolve skbuff.h warnings that turn into errors during compilation in
    the grsecurity directory with -Werror

 arch/alpha/include/asm/cache.h                     |    5 +++--
 arch/arm/include/asm/cache.h                       |    4 +++-
 arch/avr32/include/asm/cache.h                     |    4 +++-
 arch/blackfin/include/asm/cache.h                  |    4 +++-
 arch/cris/include/arch-v10/arch/cache.h            |    3 ++-
 arch/cris/include/arch-v32/arch/cache.h            |    3 ++-
 arch/frv/include/asm/cache.h                       |    3 ++-
 arch/h8300/include/asm/cache.h                     |    4 +++-
 arch/ia64/include/asm/cache.h                      |    3 ++-
 arch/m32r/include/asm/cache.h                      |    4 +++-
 arch/m68k/include/asm/cache.h                      |    4 +++-
 arch/microblaze/include/asm/cache.h                |    3 ++-
 arch/mips/include/asm/cache.h                      |    3 ++-
 arch/mn10300/proc-mn103e010/include/proc/cache.h   |    4 +++-
 arch/parisc/include/asm/cache.h                    |    5 +++--
 arch/powerpc/include/asm/cache.h                   |    3 ++-
 arch/s390/include/asm/cache.h                      |    4 +++-
 arch/score/include/asm/cache.h                     |    4 +++-
 arch/sh/include/asm/cache.h                        |    3 ++-
 arch/sparc/include/asm/cache.h                     |    4 +++-
 arch/um/include/asm/cache.h                        |    3 ++-
 arch/xtensa/variants/dc232b/include/variant/core.h |    2 +-
 arch/xtensa/variants/fsf/include/variant/core.h    |    3 ++-
 arch/xtensa/variants/s6000/include/variant/core.h  |    3 ++-
 24 files changed, 59 insertions(+), 26 deletions(-)

commit e24b1e34543c3e76e6b03383e6f6ead00a9a8bcd
Author: Mikulas Patocka <mpatocka@redhat.com>
Date:   Sun Mar 4 19:52:03 2012 -0500

    mm: fix find_vma_prev
    
    Commit 6bd4837de96e ("mm: simplify find_vma_prev()") broke memory
    management on PA-RISC.
    
    After application of the patch, programs that allocate big arrays on the
    stack crash with segfault, for example, this will crash if compiled
    without optimization:
    
      int main()
      {
    	char array[200000];
    	array[199999] = 0;
    	return 0;
      }
    
    The reason is that PA-RISC has up-growing stack and the stack is usually
    the last memory area.  In the above example, a page fault happens above
    the stack.
    
    Previously, if we passed too high address to find_vma_prev, it returned
    NULL and stored the last VMA in *pprev.  After "simplify find_vma_prev"
    change, it stores NULL in *pprev.  Consequently, the stack area is not
    found and it is not expanded, as it used to be before the change.
    
    This patch restores the old behavior and makes it return the last VMA in
    *pprev if the requested address is higher than address of any other VMA.
    
    Signed-off-by: Mikulas Patocka <mpatocka@redhat.com>
    Acked-by: KOSAKI Motohiro <kosaki.motohiro@jp.fujitsu.com>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>

 mm/mmap.c |   12 ++++++++++--
 1 files changed, 10 insertions(+), 2 deletions(-)

commit cc92173df9e39be74bef7c8577e750d16d272f68
Author: Tyler Hicks <tyhicks@linux.vnet.ibm.com>
Date:   Wed Feb 15 11:32:31 2012 -0700

    eCryptfs: Remove mmap from directory operations
    
    BugLink: http://bugs.launchpad.net/bugs/948139
    
    backported from 38e3eaeedcac75360af8a92e7b66956ec4f334e5
    
    Adrian reported that mkfontscale didn't work inside of eCryptfs mounts.
    Strace revealed the following:
    
    open("./", O_RDONLY|O_NONBLOCK|O_LARGEFILE|O_DIRECTORY|O_CLOEXEC) = 3
    fcntl64(3, F_GETFD) = 0x1 (flags FD_CLOEXEC)
    open("./fonts.scale", O_WRONLY|O_CREAT|O_TRUNC, 0666) = 4
    getdents(3, /* 80 entries */, 32768) = 2304
    open("./.", O_RDONLY) = 5
    fcntl64(5, F_SETFD, FD_CLOEXEC) = 0
    fstat64(5, {st_mode=S_IFDIR|0755, st_size=16384, ...}) = 0
    mmap2(NULL, 16384, PROT_READ, MAP_PRIVATE, 5, 0) = 0xb7fcf000
    close(5) = 0
     --- SIGBUS (Bus error) @ 0 (0) ---
     +++ killed by SIGBUS +++
    
    The mmap2() on a directory was successful, resulting in a SIGBUS
    signal later.  This patch removes mmap() from the list of possible
    ecryptfs_dir_fops so that mmap() isn't possible on eCryptfs directory
    files.
    
    http://bugs.launchpad.net/bugs/400443
    
    Reported-by: Adrian C. <anrxc@sysphere.org>
    Signed-off-by: Tyler Hicks <tyhicks@linux.vnet.ibm.com>
    Signed-off-by: Colin Ian King <colin.king@canonical.com>
    Signed-off-by: Tim Gardner <tim.gardner@canonical.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
    Signed-off-by: Stefan Bader <stefan.bader@canonical.com>

 fs/ecryptfs/file.c |    1 -
 1 files changed, 0 insertions(+), 1 deletions(-)

commit 7bb67e19f42d4926f1cd1b4edef4eddb32d83fbf
Author: Al Viro <viro@ZenIV.linux.org.uk>
Date:   Mon Mar 5 06:39:47 2012 +0000

    VM_GROWS{UP,DOWN} shouldn't be set on shmem VMAs
    
    Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>

 mm/mmap.c |    2 ++
 1 files changed, 2 insertions(+), 0 deletions(-)

commit c99d92183b7f426ca00c844642bea2a948b2e6ea
Author: Al Viro <viro@ZenIV.linux.org.uk>
Date:   Mon Mar 5 06:38:42 2012 +0000

    aout: move setup_arg_pages() prior to reading/mapping the binary
    
    Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>

 arch/x86/ia32/ia32_aout.c |   14 +++++++-------
 fs/binfmt_aout.c          |   14 +++++++-------
 2 files changed, 14 insertions(+), 14 deletions(-)

commit 940612508a948143c7f7c3032f7ca08933d3f9ba
Author: Hugh Dickins <hughd@google.com>
Date:   Tue Mar 6 12:28:52 2012 -0800

    mmap: EINVAL not ENOMEM when rejecting VM_GROWS
    
    Currently error is -ENOMEM when rejecting VM_GROWSDOWN|VM_GROWSUP
    from shared anonymous: hoist the file case's -EINVAL up for both.
    
    Signed-off-by: Hugh Dickins <hughd@google.com>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>

 mm/mmap.c |    3 ++-
 1 files changed, 2 insertions(+), 1 deletions(-)

commit 72238082f7e7200a0f153f82f75e4b1ed365a8e7
Author: H. Peter Anvin <hpa@zytor.com>
Date:   Fri Mar 2 10:43:48 2012 -0800

    regset: Prevent null pointer reference on readonly regsets
    
    The regset common infrastructure assumed that regsets would always
    have .get and .set methods, but not necessarily .active methods.
    Unfortunately people have since written regsets without .set methods.
    
    Rather than putting in stub functions everywhere, handle regsets with
    null .get or .set methods explicitly.
    
    Signed-off-by: H. Peter Anvin <hpa@zytor.com>
    Reviewed-by: Oleg Nesterov <oleg@redhat.com>
    Acked-by: Roland McGrath <roland@hack.frob.com>
    Cc: <stable@vger.kernel.org>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>

 fs/binfmt_elf.c        |    2 +-
 include/linux/regset.h |    6 ++++++
 2 files changed, 7 insertions(+), 1 deletions(-)

commit 58b17f2a661e8a4abb8a6f007f4fced154588a85
Author: Brad Spengler <spender@grsecurity.net>
Date:   Mon Mar 5 18:12:57 2012 -0500

    Fix compiler errors reported on forums

 grsecurity/gracl.c |    5 ++---
 1 files changed, 2 insertions(+), 3 deletions(-)

commit 8c85de5598be91cc05b97c35a84bc24c1e127b36
Merge: 56ce5ec 0e7c630
Author: Brad Spengler <spender@grsecurity.net>
Date:   Mon Mar 5 17:39:40 2012 -0500

    Merge branch 'pax-stable' into grsec-stable

commit 0e7c6300c63fe7073cf93f733a3c8b56a283a6b8
Author: Brad Spengler <spender@grsecurity.net>
Date:   Mon Mar 5 17:39:04 2012 -0500

    Update to pax-linux-2.6.32.58-test144.patch

 tools/gcc/Makefile |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit 56ce5ec6a493d17a1038767acf82e2909e1267b1
Merge: edae9fb e6b850a
Author: Brad Spengler <spender@grsecurity.net>
Date:   Mon Mar 5 17:27:37 2012 -0500

    Merge branch 'pax-stable' into grsec-stable
    
    Conflicts:
    	fs/ecryptfs/main.c

commit e6b850a5c44840d7a7c3c22d11c00d98dc73e2a6
Merge: 94055dc 51c9aee
Author: Brad Spengler <spender@grsecurity.net>
Date:   Mon Mar 5 17:26:54 2012 -0500

    Merge branch 'linux-2.6.32.y' into pax-stable

commit edae9fb9d3092430980868b6ebcc51794c0dff79
Author: Louis Rilling <louis.rilling@kerlabs.com>
Date:   Thu Mar 1 14:45:42 2012 +0000

    block: Fix io_context leak after clone with CLONE_IO
    
    With CLONE_IO, copy_io() increments both ioc->refcount and ioc->nr_tasks.
    However exit_io_context() only decrements ioc->refcount if ioc->nr_tasks
    reaches 0.
    
    Always call put_io_context() in exit_io_context().
    
    Signed-off-by: Louis Rilling <louis.rilling@kerlabs.com>
    Signed-off-by: Jens Axboe <jens.axboe@oracle.com>
    
    (cherry picked from commit 61cc74fbb87af6aa551a06a370590c9bc07e29d9)
    CVE-2012-0879
    BugLink: http://bugs.launchpad.net/bugs/940743
    Signed-off-by: Andy Whitcroft <apw@canonical.com>
    Acked-by: Herton Krzesinski <herton.krzesinski@canonical.com>
    Acked-by: Stefan Bader <stefan.bader@canonical.com>
    Signed-off-by: Tim Gardner <tim.gardner@canonical.com>

 block/blk-ioc.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit 4e88917a4fc4daaf99492af8c6c811a83c016cab
Author: Louis Rilling <louis.rilling@kerlabs.com>
Date:   Thu Mar 1 14:45:43 2012 +0000

    block: Fix io_context leak after failure of clone with CLONE_IO
    
    With CLONE_IO, parent's io_context->nr_tasks is incremented, but never
    decremented whenever copy_process() fails afterwards, which prevents
    exit_io_context() from calling IO schedulers exit functions.
    
    Give a task_struct to exit_io_context(), and call exit_io_context() instead of
    put_io_context() in copy_process() cleanup path.
    
    Signed-off-by: Louis Rilling <louis.rilling@kerlabs.com>
    Signed-off-by: Jens Axboe <jens.axboe@oracle.com>
    
    (cherry picked from commit b69f2292063d2caf37ca9aec7d63ded203701bf3)
    CVE-2012-0879
    BugLink: http://bugs.launchpad.net/bugs/940743
    Signed-off-by: Andy Whitcroft <apw@canonical.com>
    Acked-by: Herton Krzesinski <herton.krzesinski@canonical.com>
    Acked-by: Stefan Bader <stefan.bader@canonical.com>
    Signed-off-by: Tim Gardner <tim.gardner@canonical.com>

 block/blk-ioc.c           |   10 +++++-----
 include/linux/iocontext.h |    5 +++--
 kernel/exit.c             |    2 +-
 kernel/fork.c             |    3 ++-
 4 files changed, 11 insertions(+), 9 deletions(-)

commit 47b6a32c17f13f1266c9e1e894e2663e6b3d5bf1
Author: Tim Gardner <tim.gardner@canonical.com>
Date:   Thu Mar 1 16:52:42 2012 +0000

    eCryptfs: Handle failed metadata read in lookup
    
    When failing to read the lower file's crypto metadata during a lookup,
    eCryptfs must continue on without throwing an error. For example, there
    may be a plaintext file in the lower mount point that the user wants to
    delete through the eCryptfs mount.
    
    If an error is encountered while reading the metadata in lookup(), the
    eCryptfs inode's size could be incorrect. We must be sure to reread the
    plaintext inode size from the metadata when performing an open() or
    setattr(). The metadata is already being read in those paths, so this
    adds minimal performance overhead.
    
    This patch introduces a flag which will track whether or not the
    plaintext inode size has been read so that an incorrect i_size can be
    fixed in the open() or setattr() paths.
    
    BugLink: http://bugs.launchpad.net/bugs/509180
    
    Cc: <stable@kernel.org>
    Signed-off-by: Tyler Hicks <tyhicks@linux.vnet.ibm.com>
    
    (backported from 3aeb86ea4cd15f728147a3bd5469a205ada8c767)
    Signed-off-by: Tim Gardner <tim.gardner@canonical.com>
    Acked-by: Leann Ogasawara <leann.ogasawara@canonical.com>
    Acked-by: Stefan Bader <stefan.bader@canonical.com>
    Acked-by: Brad Figg <brad.figg@canonical.com>
    Acked-by: Herton Krzesinski <herton.krzesinski@canonical.com>

 fs/ecryptfs/crypto.c          |   21 +++++++++++++++++++++
 fs/ecryptfs/ecryptfs_kernel.h |    2 ++
 fs/ecryptfs/file.c            |    3 ++-
 fs/ecryptfs/inode.c           |   18 +++---------------
 4 files changed, 28 insertions(+), 16 deletions(-)

commit 2ee4a1b8c427d8719b45d87fd66956d2ee080a26
Author: Brad Spengler <spender@grsecurity.net>
Date:   Fri Mar 2 21:32:37 2012 -0500

    Fix memory leak on logged exec_id check failure in /proc/pid/statm
    Thanks to Djalal Harouni for the report

 fs/proc/array.c |    3 ++-
 1 files changed, 2 insertions(+), 1 deletions(-)

commit 5533e59b7d5efb37d7bbfd45bb1fa7dd27c54e2e
Merge: 8066abf 94055dc
Author: Brad Spengler <spender@grsecurity.net>
Date:   Fri Mar 2 18:45:53 2012 -0500

    Merge branch 'pax-stable' into grsec-stable

commit 94055dc1526191f46a6ba2c8efe38f451ddc1546
Author: Brad Spengler <spender@grsecurity.net>
Date:   Fri Mar 2 18:45:28 2012 -0500

    Backport changes between test18 and test19 of PaX's 3.2.9 patch

 fs/binfmt_elf.c              |    2 +-
 tools/gcc/stackleak_plugin.c |   59 ++++++++++++++++++++++++++++++++----------
 2 files changed, 46 insertions(+), 15 deletions(-)

commit 8066abf18c2136a09903753de821e8a96ad69544
Author: Tyler Hicks <tyhicks@linux.vnet.ibm.com>
Date:   Fri Apr 29 16:26:27 2011 -0500

    eCryptfs: Clear i_nlink in rmdir
    
    BugLink: http://bugs.launchpad.net/bugs/723518
    
    eCryptfs wasn't clearing the eCryptfs inode's i_nlink after a successful
    vfs_rmdir() on the lower directory. This resulted in the inode evict and
    destroy paths to be missed.
    
    https://bugs.launchpad.net/ecryptfs/+bug/723518
    
    Signed-off-by: Tyler Hicks <tyhicks@linux.vnet.ibm.com>
    Cc: <stable@kernel.org>
    (cherry picked from commit 07850552b92b3637fa56767b5e460b4238014447)
    Signed-off-by: Colin King <colin.king@canonical.com>
    Acked-by: Herton Krzesinski <herton.krzesinski@canonical.com>
    Signed-off-by: Tim Gardner <tim.gardner@canonical.com>

 fs/ecryptfs/inode.c |    2 ++
 1 files changed, 2 insertions(+), 0 deletions(-)

commit 8af3b1dc00f0eab6829b55306c7daddd8bcbe3cd
Author: Tyler Hicks <tyhicks@linux.vnet.ibm.com>
Date:   Tue Apr 12 11:21:36 2011 -0500

    eCryptfs: Remove extra d_delete in ecryptfs_rmdir
    
    BugLink: http://bugs.launchpad.net/bugs/723518
    
    vfs_rmdir() already calls d_delete() on the lower dentry. That was being
    duplicated in ecryptfs_rmdir() and caused a NULL pointer dereference
    when NFSv3 was the lower filesystem.
    
    Signed-off-by: Tyler Hicks <tyhicks@linux.vnet.ibm.com>
    (cherry picked from commit 35ffa948b2f7bdf79e488cd496232935d095087a)
    Signed-off-by: Colin King <colin.king@canonical.com>
    Acked-by: Herton Krzesinski <herton.krzesinski@canonical.com>
    Signed-off-by: Tim Gardner <tim.gardner@canonical.com>

 fs/ecryptfs/inode.c |    2 --
 1 files changed, 0 insertions(+), 2 deletions(-)

commit d793be93356a915a3e22ae3c08c759b47c3d0489
Author: Andy Whitcroft <apw@canonical.com>
Date:   Thu Feb 16 17:11:07 2012 +0000

    ecryptfs: read on a directory should return EISDIR if not supported
    
    read() calls against a file descriptor connected to a directory are
    incorrectly returning EINVAL rather than EISDIR:
    
      [EISDIR]
        [XSI] [Option Start] The fildes argument refers to a directory and the
        implementation does not allow the directory to be read using read()
        or pread(). The readdir() function should be used instead. [Option End]
    
    This occurs because we do not have a .read operation defined for
    ecryptfs directories.  Connect this up to generic_read_dir().
    
    BugLink: http://bugs.launchpad.net/bugs/719691
    Signed-off-by: Andy Whitcroft <apw@canonical.com>
    Signed-off-by: Tyler Hicks <tyhicks@linux.vnet.ibm.com>
    (cherry picked from commit 323ef68faf1bbd9b1e66aea268fd09d358d7e8ab)
    Signed-off-by: Colin Ian King <colin.king@canonical.com>
    Acked-by: Brad Figg <brad.figg@canonical.com>
    Signed-off-by: Tim Gardner <tim.gardner@canonical.com>

 fs/ecryptfs/file.c |    1 +
 1 files changed, 1 insertions(+), 0 deletions(-)

commit 44cb4148342d7b83fc4625178f9923ff90b36cd6
Author: Colin Ian King <colin.king@canonical.com>
Date:   Thu Feb 16 14:38:26 2012 +0000

    eCryptfs: Use notify_change for truncating lower inodes
    
    When truncating inodes in the lower filesystem, eCryptfs directly
    invoked vmtruncate(). As Christoph Hellwig pointed out, vmtruncate() is
    a filesystem helper function, but filesystems may need to do more than
    just a call to vmtruncate().
    
    This patch moves the lower inode truncation out of ecryptfs_truncate()
    and renames the function to truncate_upper().  truncate_upper() updates
    an iattr for the lower inode to indicate if the lower inode needs to be
    truncated upon return.  ecryptfs_setattr() then calls notify_change(),
    using the updated iattr for the lower inode, to complete the truncation.
    
    For eCryptfs functions needing to truncate, ecryptfs_truncate() is
    reintroduced as a simple way to truncate the upper inode to a specified
    size and then truncate the lower inode accordingly.
    
    Reported-by: Christoph Hellwig <hch@lst.de>
    Acked-by: Dustin Kirkland <kirkland@canonical.com>
    Cc: ecryptfs-devel@lists.launchpad.net
    Cc: linux-fsdevel@vger.kernel.org
    Signed-off-by: Tyler Hicks <tyhicks@linux.vnet.ibm.com>
    
    backported from 5f3ef64f4da1c587cdcfaaac72311225b7df094c
    BugLink: http://bugs.launchpad.net/bugs/451368
    Signed-off-by: Colin Ian King <colin.king@canonical.com>
    Signed-off-by: Tim Gardner <tim.gardner@canonical.com>

 fs/ecryptfs/inode.c |   99 ++++++++++++++++++++++++++++++++++----------------
 1 files changed, 67 insertions(+), 32 deletions(-)

commit 232bff5a9ee62ca1c6e36c6859db98b33ed4c96b
Author: Tyler Hicks <tyhicks@linux.vnet.ibm.com>
Date:   Wed Feb 15 17:24:29 2012 +0000

    eCryptfs: Remove mmap from directory operations
    
    BugLink: http://bugs.launchpad.net/bugs/400443
    
    Adrian reported that mkfontscale didn't work inside of eCryptfs mounts.
    Strace revealed the following:
    
    open("./", O_RDONLY|O_NONBLOCK|O_LARGEFILE|O_DIRECTORY|O_CLOEXEC) = 3
    fcntl64(3, F_GETFD) = 0x1 (flags FD_CLOEXEC)
    open("./fonts.scale", O_WRONLY|O_CREAT|O_TRUNC, 0666) = 4
    getdents(3, /* 80 entries */, 32768) = 2304
    open("./.", O_RDONLY) = 5
    fcntl64(5, F_SETFD, FD_CLOEXEC) = 0
    fstat64(5, {st_mode=S_IFDIR|0755, st_size=16384, ...}) = 0
    mmap2(NULL, 16384, PROT_READ, MAP_PRIVATE, 5, 0) = 0xb7fcf000
    close(5) = 0
     --- SIGBUS (Bus error) @ 0 (0) ---
     +++ killed by SIGBUS +++
    
    The mmap2() on a directory was successful, resulting in a SIGBUS
    signal later.  This patch removes mmap() from the list of possible
    ecryptfs_dir_fops so that mmap() isn't possible on eCryptfs directory
    files.
    
    Reported-by: Adrian C. <anrxc@sysphere.org>
    Signed-off-by: Tyler Hicks <tyhicks@linux.vnet.ibm.com>
    
    backported from 38e3eaeedcac75360af8a92e7b66956ec4f334e5
    Signed-off-by: Colin Ian King <colin.king@canonical.com>
    Acked-by: Herton Krzesinski <herton.krzesinski@canonical.com>
    Signed-off-by: Tim Gardner <tim.gardner@canonical.com>

 fs/ecryptfs/file.c |    1 -
 1 files changed, 0 insertions(+), 1 deletions(-)

commit ff8a6e59c4a382c790b01bac257a8ae4acd102c5
Author: Al Viro <viro@zeniv.linux.org.uk>
Date:   Wed Feb 15 19:04:44 2012 +0000

    Ban ecryptfs over ecryptfs
    
    BugLink: http://bugs.launchpad.net/bugs/932987
    
    This is a seriously simplified patch from Eric Sandeen; copy of
    rationale follows:
    ===
      mounting stacked ecryptfs on ecryptfs has been shown to lead to bugs
      in testing.  For crypto info in xattr, there is no mechanism for handling
      this at all, and for normal file headers, we run into other trouble:
    
      BUG: unable to handle kernel NULL pointer dereference at 0000000000000008
      IP: [<ffffffffa015b0b3>] ecryptfs_d_revalidate+0x43/0xa0 [ecryptfs]
      ...
    
      There doesn't seem to be any good usecase for this, so I'd suggest just
      disallowing the configuration.
    
      Based on a patch originally, I believe, from Mike Halcrow.
    ===
    
    Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>
    
    Backported from 4403158ba295c8e36f6736b1bb12d0f7e1923dac
    Signed-off-by: Colin Ian King <colin.king@canonical.com>
    Acked-by: Brad Figg <brad.figg@canonical.com>
    Signed-off-by: Tim Gardner <tim.gardner@canonical.com>
    
    Conflicts:
    
    	fs/ecryptfs/main.c

 fs/ecryptfs/main.c |   18 ++++++++++++++++++
 1 files changed, 18 insertions(+), 0 deletions(-)

commit 6302d10b308a35e5cfcbc432fe09ef4f37e3bf26
Author: Alex Williamson <alex.williamson@redhat.com>
Date:   Tue Feb 28 15:11:50 2012 +0000

    KVM: Device assignment permission checks
    
    Only allow KVM device assignment to attach to devices which:
    
     - Are not bridges
     - Have BAR resources (assume others are special devices)
     - The user has permissions to use
    
    Assigning a bridge is a configuration error, it's not supported, and
    typically doesn't result in the behavior the user is expecting anyway.
    Devices without BAR resources are typically chipset components that
    also don't have host drivers.  We don't want users to hold such devices
    captive or cause system problems by fencing them off into an iommu
    domain.  We determine "permission to use" by testing whether the user
    has access to the PCI sysfs resource files.  By default a normal user
    will not have access to these files, so it provides a good indication
    that an administration agent has granted the user access to the device.
    
    [Yang Bai: add missing #include]
    [avi: fix comment style]
    
    Signed-off-by: Alex Williamson <alex.williamson@redhat.com>
    Signed-off-by: Yang Bai <hamo.by@gmail.com>
    Signed-off-by: Marcelo Tosatti <mtosatti@redhat.com>
    
    (backported from commit 3d27e23b17010c668db311140b17bbbb70c78fb9)
    CVE-2011-4347
    BugLink: http://bugs.launchpad.net/bugs/897812
    Signed-off-by: Andy Whitcroft <apw@canonical.com>
    Acked-by: Seth Forshee <seth.forshee@canonical.com>
    Signed-off-by: Tim Gardner <tim.gardner@canonical.com>

 virt/kvm/kvm_main.c |   75 +++++++++++++++++++++++++++++++++++++++++++++++++++
 1 files changed, 75 insertions(+), 0 deletions(-)

commit 5cd8df5408bb9ad0c23275f1c5e6902b9c08b719
Author: Dan Carpenter <dan.carpenter@oracle.com>
Date:   Mon Feb 6 10:20:45 2012 +0100

    cdrom: use copy_to_user() without the underscores
    
    commit 822bfa51ce44f2c63c300fdb76dc99c4d5a5ca9f upstream.
    
    "nframes" comes from the user and "nframes * CD_FRAMESIZE_RAW" can wrap
    on 32 bit systems.  That would have been ok if we used the same wrapped
    value for the copy, but we use a shifted value.  We should just use the
    checked version of copy_to_user() because it's not going to make a
    difference to the speed.
    
    Signed-off-by: Dan Carpenter <dan.carpenter@oracle.com>
    Signed-off-by: Jens Axboe <axboe@kernel.dk>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

 drivers/cdrom/cdrom.c |    8 +-------
 1 files changed, 1 insertions(+), 7 deletions(-)

commit dfc3f612d7153a84ef5a40c911a76249fe4dcc1b
Merge: f845dcb 16b89f5
Author: Brad Spengler <spender@grsecurity.net>
Date:   Mon Feb 27 18:01:31 2012 -0500

    Merge branch 'pax-stable' into grsec-stable

commit 16b89f5e68e3f8f3959993550273f2bca227ed23
Author: Brad Spengler <spender@grsecurity.net>
Date:   Mon Feb 27 18:01:10 2012 -0500

    Update to pax-linux-2.6.32.57-test144.patch

 fs/binfmt_elf.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit f845dcb84c463d24921caec3bae4d132f811219a
Merge: 6366f6b 0710984
Author: Brad Spengler <spender@grsecurity.net>
Date:   Sun Feb 26 19:02:15 2012 -0500

    Merge branch 'pax-stable' into grsec-stable
    
    Conflicts:
    	Makefile

commit 0710984acba53f724c827e911143a6f5b93f69d0
Author: Brad Spengler <spender@grsecurity.net>
Date:   Sun Feb 26 19:00:14 2012 -0500

    Update to pax-linux-2.6.32.57-test143.patch

 Makefile |   41 +++++++++++++++++++++++++----------------
 1 files changed, 25 insertions(+), 16 deletions(-)

commit 6366f6b96bbcca8a4eec30df82e80e826f236a6a
Merge: 51d415f 0887c0f
Author: Brad Spengler <spender@grsecurity.net>
Date:   Sat Feb 25 21:00:23 2012 -0500

    Merge branch 'pax-stable' into grsec-stable

commit 0887c0f374c2d63e3a29cbb4e7cee9d001715d4a
Author: Brad Spengler <spender@grsecurity.net>
Date:   Sat Feb 25 21:00:07 2012 -0500

    Update to pax-linux-2.6.32.57-test142.patch

 Makefile                               |    2 +-
 arch/x86/include/asm/alternative-asm.h |    2 +-
 arch/x86/kernel/kprobes.c              |    2 +-
 3 files changed, 3 insertions(+), 3 deletions(-)

commit 51d415fe7097dd531b100bf03986697eba33ffea
Merge: 96dedf7 2adbcc9
Author: Brad Spengler <spender@grsecurity.net>
Date:   Sat Feb 25 11:45:08 2012 -0500

    Merge branch 'pax-stable' into grsec-stable

commit 2adbcc9e95f6c599d4dad6074684d8184e64e369
Author: Brad Spengler <spender@grsecurity.net>
Date:   Sat Feb 25 11:44:52 2012 -0500

    Update to pax-linux-2.6.32.57-test141.patch

 tools/gcc/Makefile |    4 ++--
 1 files changed, 2 insertions(+), 2 deletions(-)

commit 96dedf78c119203301717c492a4ff7081d56f82e
Merge: 2badf5f 6569e27
Author: Brad Spengler <spender@grsecurity.net>
Date:   Sat Feb 25 11:31:01 2012 -0500

    Merge branch 'pax-stable' into grsec-stable

commit 6569e2706c1af193ab5ca9bcedc4d63096c61f6e
Author: Brad Spengler <spender@grsecurity.net>
Date:   Sat Feb 25 11:30:19 2012 -0500

    Update to pax-linux-2.6.32.57-test140.patch

 arch/alpha/include/asm/atomic.h  |   18 +++---
 arch/frv/include/asm/atomic.h    |   18 +++---
 arch/ia64/include/asm/atomic.h   |   18 +++---
 arch/mips/include/asm/atomic.h   |   18 +++---
 arch/parisc/include/asm/atomic.h |   18 +++---
 arch/s390/include/asm/atomic.h   |   18 +++---
 kernel/panic.c                   |    6 ++-
 mm/mmap.c                        |   36 +++----------
 tools/gcc/kernexec_plugin.c      |  101 +++++++++++++++++++++++++++++++++----
 tools/gcc/stackleak_plugin.c     |   20 +++++---
 10 files changed, 169 insertions(+), 102 deletions(-)

commit 2badf5f689a95cd9c848cc0e20ec332806bc83f9
Merge: ecfd2fc b0ceb91
Author: Brad Spengler <spender@grsecurity.net>
Date:   Sat Feb 25 10:27:36 2012 -0500

    Merge branch 'pax-stable' into grsec-stable

commit b0ceb9136408df01d1b089b46fb4b7fcfd804789
Author: Brad Spengler <spender@grsecurity.net>
Date:   Sat Feb 25 10:27:06 2012 -0500

    Remove unnecessary cast

 drivers/char/mmtimer.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit 85d7293e3e04acd748ea198494e7a826b707e6d1
Author: Brad Spengler <spender@grsecurity.net>
Date:   Sat Feb 25 10:25:15 2012 -0500

    remove struct

 drivers/char/mmtimer.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit bc5525670ee949b18963ee6e1cd144aba89f22a5
Author: Brad Spengler <spender@grsecurity.net>
Date:   Sat Feb 25 10:21:24 2012 -0500

    Make k_clock const again, just not in drivers/char/mmtimer.c

 drivers/char/mmtimer.c       |    4 ++--
 include/linux/posix-timers.h |    4 ++--
 2 files changed, 4 insertions(+), 4 deletions(-)

commit ecfd2fc93d53f6f1aa5137a49279df7588312d6f
Author: Brad Spengler <spender@grsecurity.net>
Date:   Sat Feb 25 08:47:21 2012 -0500

    Log bad /proc/pid/mem

 fs/proc/base.c |    4 +++-
 1 files changed, 3 insertions(+), 1 deletions(-)

commit cf7084bf186ef481031dadf7f4ff02144d79e0be
Author: Brad Spengler <spender@grsecurity.net>
Date:   Sat Feb 25 08:20:36 2012 -0500

    Make use of f_version for protecting /proc file structs (fine since we're
    not a directory or seq_file)

 fs/proc/base.c |   16 ++++++++++------
 1 files changed, 10 insertions(+), 6 deletions(-)

commit 027197da5341edc50f7bbabe97a4447a219d8cbf
Merge: c1bdefc 72e25f26
Author: Brad Spengler <spender@grsecurity.net>
Date:   Fri Feb 24 19:50:17 2012 -0500

    Merge branch 'pax-stable' into grsec-stable

commit 72e25f260d57e3bd8c67688cab977aa3dec2d903
Author: Brad Spengler <spender@grsecurity.net>
Date:   Fri Feb 24 19:48:37 2012 -0500

    Fix ia64 compilation

 include/linux/posix-timers.h |    3 ++-
 1 files changed, 2 insertions(+), 1 deletions(-)

commit c1bdefc87f87db7b93985c265c14ec0d7eb86d0e
Author: Brad Spengler <spender@grsecurity.net>
Date:   Fri Feb 24 19:49:20 2012 -0500

    Revert "Fix ia64 compilation"
    Applying against pax-stable
    
    This reverts commit aa184fac628a89bd890efcabd64d2946e8946fdf.

 include/linux/posix-timers.h |    3 +--
 1 files changed, 1 insertions(+), 2 deletions(-)

commit aa184fac628a89bd890efcabd64d2946e8946fdf
Author: Brad Spengler <spender@grsecurity.net>
Date:   Fri Feb 24 19:48:37 2012 -0500

    Fix ia64 compilation

 include/linux/posix-timers.h |    3 ++-
 1 files changed, 2 insertions(+), 1 deletions(-)

commit 6cd9aca0d14fa3e41b0c121df40397b2aff57617
Merge: 1be044e a7acbbc
Author: Brad Spengler <spender@grsecurity.net>
Date:   Fri Feb 24 19:34:14 2012 -0500

    Merge branch 'pax-stable' into grsec-stable

commit a7acbbcf7bfa053246ba0b1a4b654510f3bbe938
Author: Brad Spengler <spender@grsecurity.net>
Date:   Fri Feb 24 19:33:59 2012 -0500

    Fix sparc32 compilation

 arch/sparc/Kconfig               |    1 +
 arch/sparc/include/asm/atomic.h  |    1 +
 arch/sparc/include/asm/page_32.h |    2 ++
 3 files changed, 4 insertions(+), 0 deletions(-)

commit 1be044e8b0966e9dc2b93280b0ec05c0397be05f
Merge: b4a64cf 687a6ef
Author: Brad Spengler <spender@grsecurity.net>
Date:   Fri Feb 24 19:00:10 2012 -0500

    Merge branch 'pax-stable' into grsec-stable

commit 687a6ef1884ffd20ba64242cb55f52073dcdc3ab
Author: Brad Spengler <spender@grsecurity.net>
Date:   Fri Feb 24 18:59:01 2012 -0500

    (6:57:09 PM) pipacs: but you can be proactive
    (Fix other-arch atomic64/REFCOUNT compilation failures)

 arch/alpha/include/asm/atomic.h  |   10 ++++++++++
 arch/arm/Kconfig                 |    1 +
 arch/arm/include/asm/atomic.h    |    4 ++++
 arch/frv/include/asm/atomic.h    |   10 ++++++++++
 arch/ia64/include/asm/atomic.h   |   10 ++++++++++
 arch/mips/Kconfig                |    1 +
 arch/mips/include/asm/atomic.h   |   14 ++++++++++++++
 arch/parisc/include/asm/atomic.h |   10 ++++++++++
 arch/s390/include/asm/atomic.h   |   10 ++++++++++
 9 files changed, 70 insertions(+), 0 deletions(-)

commit b4a64cfcaec8886bd2907432381138c976fdf7eb
Author: Brad Spengler <spender@grsecurity.net>
Date:   Thu Feb 23 21:10:12 2012 -0500

    Remove unnecessary copies, as suggested by solar

 grsecurity/gracl.c |   11 ++++++-----
 kernel/fork.c      |    4 ----
 2 files changed, 6 insertions(+), 9 deletions(-)

commit 22c9688e666aa07a15b41d28546ea870e8f93d0d
Author: Brad Spengler <spender@grsecurity.net>
Date:   Thu Feb 23 20:48:35 2012 -0500

    Add recent PROC_MEMMAP enhancement to the compat version of execve() as pointed
    out by solar, forgot to add it in the backport

 fs/compat.c |    7 +++++++
 1 files changed, 7 insertions(+), 0 deletions(-)

commit 35af929b33c6610b261af7209a0eb78157da5122
Author: Brad Spengler <spender@grsecurity.net>
Date:   Thu Feb 23 19:03:49 2012 -0500

    Compilation fix

 fs/open.c |    7 ++-----
 1 files changed, 2 insertions(+), 5 deletions(-)

commit c43325b61c201f45446033ca3cf2253e5cf6c662
Author: Brad Spengler <spender@grsecurity.net>
Date:   Thu Feb 23 18:58:45 2012 -0500

    Sync up with test patch

 fs/open.c                   |    2 +-
 grsecurity/gracl_fs.c       |   27 ++++-----------------------
 grsecurity/grsec_disabled.c |   11 ++---------
 include/linux/grmsg.h       |    1 -
 include/linux/grsecurity.h  |    6 ++----
 5 files changed, 9 insertions(+), 38 deletions(-)

commit cb9a6d664e3a3fcd9f3df3b310f81c7748b95173
Author: Al Viro <viro@zeniv.linux.org.uk>
Date:   Tue Jul 26 04:15:54 2011 -0400

    merge fchmod() and fchmodat() guts, kill ancient broken kludge
    
    The kludge in question is undocumented and doesn't work for 32bit
    binaries on amd64, sparc64 and s390.  Passing (mode_t)-1 as
    mode had (since 0.99.14v and contrary to behaviour of any
    other Unix, prescriptions of POSIX, SuS and our own manpages)
    was kinda-sorta no-op.  Note that any software relying on
    that (and looking for examples shows none) would be visibly
    broken on sparc64, where practically all userland is built
    32bit.  No such complaints noticed...
    
    Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>
    
    Conflicts:
    
    	fs/open.c

 fs/open.c |   96 +++++++++++++++++++------------------------------------------
 1 files changed, 30 insertions(+), 66 deletions(-)

commit 465a092931637e4a520c2d2d755189802bf74691
Author: Brad Spengler <spender@grsecurity.net>
Date:   Thu Feb 23 18:18:49 2012 -0500

    Apply umask checks to chmod/fchmod as well, as requested by sponsor
    While 3.2 uses combined code for chmod/fchmod, in this kernel we need to hook
    separate functions
    Union the enforced umask with the existing one to produce minimal privilege
    Change umask type to u16
    
    Conflicts:
    
    	fs/open.c

 fs/fs_struct.c              |    2 +-
 fs/open.c                   |    6 +++---
 grsecurity/gracl_fs.c       |   20 ++++++++++++++++----
 grsecurity/grsec_disabled.c |    6 +++---
 include/linux/gracl.h       |    3 ++-
 include/linux/grsecurity.h  |    4 ++--
 6 files changed, 27 insertions(+), 14 deletions(-)

commit e3117d775f65b8c3dc191cd26b3b1c6690e45f11
Author: Brad Spengler <spender@grsecurity.net>
Date:   Wed Feb 22 18:16:11 2012 -0500

    Add per-role umask enforcement to RBAC, requested by a sponsor

 fs/fs_struct.c              |    2 +-
 grsecurity/gracl_fs.c       |    9 +++++++++
 grsecurity/grsec_disabled.c |    5 +++++
 include/linux/gracl.h       |    5 +++--
 include/linux/grsecurity.h  |    2 ++
 5 files changed, 20 insertions(+), 3 deletions(-)

commit 12430db3e1c839f4681e620484b620dc743911af
Author: Brad Spengler <spender@grsecurity.net>
Date:   Mon Feb 20 09:17:57 2012 -0500

    Fix wrong logic on capability checks for switching roles, broke policies
    Thanks to Richard Kojedzinszky for reporting

 grsecurity/gracl.c |    4 ++--
 1 files changed, 2 insertions(+), 2 deletions(-)

commit cf6b5c8ed1989daca1c66faf118f17bfdd5d93e9
Author: Brad Spengler <spender@grsecurity.net>
Date:   Thu Feb 16 21:20:10 2012 -0500

    sparc64 compile fix

 fs/seq_file.c |    1 +
 1 files changed, 1 insertions(+), 0 deletions(-)

commit fec67d63c16452e7a59f5952972e49d883391ab1
Author: Brad Spengler <spender@grsecurity.net>
Date:   Thu Feb 16 18:38:32 2012 -0500

    Update configuration help and name for GRKERNSEC_PROC_MEMMAP

 grsecurity/Kconfig |   10 ++++++----
 1 files changed, 6 insertions(+), 4 deletions(-)

commit c5ac1c8fdb233ee524d8449c31cb73abacfd3162
Author: Brad Spengler <spender@grsecurity.net>
Date:   Thu Feb 16 18:18:01 2012 -0500

    optimize the check a bit

 fs/exec.c |    4 ++--
 1 files changed, 2 insertions(+), 2 deletions(-)

commit 494cb302690cba6daf117583e405645dd40c5364
Author: Brad Spengler <spender@grsecurity.net>
Date:   Thu Feb 16 18:00:45 2012 -0500

    smile VUPEN :D
    (limit argv+env to 1MB for suid/sgid binaries)

 fs/exec.c |   11 +++++++++++
 1 files changed, 11 insertions(+), 0 deletions(-)

commit f44d1be39ce6336f8270bff0040babf09c040ef7
Author: Brad Spengler <spender@grsecurity.net>
Date:   Thu Feb 16 17:49:33 2012 -0500

    Address Space Protection -> Memory Protections (suggested on IRC for consistency)

 grsecurity/Kconfig |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit 11749696a05a2a4090d036d8c51a99acdea4a0d5
Author: Brad Spengler <spender@grsecurity.net>
Date:   Thu Feb 16 17:45:06 2012 -0500

    Change the long long type for exec_id to the proper u64

 include/linux/sched.h    |    2 +-
 include/linux/seq_file.h |    2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

commit f423e3922b874dd3b4dee42f82cd5035885162cf
Merge: 7f161ae 49c118c
Author: Brad Spengler <spender@grsecurity.net>
Date:   Mon Feb 13 18:36:19 2012 -0500

    Merge branch 'pax-stable' into grsec-stable

commit 49c118ccb5bfb7a1e30a269383add009710519af
Author: Brad Spengler <spender@grsecurity.net>
Date:   Mon Feb 13 18:35:43 2012 -0500

    Merge changes from pax-linux-2.6.32.57-test138.patch

 arch/s390/include/asm/elf.h |    4 ++--
 arch/x86/kernel/entry_64.S  |    2 +-
 arch/x86/mm/fault.c         |    4 ++--
 arch/x86/mm/init.c          |    2 +-
 arch/x86/mm/pageattr.c      |    2 +-
 arch/x86/mm/pgtable.c       |    4 ++--
 arch/x86/pci/pcbios.c       |    2 +-
 fs/binfmt_elf.c             |    3 +++
 init/main.c                 |    2 +-
 mm/slob.c                   |    2 +-
 10 files changed, 15 insertions(+), 12 deletions(-)

commit 7f161ae4afd5181e047a7c4017589e124de777cc
Author: Dan Carpenter <dan.carpenter@oracle.com>
Date:   Thu Feb 9 00:46:47 2012 +0000

    isdn: type bug in isdn_net_header()
    
    We use len to store the return value from eth_header().  eth_header()
    can return -ETH_HLEN (-14).  We want to pass this back instead of
    truncating it to 65522 and returning that.
    
    Signed-off-by: Dan Carpenter <dan.carpenter@oracle.com>
    Acked-by: Neil Horman <nhorman@tuxdriver.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

 drivers/isdn/i4l/isdn_net.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit 40cfbc3bbc8cce9e012051cfc5e559a63e1a44b2
Author: Heiko Carstens <heiko.carstens@de.ibm.com>
Date:   Sat Feb 4 10:47:10 2012 +0100

    exec: fix use-after-free bug in setup_new_exec()
    
    Setting the task name is done within setup_new_exec() by accessing
    bprm->filename. However this happens after flush_old_exec().
    This may result in a use after free bug, flush_old_exec() may
    "complete" vfork_done, which will wake up the parent which in turn
    may free the passed in filename.
    To fix this add a new tcomm field in struct linux_binprm which
    contains the now early generated task name until it is used.
    
    Fixes this bug on s390:
    
      Unable to handle kernel pointer dereference at virtual kernel address 0000000039768000
      Process kworker/u:3 (pid: 245, task: 000000003a3dc840, ksp: 0000000039453818)
      Krnl PSW : 0704000180000000 0000000000282e94 (setup_new_exec+0xa0/0x374)
      Call Trace:
      ([<0000000000282e2c>] setup_new_exec+0x38/0x374)
       [<00000000002dd12e>] load_elf_binary+0x402/0x1bf4
       [<0000000000280a42>] search_binary_handler+0x38e/0x5bc
       [<0000000000282b6c>] do_execve_common+0x410/0x514
       [<0000000000282cb6>] do_execve+0x46/0x58
       [<00000000005bce58>] kernel_execve+0x28/0x70
       [<000000000014ba2e>] ____call_usermodehelper+0x102/0x140
       [<00000000005bc8da>] kernel_thread_starter+0x6/0xc
       [<00000000005bc8d4>] kernel_thread_starter+0x0/0xc
      Last Breaking-Event-Address:
       [<00000000002830f0>] setup_new_exec+0x2fc/0x374
    
      Kernel panic - not syncing: Fatal exception: panic_on_oops
    
    Reported-by: Sebastian Ott <sebott@linux.vnet.ibm.com>
    Signed-off-by: Heiko Carstens <heiko.carstens@de.ibm.com>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
    
    Conflicts:
    
    	fs/exec.c

 fs/exec.c               |   33 +++++++++++++++++----------------
 include/linux/binfmts.h |    3 ++-
 2 files changed, 19 insertions(+), 17 deletions(-)

commit 903969f2221ca14e607222d40eebcac38266e9b7
Author: Dan Carpenter <dan.carpenter@oracle.com>
Date:   Fri Feb 10 09:03:58 2012 +0100

    relay: prevent integer overflow in relay_open()
    
    "subbuf_size" and "n_subbufs" come from the user and they need to be
    capped to prevent an integer overflow.
    
    Signed-off-by: Dan Carpenter <dan.carpenter@oracle.com>
    Cc: stable@kernel.org
    Signed-off-by: Jens Axboe <axboe@kernel.dk>

 kernel/relay.c |   10 ++++++++--
 1 files changed, 8 insertions(+), 2 deletions(-)

commit 774c978af6eab02f5a709e51f73e781da69534cd
Merge: b2ee77f 5d82c3c
Author: Brad Spengler <spender@grsecurity.net>
Date:   Mon Feb 13 17:48:52 2012 -0500

    Merge branch 'pax-stable' into grsec-stable

commit 5d82c3c5f9b43acbbaba0d16c2516576ee4d7600
Merge: 57cfeff 1897bf2
Author: Brad Spengler <spender@grsecurity.net>
Date:   Mon Feb 13 17:48:38 2012 -0500

    Merge branch 'linux-2.6.32.y' into pax-stable

commit b2ee77fc6532f280d2433217e8b622e190e18846
Author: Brad Spengler <spender@grsecurity.net>
Date:   Sun Feb 12 16:44:05 2012 -0500

    add missing declaration

 grsecurity/gracl.c |    2 ++
 1 files changed, 2 insertions(+), 0 deletions(-)

commit 0f738167bd3f923451ac526f6eaed86f6b27e504
Author: Brad Spengler <spender@grsecurity.net>
Date:   Sun Feb 12 16:36:04 2012 -0500

    Require CAP_SETUID/CAP_SETGID in a subject in order to change roles
    in addition to existing checks (this handles the setresuid ruid = euid case)

 grsecurity/gracl.c |    6 ++++++
 1 files changed, 6 insertions(+), 0 deletions(-)

commit 804a37c4c42603c021cd8e787407731aceeab448
Author: Brad Spengler <spender@grsecurity.net>
Date:   Sun Feb 12 16:16:53 2012 -0500

    Revert setreuid changes when RBAC is enabled
    I'l fix the learning issue Lavish reported in a different way
    through gradm modifications
    
    This reverts commit 2f47176536bac553b98cacd27a9e482fe04247cf.

 kernel/sys.c |   30 ++++++------------------------
 1 files changed, 6 insertions(+), 24 deletions(-)

commit e991bb5002d3bd996d9c07c24878c2a0f247e143
Author: Brad Spengler <spender@grsecurity.net>
Date:   Sat Feb 11 14:22:46 2012 -0500

    copy exec_id on fork

 kernel/fork.c |    4 ++++
 1 files changed, 4 insertions(+), 0 deletions(-)

commit 67178f5c1ccb61ca3778baab3aafe9eb1a5228fa
Author: Brad Spengler <spender@grsecurity.net>
Date:   Fri Feb 10 19:54:21 2012 -0500

    Introduce new enhancement to GRKERNSEC_PROC_MEMMAP
    prevents reads of sensitive /proc/pid entries where the file descriptor
    was opened in a different task than the one performing the read

 fs/exec.c                  |    8 ++++++++
 fs/proc/array.c            |   14 ++++++++++++++
 fs/proc/task_mmu.c         |   14 ++++++++++++++
 fs/seq_file.c              |    3 +++
 grsecurity/Kconfig         |    4 ++++
 grsecurity/Makefile        |    2 ++
 grsecurity/grsec_mem.c     |    7 +++++++
 include/linux/grmsg.h      |    1 +
 include/linux/grsecurity.h |    2 ++
 include/linux/sched.h      |    3 +++
 include/linux/seq_file.h   |    3 +++
 mm/mempolicy.c             |   17 +++++++++++++++++
 12 files changed, 78 insertions(+), 0 deletions(-)

commit 7e600e98936204b0fdd5fc4927f3e84ed8a916d4
Author: Brad Spengler <spender@grsecurity.net>
Date:   Fri Feb 10 17:45:05 2012 -0500

    remove duplicate signal check

 fs/ecryptfs/read_write.c |    5 -----
 1 files changed, 0 insertions(+), 5 deletions(-)

commit cf5731b0b8ac026402e004a62cc3b0c522b5d9d2
Author: Brad Spengler <spender@grsecurity.net>
Date:   Tue Feb 7 17:21:00 2012 -0500

    Add current_is_single_threaded() fix I applied to the test branch but
    forgot to apply to stable when backporting GRKERNSEC_SETXID

 lib/is_single_threaded.c |    3 +++
 1 files changed, 3 insertions(+), 0 deletions(-)

commit 62c225e1fb6dae81cc09529cf5907d2d873d2501
Author: Brad Spengler <spender@grsecurity.net>
Date:   Sun Feb 5 19:24:45 2012 -0500

    We now allow configurations with no PaX markings, giving the system no way to override the defaults

 include/linux/grsecurity.h |    6 ------
 1 files changed, 0 insertions(+), 6 deletions(-)

commit 9d26eddf728a13211ecd562c3bb694f06dad9ed4
Author: Brad Spengler <spender@grsecurity.net>
Date:   Sun Feb 5 10:01:23 2012 -0500

    Increase the buffer size of logged TPE reason, otherwise we could truncate the "y" in directory

 grsecurity/grsec_tpe.c |    2 +-
 include/linux/grmsg.h  |    2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

commit 438081ca64865be76271b92db39b99e47a15efd9
Author: Brad Spengler <spender@grsecurity.net>
Date:   Sat Feb 4 21:01:16 2012 -0500

    Improve security of ptrace-based monitoring/sandboxing
    See:
    http://article.gmane.org/gmane.linux.kernel.lsm/15156

 include/linux/tracehook.h |    9 +++++----
 1 files changed, 5 insertions(+), 4 deletions(-)

commit 2f47176536bac553b98cacd27a9e482fe04247cf
Author: Brad Spengler <spender@grsecurity.net>
Date:   Fri Feb 3 20:25:38 2012 -0500

    Reported by lavish on IRC:
    If a suid/sgid binary did not learn any setuid/setgid call during learning,
    we would not any CAP_SETUID/CAP_SETGID capability to the task, nor
    any restrictions on uid/gid changes.  uid and gid can however be changed
    within a suid/sgid binary via setresuid/setresgid with ruid/rgid set to
    euid/egid.
    
    My fix:
    POSIX doesn't specify whether unprivileged users can perform the above
    setresuid/setresgid as an unprivileged user, though Linux has historically
    permitted them.  Modify this behavior when RBAC is enabled to require
    CAP_SETUID/CAP_SETGID for these operations.
    
    Thanks to Lavish for the report!

 kernel/sys.c |   30 ++++++++++++++++++++++++------
 1 files changed, 24 insertions(+), 6 deletions(-)

commit e93b3fe92d7de50e133327162ae7c40723f88802
Merge: 3cf8fac 57cfeff
Author: Brad Spengler <spender@grsecurity.net>
Date:   Fri Feb 3 20:14:52 2012 -0500

    Merge branch 'pax-stable' into grsec-stable
    
    Conflicts:
    	block/scsi_ioctl.c
    	drivers/scsi/sd.c

commit 57cfeff6b583d0514e11b6651ce07c4ec52e9566
Author: Brad Spengler <spender@grsecurity.net>
Date:   Fri Feb 3 20:13:03 2012 -0500

    Merge changes from pax-linux-2.6.32.55-test137.patch

 arch/x86/kernel/cpu/mcheck/p5.c      |    1 +
 arch/x86/kernel/cpu/mcheck/winchip.c |    1 +
 arch/x86/mm/ioremap.c                |    3 +++
 drivers/char/tty_io.c                |    2 +-
 security/Kconfig                     |    1 +
 5 files changed, 7 insertions(+), 1 deletions(-)

commit 08864616a21369d4fce2f9249995e4d81a313e45
Merge: fc57040 adb67a7
Author: Brad Spengler <spender@grsecurity.net>
Date:   Fri Feb 3 20:12:09 2012 -0500

    Merge branch 'linux-2.6.32.y' into pax-stable

commit 3cf8facd7367a6fa8709e9965f493d3c01aa1433
Author: Brad Spengler <spender@grsecurity.net>
Date:   Mon Jan 30 23:26:44 2012 -0500

    Implement new version of CONFIG_GRKERNSEC_SYSFS_RESTRICT
    
    We'll whitelist required directories for compatibility instead of requiring
    that people disable the feature entirely if they use SELinux, fuse, etc

 fs/debugfs/inode.c |    4 ++++
 fs/sysfs/dir.c     |   12 ++++++++++++
 fs/sysfs/mount.c   |    4 ----
 grsecurity/Kconfig |   10 +++++++---
 4 files changed, 23 insertions(+), 7 deletions(-)

commit 57146febf72d36af9c158cdcdb843173857f7a2e
Author: Brad Spengler <spender@grsecurity.net>
Date:   Mon Jan 30 17:20:04 2012 -0500

    fix bad ecryptfs merge

 fs/ecryptfs/crypto.c |   13 -------------
 1 files changed, 0 insertions(+), 13 deletions(-)

commit 9588c65f970847a62b3bb549fcee94a8bb318987
Author: Brad Spengler <spender@grsecurity.net>
Date:   Sun Jan 29 01:12:19 2012 -0500

    perform RBAC check if TPE is on but match fails, matches previous behavior

 grsecurity/grsec_tpe.c |    3 ++-
 1 files changed, 2 insertions(+), 1 deletions(-)

commit 071127ee32668640c423b3a2d04efde6f36c7d51
Author: Brad Spengler <spender@grsecurity.net>
Date:   Sat Jan 28 13:17:06 2012 -0500

    log more information about the reason for a TPE denial for novice users, requested by a sponsor

 grsecurity/grsec_tpe.c |   57 +++++++++++++++++++++++++++++++++++++----------
 include/linux/grmsg.h  |    2 +-
 2 files changed, 46 insertions(+), 13 deletions(-)

commit de266622ac8e0132537b467b7ab5f0aee15942bf
Author: Brad Spengler <spender@grsecurity.net>
Date:   Fri Jan 27 20:54:31 2012 -0500

    sync documentation with test patch

 grsecurity/Kconfig |   10 ++++------
 1 files changed, 4 insertions(+), 6 deletions(-)

commit 2a30fcc6cb300b4c05ce33b809152554f1cd29d0
Author: Brad Spengler <spender@grsecurity.net>
Date:   Fri Jan 27 19:58:01 2012 -0500

    merge upstream sha512 changes

 crypto/sha512_generic.c |   62 +++++++++++++++++++++++++---------------------
 1 files changed, 34 insertions(+), 28 deletions(-)

commit 65b29a4ed4b9152bcec36d5113a34f84b0694f7b
Author: Li Wang <liwang@nudt.edu.cn>
Date:   Thu Jan 19 09:44:36 2012 +0800

    eCryptfs: Infinite loop due to overflow in ecryptfs_write()
    
    ecryptfs_write() can enter an infinite loop when truncating a file to a
    size larger than 4G. This only happens on architectures where size_t is
    represented by 32 bits.
    
    This was caused by a size_t overflow due to it incorrectly being used to
    store the result of a calculation which uses potentially large values of
    type loff_t.
    
    [tyhicks@canonical.com: rewrite subject and commit message]
    Signed-off-by: Li Wang <liwang@nudt.edu.cn>
    Signed-off-by: Yunchuan Wen <wenyunchuan@kylinos.com.cn>
    Reviewed-by: Cong Wang <xiyou.wangcong@gmail.com>
    Cc: <stable@vger.kernel.org>
    Signed-off-by: Tyler Hicks <tyhicks@canonical.com>

 fs/ecryptfs/read_write.c |    4 ++--
 1 files changed, 2 insertions(+), 2 deletions(-)

commit 57f9e335b11d47434172f078804c581d73aaaa5d
Author: Tyler Hicks <tyhicks@canonical.com>
Date:   Wed Jan 18 18:30:04 2012 -0600

    eCryptfs: Make truncate path killable
    
    ecryptfs_write() handles the truncation of eCryptfs inodes. It grabs a
    page, zeroes out the appropriate portions, and then encrypts the page
    before writing it to the lower filesystem. It was unkillable and due to
    the lack of sparse file support could result in tying up a large portion
    of system resources, while encrypting pages of zeros, with no way for
    the truncate operation to be stopped from userspace.
    
    This patch adds the ability for ecryptfs_write() to detect a pending
    fatal signal and return as gracefully as possible. The intent is to
    leave the lower file in a useable state, while still allowing a user to
    break out of the encryption loop. If a pending fatal signal is detected,
    the eCryptfs inode size is updated to reflect the modified inode size
    and then -EINTR is returned.
    
    Signed-off-by: Tyler Hicks <tyhicks@canonical.com>
    Cc: <stable@vger.kernel.org>

 fs/ecryptfs/read_write.c |   19 ++++++++++++++-----
 1 files changed, 14 insertions(+), 5 deletions(-)

commit 826405ab264e1bc3834a59ae44c2ca79b3ea82a3
Author: Tyler Hicks <tyhicks@canonical.com>
Date:   Tue Jan 24 10:02:22 2012 -0600

    eCryptfs: Fix oops when printing debug info in extent crypto functions
    
    If pages passed to the eCryptfs extent-based crypto functions are not
    mapped and the module parameter ecryptfs_verbosity=1 was specified at
    loading time, a NULL pointer dereference will occur.
    
    Note that this wouldn't happen on a production system, as you wouldn't
    pass ecryptfs_verbosity=1 on a production system. It leaks private
    information to the system logs and is for debugging only.
    
    The debugging info printed in these messages is no longer very useful
    and rather than doing a kmap() in these debugging paths, it will be
    better to simply remove the debugging paths completely.
    
    https://launchpad.net/bugs/913651
    
    Signed-off-by: Tyler Hicks <tyhicks@canonical.com>
    Reported-by: Daniel DeFreez
    Cc: <stable@vger.kernel.org>
    
    Conflicts:
    
    	fs/ecryptfs/crypto.c

 fs/ecryptfs/crypto.c |   33 +++------------------------------
 1 files changed, 3 insertions(+), 30 deletions(-)

commit bd1ee492bbdb0accab183c634dc316a2e12c8cb8
Author: Tyler Hicks <tyhicks@canonical.com>
Date:   Thu Jan 12 11:30:44 2012 +0100

    eCryptfs: Sanitize write counts of /dev/ecryptfs
    
    A malicious count value specified when writing to /dev/ecryptfs may
    result in a a very large kernel memory allocation.
    
    This patch peeks at the specified packet payload size, adds that to the
    size of the packet headers and compares the result with the write count
    value. The resulting maximum memory allocation size is approximately 532
    bytes.
    
    Signed-off-by: Tyler Hicks <tyhicks@canonical.com>
    Reported-by: Sasha Levin <levinsasha928@gmail.com>
    Cc: <stable@vger.kernel.org>

 fs/ecryptfs/miscdev.c |   56 +++++++++++++++++++++++++++++++++---------------
 1 files changed, 38 insertions(+), 18 deletions(-)

commit 57a72432415a451aa8fa48bb5fa18f714b3a6a92
Author: Brad Spengler <spender@grsecurity.net>
Date:   Fri Jan 27 19:50:41 2012 -0500

    drop lock in xfs_readlink
    
    http://git.kernel.org/?p=linux/kernel/git/torvalds/linux-2.6.git;a=blobdiff;f=fs/xfs/xfs_vnodeops.c;fp=fs/xfs/xfs_vnodeops.c;h=ebdb88840a47817b5704df2aaa0fefb8b11fd96e;hp=0cf52da9d2468a547a614f55cf0191a396f82574;hb=aaad641eadfd3e74b0fbb68fcf539b9cef0415d0;hpb=74a7f6a0a61f1f5addd0afa789785f4cefcfcafc

 fs/xfs/xfs_vnodeops.c |    3 ++-
 1 files changed, 2 insertions(+), 1 deletions(-)

commit a1f8a979c5038e3ec0ad00a09acb30163380bb31
Author: Brad Spengler <spender@grsecurity.net>
Date:   Fri Jan 27 19:40:59 2012 -0500

    sync with test patch

 grsecurity/gracl.c |    3 +--
 1 files changed, 1 insertions(+), 2 deletions(-)

commit 75d62f6720a0a507e295e195233bd8c919c12a85
Author: Brad Spengler <spender@grsecurity.net>
Date:   Fri Jan 27 19:31:07 2012 -0500

    fix typo

 grsecurity/gracl.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit 35cdf74f990edffd420edd9eea322a3c03fb3132
Author: Brad Spengler <spender@grsecurity.net>
Date:   Fri Jan 27 19:27:07 2012 -0500

    fix typo

 grsecurity/gracl.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit aa7be66902ba3f0a567cf4bb1096100761c8a7f7
Author: Brad Spengler <spender@grsecurity.net>
Date:   Fri Jan 27 19:22:54 2012 -0500

    include proper header

 grsecurity/gracl.c |    4 ++--
 1 files changed, 2 insertions(+), 2 deletions(-)

commit 522a704962f4ddee44eb00169297f44bc7857382
Author: Brad Spengler <spender@grsecurity.net>
Date:   Fri Jan 27 19:19:48 2012 -0500

    add missing hunks, compilation fixes

 fs/compat.c                |    7 ++++++-
 fs/exec.c                  |    2 +-
 grsecurity/gracl.c         |    6 +++---
 grsecurity/grsec_ptrace.c  |    2 +-
 include/linux/grsecurity.h |    2 +-
 5 files changed, 12 insertions(+), 7 deletions(-)

commit 812e9b117142b319f034b1b52c3f60ce41bc78a0
Author: Brad Spengler <spender@grsecurity.net>
Date:   Fri Jan 27 19:07:19 2012 -0500

    add missing declaration

 include/linux/grinternal.h |    1 +
 1 files changed, 1 insertions(+), 0 deletions(-)

commit ddb7634ada8d0100da810e0fd3177f89a412c3cc
Author: Brad Spengler <spender@grsecurity.net>
Date:   Fri Jan 27 19:03:22 2012 -0500

    fix typo

 include/linux/grmsg.h |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit 6ec00041fe0325216040e7255c3ab85afe6066e7
Author: Brad Spengler <spender@grsecurity.net>
Date:   Fri Jan 27 19:00:42 2012 -0500

    fix typo

 kernel/cred.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit d179f2c6e24b7f901f4e90e90479c862a3f05244
Author: Brad Spengler <spender@grsecurity.net>
Date:   Fri Jan 27 18:57:33 2012 -0500

    make set_user global

 kernel/sys.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit 2d0778ebe964eb2f8a522be0ca61aeecd9964e53
Author: Brad Spengler <spender@grsecurity.net>
Date:   Fri Jan 27 18:52:36 2012 -0500

    Introduce CONFIG_GRKERNSEC_SETXID and CONFIG_GRKERNSEC_PTRACE_READEXEC

 fs/exec.c                  |    5 ++
 grsecurity/Kconfig         |   30 +++++++++++++
 grsecurity/grsec_init.c    |    8 ++++
 grsecurity/grsec_ptrace.c  |   16 +++++++
 grsecurity/grsec_sysctl.c  |   20 +++++++++
 include/linux/grmsg.h      |    1 +
 include/linux/grsecurity.h |    5 ++
 include/linux/sched.h      |    3 +
 kernel/cred.c              |   99 +++++++++++++++++++++++++++++++++++++++++++-
 kernel/sched.c             |   15 +++++++
 10 files changed, 201 insertions(+), 1 deletions(-)

commit 92000b859586a6b038677130f663e9edff061237
Merge: dba507f fc57040
Author: Brad Spengler <spender@grsecurity.net>
Date:   Wed Jan 25 21:00:24 2012 -0500

    Merge branch 'pax-stable' into grsec-stable
    
    Conflicts:
    	block/scsi_ioctl.c
    	include/linux/blkdev.h

commit fc57040683d2aa303e148af2ef132effdcaaaee2
Merge: 67c46a7 b16a92f
Author: Brad Spengler <spender@grsecurity.net>
Date:   Wed Jan 25 20:53:21 2012 -0500

    Merge branch 'linux-2.6.32.y' into pax-stable

commit dba507f426a7dd006b70be6791be8cdb7def63f6
Author: Brad Spengler <spender@grsecurity.net>
Date:   Sun Jan 22 16:33:53 2012 -0500

    Fix booting on !SMP kernels, ATOM failure reported on forums
    Thanks to THE PaX TEAM for debugging

 kernel/sched.c |    3 +--
 1 files changed, 1 insertions(+), 2 deletions(-)

commit 8521d8b3e6c223880eacc9d7cd4812a88f0b923d
Merge: 30109c8 67c46a7
Author: Brad Spengler <spender@grsecurity.net>
Date:   Fri Jan 20 18:07:18 2012 -0500

    Merge branch 'pax-stable' into grsec-stable

commit 67c46a75571a1ca1dd33a1fd671d76c5bfd443ba
Author: Brad Spengler <spender@grsecurity.net>
Date:   Fri Jan 20 18:07:02 2012 -0500

    Merge the diff between pax-linux-3.2.1-test4.patch and pax-linux-3.2.1-test5.patch
    Denies executable shared memory when MPROTECT is active
    Fixes ia32 emulation crash on 64bit host introduced in a recent patch

 arch/x86/ia32/ia32entry.S |    1 +
 ipc/shm.c                 |    6 ++++++
 2 files changed, 7 insertions(+), 0 deletions(-)

commit 30109c8e22c19788b939a4041adbb172c44d2610
Author: Brad Spengler <spender@grsecurity.net>
Date:   Thu Jan 19 20:09:25 2012 -0500

    add function declaration

 fs/proc/base.c |    2 ++
 1 files changed, 2 insertions(+), 0 deletions(-)

commit 5610ac72e149f1f62f0f0099311cc6e10a7a664e
Author: Brad Spengler <spender@grsecurity.net>
Date:   Thu Jan 19 20:05:08 2012 -0500

    Add a temporary workaround on the read end while upstream prepares a backport

 fs/proc/base.c |    6 ++++++
 1 files changed, 6 insertions(+), 0 deletions(-)

commit 154d61840ac22c4004e12ae6a5533ee5d63805f7
Author: Brad Spengler <spender@grsecurity.net>
Date:   Thu Jan 19 19:35:31 2012 -0500

    Revert "Backport new /proc/pid/mem code.  mem_write was always disabled in this kernel,"
    
    This reverts commit 76ab55b3a022f98fbd01659b86df6eb56a74145a.

 fs/proc/base.c |  132 +++++++++++++++++++++++++++++++++++---------------------
 1 files changed, 82 insertions(+), 50 deletions(-)

commit d92e4f83f07a2835b7bef4a6b308450fd0a8325f
Author: Brad Spengler <spender@grsecurity.net>
Date:   Thu Jan 19 19:35:03 2012 -0500

    Revert "Fix up /proc/pid/mem backport, introduce new access_process_mm function"
    
    This reverts commit 20302b5879500d6c6ad185afeb1ed2fcbfea03ad.

 fs/proc/base.c     |   12 +++++++-----
 include/linux/mm.h |    1 -
 mm/memory.c        |   14 ++------------
 3 files changed, 9 insertions(+), 18 deletions(-)

commit 20302b5879500d6c6ad185afeb1ed2fcbfea03ad
Author: Brad Spengler <spender@grsecurity.net>
Date:   Thu Jan 19 18:35:52 2012 -0500

    Fix up /proc/pid/mem backport, introduce new access_process_mm function

 fs/proc/base.c     |   12 +++++-------
 include/linux/mm.h |    1 +
 mm/memory.c        |   14 ++++++++++++--
 3 files changed, 18 insertions(+), 9 deletions(-)

commit 76ab55b3a022f98fbd01659b86df6eb56a74145a
Author: Brad Spengler <spender@grsecurity.net>
Date:   Thu Jan 19 17:38:54 2012 -0500

    Backport new /proc/pid/mem code.  mem_write was always disabled in this kernel,
    but this cleans up the read side also.  Thank Linus for silent fixes!

 fs/proc/base.c |  132 +++++++++++++++++++++-----------------------------------
 1 files changed, 50 insertions(+), 82 deletions(-)

commit d40034db02aed3e9ed60ac2f99e74732843eb715
Author: Brad Spengler <spender@grsecurity.net>
Date:   Wed Jan 18 20:52:50 2012 -0500

    Fix compilation failure from scsi ioctl backport

 block/scsi_ioctl.c |    5 +++--
 1 files changed, 3 insertions(+), 2 deletions(-)

commit ef1a97e74a43f77107a7da1e0133bf9a75c4932c
Author: Sean Hefty <sean.hefty@intel.com>
Date:   Tue Dec 6 21:17:11 2011 +0000

    RDMA/cma: Verify private data length
    
    private_data_len is defined as a u8.  If the user specifies a large
    private_data size (> 220 bytes), we will calculate a total length that
    exceeds 255, resulting in private_data_len wrapping back to 0.  This
    can lead to overwriting random kernel memory.  Avoid this by verifying
    that the resulting size fits into a u8.
    
    Reported-by: B. Thery <benjamin.thery@bull.net>
    Addresses: <http://bugs.openfabrics.org/bugzilla/show_bug.cgi?id=2335>
    Signed-off-by: Sean Hefty <sean.hefty@intel.com>
    Signed-off-by: Roland Dreier <roland@purestorage.com>

 drivers/infiniband/core/cma.c |    6 ++++++
 1 files changed, 6 insertions(+), 0 deletions(-)

commit 7950775d75bccd58dc4c0e9bdc4b0388d823bb8d
Author: Haogang Chen <haogangchen@gmail.com>
Date:   Mon Dec 19 17:11:56 2011 -0800

    nilfs2: potential integer overflow in nilfs_ioctl_clean_segments()
    
    There is a potential integer overflow in nilfs_ioctl_clean_segments().
    When a large argv[n].v_nmembs is passed from the userspace, the subsequent
    call to vmalloc() will allocate a buffer smaller than expected, which
    leads to out-of-bound access in nilfs_ioctl_move_blocks() and
    lfs_clean_segments().
    
    The following check does not prevent the overflow because nsegs is also
    controlled by the userspace and could be very large.
    
    		if (argv[n].v_nmembs > nsegs * nilfs->ns_blocks_per_segment)
    			goto out_free;
    
    This patch clamps argv[n].v_nmembs to UINT_MAX / argv[n].v_size, and
    returns -EINVAL when overflow.
    
    Signed-off-by: Haogang Chen <haogangchen@gmail.com>
    Signed-off-by: Ryusuke Konishi <konishi.ryusuke@lab.ntt.co.jp>
    Signed-off-by: Andrew Morton <akpm@linux-foundation.org>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>

 fs/nilfs2/ioctl.c |    3 +++
 1 files changed, 3 insertions(+), 0 deletions(-)

commit ea35b13e49ba29ef73250d150061f2c1121656da
Author: Jesper Juhl <jj@chaosbits.net>
Date:   Sun Jan 8 22:44:29 2012 +0100

    audit: always follow va_copy() with va_end()
    
    A call to va_copy() should always be followed by a call to va_end() in
    the same function.  In kernel/autit.c::audit_log_vformat() this is not
    always done.  This patch makes sure va_end() is always called.
    
    Signed-off-by: Jesper Juhl <jj@chaosbits.net>
    Cc: Al Viro <viro@zeniv.linux.org.uk>
    Cc: Eric Paris <eparis@redhat.com>
    Cc: Andrew Morton <akpm@linux-foundation.org>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>

 kernel/audit.c |    5 +++--
 1 files changed, 3 insertions(+), 2 deletions(-)

commit 7a73189b0652fa9a04a940a1e704ff3ae6805a08
Author: Andi Kleen <ak@linux.intel.com>
Date:   Thu Jan 12 17:20:30 2012 -0800

    panic: don't print redundant backtraces on oops
    
    When an oops causes a panic and panic prints another backtrace it's pretty
    common to have the original oops data be scrolled away on a 80x50 screen.
    
    The second backtrace is quite redundant and not needed anyways.
    
    So don't print the panic backtrace when oops_in_progress is true.
    
    [akpm@linux-foundation.org: add comment]
    Signed-off-by: Andi Kleen <ak@linux.intel.com>
    Cc: Michael Holzheu <holzheu@linux.vnet.ibm.com>
    Signed-off-by: Andrew Morton <akpm@linux-foundation.org>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>

 kernel/panic.c |    6 +++++-
 1 files changed, 5 insertions(+), 1 deletions(-)

commit dce1c3c84d1290ab1e54709e7e857eca4bc658e4
Author: Paolo Bonzini <pbonzini@redhat.com>
Date:   Thu Jan 12 16:01:28 2012 +0100

    block: fail SCSI passthrough ioctls on partition devices
    
    Linux allows executing the SG_IO ioctl on a partition or LVM volume, and
    will pass the command to the underlying block device.  This is
    well-known, but it is also a large security problem when (via Unix
    permissions, ACLs, SELinux or a combination thereof) a program or user
    needs to be granted access only to part of the disk.
    
    This patch lets partitions forward a small set of harmless ioctls;
    others are logged with printk so that we can see which ioctls are
    actually sent.  In my tests only CDROM_GET_CAPABILITY actually occurred.
    Of course it was being sent to a (partition on a) hard disk, so it would
    have failed with ENOTTY and the patch isn't changing anything in
    practice.  Still, I'm treating it specially to avoid spamming the logs.
    
    In principle, this restriction should include programs running with
    CAP_SYS_RAWIO.  If for example I let a program access /dev/sda2 and
    /dev/sdb, it still should not be able to read/write outside the
    boundaries of /dev/sda2 independent of the capabilities.  However, for
    now programs with CAP_SYS_RAWIO will still be allowed to send the
    ioctls.  Their actions will still be logged.
    
    This patch does not affect the non-libata IDE driver.  That driver
    however already tests for bd != bd->bd_contains before issuing some
    ioctl; it could be restricted further to forbid these ioctls even for
    programs running with CAP_SYS_ADMIN/CAP_SYS_RAWIO.
    
    Cc: linux-scsi@vger.kernel.org
    Cc: Jens Axboe <axboe@kernel.dk>
    Cc: James Bottomley <JBottomley@parallels.com>
    Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>
    [ Make it also print the command name when warning - Linus ]
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>

 block/scsi_ioctl.c     |   45 +++++++++++++++++++++++++++++++++++++++++++++
 drivers/scsi/sd.c      |   11 +++++++++--
 include/linux/blkdev.h |    1 +
 3 files changed, 55 insertions(+), 2 deletions(-)

commit edb680c4c184ee6001b68d3dd89eb1729f4e884e
Author: Paolo Bonzini <pbonzini@redhat.com>
Date:   Thu Jan 12 16:01:27 2012 +0100

    block: add and use scsi_blk_cmd_ioctl
    
    Introduce a wrapper around scsi_cmd_ioctl that takes a block device.
    
    The function will then be enhanced to detect partition block devices
    and, in that case, subject the ioctls to whitelisting.
    
    Cc: linux-scsi@vger.kernel.org
    Cc: Jens Axboe <axboe@kernel.dk>
    Cc: James Bottomley <JBottomley@parallels.com>
    Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
    
    Conflicts:
    
    	block/scsi_ioctl.c
    	drivers/block/ub.c

 block/scsi_ioctl.c             |    9 ++++++++-
 drivers/block/cciss.c          |    6 +++---
 drivers/block/ub.c             |    3 +--
 drivers/block/virtio_blk.c     |    4 ++--
 drivers/cdrom/cdrom.c          |    3 +--
 drivers/ide/ide-floppy_ioctl.c |    3 +--
 drivers/scsi/sd.c              |    2 +-
 include/linux/blkdev.h         |    2 ++
 8 files changed, 19 insertions(+), 13 deletions(-)

commit 061fb16341f6cf32dec1412ce116464c70b0d95f
Author: Xi Wang <xi.wang@gmail.com>
Date:   Tue Dec 20 18:39:41 2011 -0500

    audit: fix signedness bug in audit_log_execve_info()
    
    In the loop, a size_t "len" is used to hold the return value of
    audit_log_single_execve_arg(), which returns -1 on error.  In that
    case the error handling (len <= 0) will be bypassed since "len" is
    unsigned, and the loop continues with (p += len) being wrapped.
    Change the type of "len" to signed int to fix the error handling.
    
    	size_t len;
    	...
    	for (...) {
    		len = audit_log_single_execve_arg(...);
    		if (len <= 0)
    			break;
    		p += len;
    	}
    
    Signed-off-by: Xi Wang <xi.wang@gmail.com>
    Signed-off-by: Eric Paris <eparis@redhat.com>

 kernel/auditsc.c |    4 ++--
 1 files changed, 2 insertions(+), 2 deletions(-)

commit 7014fc59a8a5394895e6465548c241f31bcb7877
Author: Brad Spengler <spender@grsecurity.net>
Date:   Mon Jan 16 13:10:38 2012 -0500

    Ignore the 0 signal for protected task RBAC checks

 grsecurity/grsec_sig.c |    3 ++-
 1 files changed, 2 insertions(+), 1 deletions(-)

commit b830280ce3a4a3754316c3cd12cefb8a586af1c5
Merge: 82c4d27 8090897
Author: Brad Spengler <spender@grsecurity.net>
Date:   Fri Jan 13 20:12:25 2012 -0500

    Merge branch 'pax-stable' into grsec-stable

commit 809089761a4174c5930437b999ed833b278fc8e6
Merge: ac9dda1 f2ab2a1
Author: Brad Spengler <spender@grsecurity.net>
Date:   Fri Jan 13 20:12:12 2012 -0500

    Merge branch 'linux-2.6.32.y' into pax-stable

commit 82c4d27919566155486cde8b2858af49235d4153
Merge: 2ac6c6e ac9dda1
Author: Brad Spengler <spender@grsecurity.net>
Date:   Tue Jan 10 15:59:49 2012 -0500

    Merge branch 'pax-stable' into grsec-stable

commit ac9dda17072962f93205e391640659362e6b24db
Author: Brad Spengler <spender@grsecurity.net>
Date:   Tue Jan 10 15:59:25 2012 -0500

    Merge changes from pax-linux-2.6.32.53-test135.patch

 arch/x86/include/asm/alternative-asm.h |    4 +-
 arch/x86/include/asm/atomic_32.h       |    4 +-
 arch/x86/mm/fault.c                    |   52 ++++++++++++++++++++++++++++++++
 security/Kconfig                       |    6 +--
 4 files changed, 58 insertions(+), 8 deletions(-)

commit 2ac6c6e4c325498d003ea386a96840e9547ca327
Author: Brad Spengler <spender@grsecurity.net>
Date:   Sun Jan 8 08:32:08 2012 -0500

    Fix PaX mismerge

 fs/binfmt_elf.c |   15 ---------------
 1 files changed, 0 insertions(+), 15 deletions(-)

commit f6dbbbfe4ca34f02d73a552b32a9584388fcf6c2
Merge: 61b0458 b82c81b
Author: Brad Spengler <spender@grsecurity.net>
Date:   Fri Jan 6 21:52:55 2012 -0500

    Merge branch 'pax-stable' into grsec-stable
    
    Conflicts:
    	fs/binfmt_elf.c
    	security/Kconfig

commit b82c81b15dc819fa6ca7ad3b107affa8f2c430bb
Author: Brad Spengler <spender@grsecurity.net>
Date:   Fri Jan 6 21:49:36 2012 -0500

    Resync with PaX patch

 security/keys/process_keys.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit 41d57e6fda4b1041f35c4a1917a685e607deaeaa
Author: Brad Spengler <spender@grsecurity.net>
Date:   Fri Jan 6 21:47:59 2012 -0500

    Merge changes from pax-linux-2.6.32.53-test134.patch

 Makefile                         |    4 +
 arch/x86/ia32/ia32entry.S        |    2 +
 arch/x86/kernel/cpu/common.c     |    2 +-
 arch/x86/kernel/entry_64.S       |    4 +-
 fs/binfmt_elf.c                  |  216 ++++++++++++++++++++++++++++++++++----
 fs/exec.c                        |    4 +
 include/linux/fsnotify_backend.h |    1 +
 include/linux/mm_types.h         |    2 +-
 include/linux/xattr.h            |    5 +
 mm/hugetlb.c                     |    1 +
 security/Kconfig                 |   71 +++++++++---
 11 files changed, 268 insertions(+), 44 deletions(-)

commit 61b04582f27377c7d94881df4b38dcc372eb1f6c
Merge: 114bfb5 f10ac11
Author: Brad Spengler <spender@grsecurity.net>
Date:   Fri Jan 6 18:50:19 2012 -0500

    Merge branch 'pax-stable' into grsec-stable

commit f10ac1153528d345f26fcaad68629e0df5fbcfef
Merge: df4852a 8761f65
Author: Brad Spengler <spender@grsecurity.net>
Date:   Fri Jan 6 18:50:08 2012 -0500

    Merge branch 'linux-2.6.32.y' into pax-stable

commit 114bfb503640c1a7996f0b73b1aedfa4cdedf194
Merge: 0da4531 df4852a
Author: Brad Spengler <spender@grsecurity.net>
Date:   Tue Jan 3 17:43:52 2012 -0500

    Merge branch 'pax-stable' into grsec-stable

commit df4852aee85c5ad79e646d800784f1543811b525
Merge: 7949551 7d48308
Author: Brad Spengler <spender@grsecurity.net>
Date:   Tue Jan 3 17:43:12 2012 -0500

    Merge branch 'linux-2.6.32.y' into pax-stable

commit 0da4531e30203699c87c0916f93dc97b4e502288
Author: Brad Spengler <spender@grsecurity.net>
Date:   Mon Jan 2 13:19:20 2012 -0500

    Remove unnecessary headers

 kernel/printk.c |    2 --
 1 files changed, 0 insertions(+), 2 deletions(-)

commit 9b2166d9cf2add837c5e614e69f87687c322df5f
Author: Brad Spengler <spender@grsecurity.net>
Date:   Mon Jan 2 13:14:49 2012 -0500

    Don't do permission checks on already-opened /proc/kmsg

 kernel/printk.c |    4 +++-
 1 files changed, 3 insertions(+), 1 deletions(-)

commit 2f3673e68b7a6a3e2d2648b3558c7fae9c097ef3
Author: Kees Cook <kees.cook@canonical.com>
Date:   Wed Feb 3 15:37:13 2010 -0800

    syslog: use defined constants instead of raw numbers
    
    Right now the syslog "type" action are just raw numbers which makes
    the source difficult to follow.  This patch replaces the raw numbers
    with defined constants for some level of sanity.
    
    Signed-off-by: Kees Cook <kees.cook@canonical.com>
    Acked-by: John Johansen <john.johansen@canonical.com>
    Acked-by: Serge Hallyn <serue@us.ibm.com>
    Signed-off-by: James Morris <jmorris@namei.org>

 fs/proc/kmsg.c           |   10 +++++-----
 include/linux/syslog.h   |   23 +++++++++++++++++++++++
 kernel/printk.c          |   45 +++++++++++++++++++--------------------------
 security/commoncap.c     |    5 +++--
 security/selinux/hooks.c |   21 +++++++++++----------
 5 files changed, 61 insertions(+), 43 deletions(-)

commit e5cc64c2dba9091f2de889856aecd6823ce72300
Author: Kees Cook <kees.cook@canonical.com>
Date:   Wed Feb 3 15:36:43 2010 -0800

    syslog: distinguish between /proc/kmsg and syscalls
    
    This allows the LSM to distinguish between syslog functions originating
    from /proc/kmsg access and direct syscalls.  By default, the commoncaps
    will now no longer require CAP_SYS_ADMIN to read an opened /proc/kmsg
    file descriptor.  For example the kernel syslog reader can now drop
    privileges after opening /proc/kmsg, instead of staying privileged with
    CAP_SYS_ADMIN.  MAC systems that implement security_syslog have unchanged
    behavior.
    
    Signed-off-by: Kees Cook <kees.cook@canonical.com>
    Acked-by: Serge Hallyn <serue@us.ibm.com>
    Acked-by: John Johansen <john.johansen@canonical.com>
    Signed-off-by: James Morris <jmorris@namei.org>
    
    Conflicts:
    
    	kernel/printk.c
    	security/commoncap.c

 fs/proc/kmsg.c             |   14 +++++++-------
 include/linux/security.h   |   11 ++++++-----
 include/linux/syslog.h     |   29 +++++++++++++++++++++++++++++
 kernel/printk.c            |    9 ++++++---
 security/commoncap.c       |    8 +++++++-
 security/security.c        |    4 ++--
 security/selinux/hooks.c   |    5 +++--
 security/smack/smack_lsm.c |    4 ++--
 8 files changed, 62 insertions(+), 22 deletions(-)

commit a26a978a30c923c206222b35f63c385ccd09078f
Author: Brad Spengler <spender@grsecurity.net>
Date:   Thu Dec 22 20:20:44 2011 -0500

    Only further restrict futex targeting another process -- our modified
    permission check also happened to allow a case where a process retaining
    uid 0 could issue futex syscalls against other uid 0 tasks, despite the euid
    being non-zero (reported on forums by ben_w)

 kernel/futex.c        |    5 +----
 kernel/futex_compat.c |    5 +----
 2 files changed, 2 insertions(+), 8 deletions(-)

commit 4fafbf2459516939b5f25cbf706b4643d46378fc
Merge: 4efb1cc 7949551
Author: Brad Spengler <spender@grsecurity.net>
Date:   Thu Dec 22 19:17:47 2011 -0500

    Merge branch 'pax-stable' into grsec-stable
    
    Conflicts:
    	fs/hfs/btree.c

commit 7949551a30f3c9e2a023f7505c7c471308724a0a
Merge: aec65dc c8375e7
Author: Brad Spengler <spender@grsecurity.net>
Date:   Thu Dec 22 19:16:36 2011 -0500

    Merge branch 'linux-2.6.32.y' into pax-stable
    
    Conflicts:
    	arch/x86/oprofile/backtrace.c

commit 4efb1cc0ba6231a5a50520d38cbd2a5d07255c9d
Author: Brad Spengler <spender@grsecurity.net>
Date:   Sat Dec 10 17:39:00 2011 -0500

    Fix bad grsec merge

 arch/x86/include/asm/uaccess_64.h |    1 -
 1 files changed, 0 insertions(+), 1 deletions(-)

commit 7d957810e34013de3f08088d63f22f8bfa77dc12
Author: Brad Spengler <spender@grsecurity.net>
Date:   Sat Dec 10 17:36:45 2011 -0500

    Revert "Fix bad PaX merge", applying to PaX tree
    
    This reverts commit 51cd08176e7cd4580b7e0063c5785330f5738cbf.

 arch/x86/include/asm/uaccess_64.h |    1 +
 1 files changed, 1 insertions(+), 0 deletions(-)

commit 71b3842e15793661ff851921f5a884e3f5b86601
Author: Brad Spengler <spender@grsecurity.net>
Date:   Sat Dec 10 17:34:27 2011 -0500

    Fix bad PaX merge

 arch/x86/include/asm/uaccess_64.h |    1 -
 1 files changed, 0 insertions(+), 1 deletions(-)

commit f8493e6a4cecade98e35fe0d47e33083331b6a61
Author: Brad Spengler <spender@grsecurity.net>
Date:   Wed Dec 7 20:00:29 2011 -0500

    Remove harmless duplicate code -- exec_file would be null already so the
    second check would never pass.

 kernel/exit.c |   11 -----------
 1 files changed, 0 insertions(+), 11 deletions(-)

commit 4ca5b26a5e088e244aa5ad4514f7dfce0c2e0bfc
Author: Brad Spengler <spender@grsecurity.net>
Date:   Wed Dec 7 19:48:24 2011 -0500

    Revert back to (possibly?) undocumented /proc/pid behavior that gdb depended
    on for attaching to a thread.  Entries exist in /proc for threads, but
    are not visible in a readdir.

 fs/proc/base.c |    3 ---
 1 files changed, 0 insertions(+), 3 deletions(-)

commit 2d46e078d7012ad27099e9608f55f8f49413e96e
Author: Xi Wang <xi.wang@gmail.com>
Date:   Tue Nov 29 09:26:30 2011 +0000

    sctp: better integer overflow check in sctp_auth_create_key()
    
    The check from commit 30c2235c is incomplete and cannot prevent
    cases like key_len = 0x80000000 (INT_MAX + 1).  In that case, the
    left-hand side of the check (INT_MAX - key_len), which is unsigned,
    becomes 0xffffffff (UINT_MAX) and bypasses the check.
    
    However this shouldn't be a security issue.  The function is called
    from the following two code paths:
    
     1) setsockopt()
    
     2) sctp_auth_asoc_set_secret()
    
    In case (1), sca_keylength is never going to exceed 65535 since it's
    bounded by a u16 from the user API.  As such, the key length will
    never overflow.
    
    In case (2), sca_keylength is computed based on the user key (1 short)
    and 2 * key_vector (3 shorts) for a total of 7 * USHRT_MAX, which still
    will not overflow.
    
    In other words, this overflow check is not really necessary.  Just
    make it more correct.
    
    Signed-off-by: Xi Wang <xi.wang@gmail.com>
    Cc: Vlad Yasevich <vladislav.yasevich@hp.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

 net/sctp/auth.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit a717856a241763bf7227a8485518dbf38c6db355
Author: Julia Lawall <julia@diku.dk>
Date:   Tue Nov 15 14:53:11 2011 -0800

    drivers/gpu/vga/vgaarb.c: add missing kfree
    
    kbuf is a buffer that is local to this function, so all of the error paths
    leaving the function should release it.
    
    Signed-off-by: Julia Lawall <julia@diku.dk>
    Cc: Jesper Juhl <jj@chaosbits.net>
    Signed-off-by: Andrew Morton <akpm@linux-foundation.org>
    Signed-off-by: Dave Airlie <airlied@redhat.com>

 drivers/gpu/vga/vgaarb.c |   18 ++++++++++++------
 1 files changed, 12 insertions(+), 6 deletions(-)

commit 816c0eb7a243d2b367de4fe4f76a7694cd1bce2a
Author: Brad Spengler <spender@grsecurity.net>
Date:   Sat Dec 3 20:44:54 2011 -0500

    Import changes between PaX and grsecurity-2.2.2-2.6.32.49-201112032036.patch

 Documentation/dontdiff                           |    1 +
 Makefile                                         |   12 +-
 arch/arm/kernel/kgdb.c                           |    2 +-
 arch/arm/kernel/traps.c                          |    4 +
 arch/arm/mach-at91/pm.c                          |    2 +-
 arch/arm/mach-omap1/pm.c                         |    2 +-
 arch/arm/mach-omap2/pm24xx.c                     |    2 +-
 arch/arm/mach-omap2/pm34xx.c                     |    2 +-
 arch/arm/mach-pnx4008/pm.c                       |    2 +-
 arch/arm/mach-pxa/pm.c                           |    2 +-
 arch/arm/mach-pxa/sharpsl_pm.c                   |    2 +-
 arch/arm/mach-sa1100/pm.c                        |    2 +-
 arch/arm/plat-s3c/pm.c                           |    2 +-
 arch/avr32/mach-at32ap/pm.c                      |    2 +-
 arch/blackfin/kernel/kgdb.c                      |    2 +-
 arch/blackfin/mach-common/pm.c                   |    2 +-
 arch/ia64/hp/common/hwsw_iommu.c                 |    4 +-
 arch/ia64/hp/common/sba_iommu.c                  |    4 +-
 arch/ia64/include/asm/dma-mapping.h              |   10 +-
 arch/ia64/include/asm/machvec.h                  |    4 +-
 arch/ia64/kernel/dma-mapping.c                   |    4 +-
 arch/ia64/kernel/pci-dma.c                       |   35 +-
 arch/ia64/kernel/pci-swiotlb.c                   |    2 +-
 arch/ia64/kernel/topology.c                      |    2 +-
 arch/ia64/sn/pci/pci_dma.c                       |    2 +-
 arch/mips/Makefile                               |    2 +
 arch/mips/alchemy/devboards/pm.c                 |    2 +-
 arch/mips/include/asm/reboot.h                   |    4 +-
 arch/mips/kernel/kgdb.c                          |    1 +
 arch/mips/kernel/reset.c                         |    7 +-
 arch/powerpc/Makefile                            |    2 +
 arch/powerpc/include/asm/device.h                |    2 +-
 arch/powerpc/include/asm/dma-mapping.h           |   16 +-
 arch/powerpc/include/asm/iommu.h                 |    3 +
 arch/powerpc/include/asm/pci.h                   |    4 +-
 arch/powerpc/include/asm/ptrace.h                |    2 +-
 arch/powerpc/include/asm/swiotlb.h               |    2 +-
 arch/powerpc/kernel/cacheinfo.c                  |    2 +-
 arch/powerpc/kernel/dma-iommu.c                  |    2 +-
 arch/powerpc/kernel/dma-swiotlb.c                |    2 +-
 arch/powerpc/kernel/dma.c                        |    2 +-
 arch/powerpc/kernel/ibmebus.c                    |    2 +-
 arch/powerpc/kernel/kgdb.c                       |    2 +-
 arch/powerpc/kernel/pci-common.c                 |    6 +-
 arch/powerpc/kernel/process.c                    |   10 +-
 arch/powerpc/kernel/ptrace.c                     |    4 +-
 arch/powerpc/kernel/traps.c                      |    4 +
 arch/powerpc/kernel/vio.c                        |    3 +-
 arch/powerpc/mm/mem.c                            |    2 +-
 arch/powerpc/platforms/52xx/lite5200_pm.c        |    2 +-
 arch/powerpc/platforms/52xx/mpc52xx_pm.c         |    2 +-
 arch/powerpc/platforms/83xx/suspend.c            |    2 +-
 arch/powerpc/platforms/cell/iommu.c              |    2 +-
 arch/powerpc/platforms/ps3/system-bus.c          |    4 +-
 arch/sh/boards/mach-hp6xx/pm.c                   |    2 +-
 arch/sh/kernel/cpu/sh4/sq.c                      |    2 +-
 arch/sh/kernel/cpu/shmobile/pm.c                 |    2 +-
 arch/sh/kernel/kgdb.c                            |    2 +-
 arch/sparc/Makefile                              |    2 +-
 arch/sparc/include/asm/dma-mapping.h             |    8 +-
 arch/sparc/include/asm/spinlock_64.h             |    4 +-
 arch/sparc/kernel/iommu.c                        |    4 +-
 arch/sparc/kernel/ioport.c                       |    6 +-
 arch/sparc/kernel/kgdb_32.c                      |    2 +-
 arch/sparc/kernel/kgdb_64.c                      |    2 +-
 arch/sparc/kernel/pci_sun4v.c                    |    2 +-
 arch/sparc/kernel/process_32.c                   |    8 +-
 arch/sparc/kernel/process_64.c                   |    8 +-
 arch/sparc/kernel/sigutil_64.c                   |    1 +
 arch/sparc/kernel/traps_32.c                     |    8 +-
 arch/sparc/kernel/traps_64.c                     |   27 +-
 arch/sparc/kernel/unaligned_64.c                 |    2 +-
 arch/sparc/mm/fault_64.c                         |    2 +-
 arch/x86/Kconfig                                 |    5 +-
 arch/x86/Makefile                                |    2 +-
 arch/x86/boot/compressed/head_64.S               |    2 +-
 arch/x86/ia32/ia32_aout.c                        |    8 +-
 arch/x86/include/asm/device.h                    |    2 +-
 arch/x86/include/asm/dma-mapping.h               |   10 +-
 arch/x86/include/asm/iommu.h                     |    2 +-
 arch/x86/include/asm/kvm_host.h                  |    2 +-
 arch/x86/include/asm/microcode.h                 |   14 +-
 arch/x86/include/asm/mmu_context.h               |    2 +-
 arch/x86/include/asm/pci_x86.h                   |   10 +-
 arch/x86/include/asm/smp.h                       |    5 +-
 arch/x86/include/asm/uaccess_32.h                |    4 +
 arch/x86/include/asm/uaccess_64.h                |    6 +
 arch/x86/kernel/acpi/realmode/wakeup.S           |    4 +
 arch/x86/kernel/acpi/sleep.c                     |    2 +-
 arch/x86/kernel/amd_iommu.c                      |    2 +-
 arch/x86/kernel/apic/apic.c                      |    2 +
 arch/x86/kernel/cpu/intel_cacheinfo.c            |    2 +-
 arch/x86/kernel/cpu/mcheck/mce_amd.c             |    2 +-
 arch/x86/kernel/cpu/mtrr/amd.c                   |    2 +-
 arch/x86/kernel/cpu/mtrr/centaur.c               |    2 +-
 arch/x86/kernel/cpu/mtrr/cyrix.c                 |    2 +-
 arch/x86/kernel/cpu/mtrr/generic.c               |    2 +-
 arch/x86/kernel/cpu/mtrr/main.c                  |    6 +-
 arch/x86/kernel/cpu/mtrr/mtrr.h                  |    6 +-
 arch/x86/kernel/cpu/perfctr-watchdog.c           |   12 +-
 arch/x86/kernel/dumpstack.c                      |   10 +-
 arch/x86/kernel/early_printk.c                   |    2 +
 arch/x86/kernel/entry_32.S                       |    2 +-
 arch/x86/kernel/entry_64.S                       |    2 +-
 arch/x86/kernel/head_32.S                        |   24 +-
 arch/x86/kernel/ioport.c                         |   13 +
 arch/x86/kernel/kgdb.c                           |    2 +-
 arch/x86/kernel/microcode_amd.c                  |    4 +-
 arch/x86/kernel/microcode_core.c                 |    2 +-
 arch/x86/kernel/microcode_intel.c                |    4 +-
 arch/x86/kernel/paravirt.c                       |    4 +-
 arch/x86/kernel/pci-calgary_64.c                 |    2 +-
 arch/x86/kernel/pci-dma.c                        |    4 +-
 arch/x86/kernel/pci-gart_64.c                    |    2 +-
 arch/x86/kernel/pci-nommu.c                      |    2 +-
 arch/x86/kernel/pci-swiotlb.c                    |    2 +-
 arch/x86/kernel/process.c                        |    1 +
 arch/x86/kernel/signal.c                         |    2 +
 arch/x86/kernel/smpboot.c                        |    4 +-
 arch/x86/kernel/trampoline_64.S                  |    2 +-
 arch/x86/kernel/verify_cpu.S                     |  140 +
 arch/x86/kernel/verify_cpu_64.S                  |  105 -
 arch/x86/kernel/vm86_32.c                        |   16 +
 arch/x86/kvm/paging_tmpl.h                       |    2 +
 arch/x86/kvm/svm.c                               |    2 +-
 arch/x86/kvm/vmx.c                               |    2 +-
 arch/x86/kvm/x86.c                               |    4 +-
 arch/x86/lib/copy_user_64.S                      |    2 +-
 arch/x86/mm/fault.c                              |   13 +-
 arch/x86/mm/init.c                               |   17 +-
 arch/x86/pci/common.c                            |    4 +-
 arch/x86/pci/direct.c                            |    6 +-
 arch/x86/pci/mmconfig_32.c                       |    2 +-
 arch/x86/pci/mmconfig_64.c                       |    2 +-
 arch/x86/pci/numaq_32.c                          |    2 +-
 arch/x86/pci/olpc.c                              |    2 +-
 arch/x86/pci/pcbios.c                            |    4 +-
 block/blk-integrity.c                            |    2 +-
 block/blk-sysfs.c                                |    2 +-
 block/elevator.c                                 |    2 +-
 crypto/serpent.c                                 |    3 +
 drivers/acpi/battery.c                           |    2 +-
 drivers/acpi/dock.c                              |    4 +-
 drivers/acpi/sleep.c                             |    8 +-
 drivers/acpi/video.c                             |    2 +-
 drivers/ata/ahci.c                               |    8 +-
 drivers/ata/ata_generic.c                        |    2 +-
 drivers/ata/ata_piix.c                           |   10 +-
 drivers/ata/libata-acpi.c                        |    4 +-
 drivers/ata/libata-core.c                        |    6 +-
 drivers/ata/libata-eh.c                          |    4 +-
 drivers/ata/libata-pmp.c                         |    2 +-
 drivers/ata/pata_acpi.c                          |    2 +-
 drivers/ata/pata_ali.c                           |   10 +-
 drivers/ata/pata_amd.c                           |   12 +-
 drivers/ata/pata_artop.c                         |    4 +-
 drivers/ata/pata_at32.c                          |    2 +-
 drivers/ata/pata_at91.c                          |    2 +-
 drivers/ata/pata_atiixp.c                        |    2 +-
 drivers/ata/pata_atp867x.c                       |    2 +-
 drivers/ata/pata_bf54x.c                         |    2 +-
 drivers/ata/pata_cmd640.c                        |    2 +-
 drivers/ata/pata_cmd64x.c                        |    6 +-
 drivers/ata/pata_cs5520.c                        |    2 +-
 drivers/ata/pata_cs5530.c                        |    2 +-
 drivers/ata/pata_cs5535.c                        |    2 +-
 drivers/ata/pata_cs5536.c                        |    2 +-
 drivers/ata/pata_cypress.c                       |    2 +-
 drivers/ata/pata_efar.c                          |    2 +-
 drivers/ata/pata_hpt366.c                        |    2 +-
 drivers/ata/pata_hpt37x.c                        |    8 +-
 drivers/ata/pata_hpt3x2n.c                       |    2 +-
 drivers/ata/pata_hpt3x3.c                        |    2 +-
 drivers/ata/pata_icside.c                        |    2 +-
 drivers/ata/pata_isapnp.c                        |    4 +-
 drivers/ata/pata_it8213.c                        |    2 +-
 drivers/ata/pata_it821x.c                        |    6 +-
 drivers/ata/pata_ixp4xx_cf.c                     |    2 +-
 drivers/ata/pata_jmicron.c                       |    2 +-
 drivers/ata/pata_legacy.c                        |   26 +-
 drivers/ata/pata_marvell.c                       |    2 +-
 drivers/ata/pata_mpc52xx.c                       |    2 +-
 drivers/ata/pata_mpiix.c                         |    2 +-
 drivers/ata/pata_netcell.c                       |    2 +-
 drivers/ata/pata_ninja32.c                       |    2 +-
 drivers/ata/pata_ns87410.c                       |    2 +-
 drivers/ata/pata_ns87415.c                       |    4 +-
 drivers/ata/pata_octeon_cf.c                     |    1 +
 drivers/ata/pata_oldpiix.c                       |    2 +-
 drivers/ata/pata_opti.c                          |    2 +-
 drivers/ata/pata_optidma.c                       |    4 +-
 drivers/ata/pata_palmld.c                        |    2 +-
 drivers/ata/pata_pcmcia.c                        |    6 +-
 drivers/ata/pata_pdc2027x.c                      |    4 +-
 drivers/ata/pata_pdc202xx_old.c                  |    4 +-
 drivers/ata/pata_platform.c                      |    2 +-
 drivers/ata/pata_qdi.c                           |    4 +-
 drivers/ata/pata_radisys.c                       |    2 +-
 drivers/ata/pata_rb532_cf.c                      |    2 +-
 drivers/ata/pata_rdc.c                           |    2 +-
 drivers/ata/pata_rz1000.c                        |    2 +-
 drivers/ata/pata_sc1200.c                        |    2 +-
 drivers/ata/pata_scc.c                           |    2 +-
 drivers/ata/pata_sch.c                           |    2 +-
 drivers/ata/pata_serverworks.c                   |    4 +-
 drivers/ata/pata_sil680.c                        |    2 +-
 drivers/ata/pata_sis.c                           |   14 +-
 drivers/ata/pata_sl82c105.c                      |    2 +-
 drivers/ata/pata_triflex.c                       |    2 +-
 drivers/ata/pata_via.c                           |    4 +-
 drivers/ata/pata_winbond.c                       |    2 +-
 drivers/ata/pdc_adma.c                           |    2 +-
 drivers/ata/sata_fsl.c                           |    2 +-
 drivers/ata/sata_inic162x.c                      |    2 +-
 drivers/ata/sata_mv.c                            |    6 +-
 drivers/ata/sata_nv.c                            |   10 +-
 drivers/ata/sata_promise.c                       |    6 +-
 drivers/ata/sata_qstor.c                         |    2 +-
 drivers/ata/sata_sil.c                           |    2 +-
 drivers/ata/sata_sil24.c                         |    2 +-
 drivers/ata/sata_sis.c                           |    2 +-
 drivers/ata/sata_svw.c                           |    2 +-
 drivers/ata/sata_sx4.c                           |    2 +-
 drivers/ata/sata_uli.c                           |    2 +-
 drivers/ata/sata_via.c                           |   10 +-
 drivers/ata/sata_vsc.c                           |    2 +-
 drivers/atm/solos-pci.c                          |    2 +
 drivers/base/bus.c                               |    6 +-
 drivers/base/class.c                             |    2 +-
 drivers/base/core.c                              |    4 +-
 drivers/base/memory.c                            |    2 +-
 drivers/base/sys.c                               |    4 +-
 drivers/block/DAC960.c                           |    2 +
 drivers/block/cciss.c                            |    2 +
 drivers/block/cpqarray.c                         |    2 +
 drivers/block/nbd.c                              |    4 +
 drivers/block/pktcdvd.c                          |    2 +-
 drivers/char/Kconfig                             |    4 +-
 drivers/char/briq_panel.c                        |    8 +-
 drivers/char/genrtc.c                            |    1 +
 drivers/char/hpet.c                              |    4 +-
 drivers/char/hvc_beat.c                          |    2 +-
 drivers/char/hvc_console.c                       |    6 +-
 drivers/char/hvc_console.h                       |    6 +-
 drivers/char/hvc_iseries.c                       |    2 +-
 drivers/char/hvc_iucv.c                          |    2 +-
 drivers/char/hvc_rtas.c                          |    2 +-
 drivers/char/hvc_udbg.c                          |    2 +-
 drivers/char/hvc_vio.c                           |    2 +-
 drivers/char/hvc_xen.c                           |    2 +-
 drivers/char/ipmi/ipmi_msghandler.c              |    2 +
 drivers/char/istallion.c                         |    6 +-
 drivers/char/keyboard.c                          |   10 +
 drivers/char/mem.c                               |   17 +
 drivers/char/random.c                            |   12 +
 drivers/char/rocket.c                            |    2 +
 drivers/char/stallion.c                          |    2 +
 drivers/char/tpm/tpm.c                           |    2 +
 drivers/char/tty_io.c                            |    1 +
 drivers/char/vt_ioctl.c                          |   13 +-
 drivers/cpufreq/cpufreq.c                        |    2 +-
 drivers/cpuidle/sysfs.c                          |    4 +-
 drivers/crypto/hifn_795x.c                       |    2 +
 drivers/crypto/padlock-aes.c                     |    2 +
 drivers/dma/ioat/dma.c                           |    2 +-
 drivers/dma/ioat/dma.h                           |    2 +-
 drivers/edac/edac_device_sysfs.c                 |    6 +-
 drivers/edac/edac_mc_sysfs.c                     |    4 +-
 drivers/edac/edac_pci_sysfs.c                    |    4 +-
 drivers/firewire/core-transaction.c              |    2 +
 drivers/firmware/edd.c                           |    2 +-
 drivers/firmware/efivars.c                       |    2 +-
 drivers/firmware/iscsi_ibft.c                    |    2 +-
 drivers/firmware/memmap.c                        |    2 +-
 drivers/gpu/drm/drm_crtc_helper.c                |    2 +
 drivers/gpu/drm/drm_info.c                       |   15 +-
 drivers/gpu/drm/i915/dvo.h                       |   16 +-
 drivers/gpu/drm/i915/dvo_ch7017.c                |    2 +-
 drivers/gpu/drm/i915/dvo_ch7xxx.c                |    2 +-
 drivers/gpu/drm/i915/dvo_ivch.c                  |    2 +-
 drivers/gpu/drm/i915/dvo_sil164.c                |    2 +-
 drivers/gpu/drm/i915/dvo_tfp410.c                |    2 +-
 drivers/gpu/drm/i915/i915_drv.c                  |    2 +-
 drivers/gpu/drm/i915/i915_gem.c                  |   10 -
 drivers/gpu/drm/radeon/atom.c                    |    2 +
 drivers/gpu/drm/radeon/radeon_atombios.c         |    2 +
 drivers/gpu/drm/ttm/ttm_bo.c                     |    2 +-
 drivers/gpu/drm/ttm/ttm_memory.c                 |    2 +-
 drivers/ide/ide-floppy.c                         |    2 +
 drivers/ide/setup-pci.c                          |    2 +
 drivers/infiniband/core/cm.c                     |    2 +-
 drivers/infiniband/core/sysfs.c                  |    2 +-
 drivers/infiniband/core/uverbs_marshall.c        |    4 +
 drivers/infiniband/hw/ipath/ipath_fs.c           |    2 +
 drivers/input/joystick/sidewinder.c              |    2 +
 drivers/isdn/hardware/eicon/capidtmf.c           |    1 +
 drivers/isdn/hardware/eicon/capifunc.c           |    2 +
 drivers/isdn/hardware/eicon/diddfunc.c           |    2 +
 drivers/isdn/hardware/eicon/divasfunc.c          |    2 +
 drivers/isdn/hardware/eicon/idifunc.c            |    2 +
 drivers/isdn/hardware/eicon/message.c            |    8 +
 drivers/isdn/hardware/eicon/mntfunc.c            |    2 +
 drivers/isdn/i4l/isdn_common.c                   |    2 +
 drivers/isdn/mISDN/socket.c                      |    2 +
 drivers/isdn/sc/interrupt.c                      |   18 +-
 drivers/macintosh/via-pmu-backlight.c            |    4 +-
 drivers/macintosh/via-pmu.c                      |    2 +-
 drivers/md/dm-sysfs.c                            |    2 +-
 drivers/md/md.c                                  |    7 +-
 drivers/md/raid5.c                               |    1 +
 drivers/media/common/saa7146_hlp.c               |    2 +
 drivers/media/dvb/dvb-core/dvb_ca_en50221.c      |    4 +
 drivers/media/dvb/dvb-usb/dib0700_core.c         |    2 +
 drivers/media/dvb/frontends/or51211.c            |    2 +
 drivers/media/video/cx18/cx18-driver.c           |    2 +
 drivers/media/video/pvrusb2/pvrusb2-eeprom.c     |    2 +
 drivers/media/video/saa7134/saa6752hs.c          |    2 +
 drivers/media/video/saa7164/saa7164-cmd.c        |    4 +
 drivers/media/video/usbvision/usbvision-core.c   |    2 +
 drivers/media/video/videobuf-dma-sg.c            |    2 +
 drivers/message/fusion/mptbase.c                 |    6 +
 drivers/message/i2o/i2o_config.c                 |    2 +
 drivers/mfd/wm8350-i2c.c                         |    2 +
 drivers/misc/kgdbts.c                            |    4 +-
 drivers/misc/sgi-xp/xpc_sn2.c                    |    6 +-
 drivers/misc/sgi-xp/xpc_uv.c                     |    6 +-
 drivers/mtd/chips/cfi_cmdset_0001.c              |    6 +
 drivers/mtd/chips/cfi_cmdset_0020.c              |   10 +
 drivers/mtd/ftl.c                                |    2 +
 drivers/mtd/inftlcore.c                          |    2 +
 drivers/mtd/inftlmount.c                         |    2 +
 drivers/mtd/lpddr/qinfo_probe.c                  |    2 +
 drivers/mtd/mtdchar.c                            |    2 +
 drivers/mtd/nftlcore.c                           |    2 +
 drivers/mtd/nftlmount.c                          |    2 +
 drivers/net/bnx2.c                               |    2 +
 drivers/net/cxgb3/t3_hw.c                        |    2 +
 drivers/net/e1000e/82571.c                       |   10 +-
 drivers/net/e1000e/e1000.h                       |    6 +-
 drivers/net/e1000e/es2lan.c                      |    6 +-
 drivers/net/e1000e/ich8lan.c                     |    6 +-
 drivers/net/hamradio/6pack.c                     |    2 +
 drivers/net/ibmveth.c                            |    2 +-
 drivers/net/igb/e1000_82575.c                    |    6 +-
 drivers/net/iseries_veth.c                       |    4 +-
 drivers/net/ixgb/ixgb_main.c                     |    2 +
 drivers/net/ixgb/ixgb_param.c                    |    3 +
 drivers/net/mlx4/main.c                          |    2 +
 drivers/net/niu.c                                |    2 +
 drivers/net/tulip/de2104x.c                      |    2 +
 drivers/net/vxge/vxge-main.c                     |    4 +
 drivers/net/wan/cycx_x25.c                       |    2 +
 drivers/net/wimax/i2400m/usb-fw.c                |    2 +
 drivers/net/wireless/airo.c                      |   12 +
 drivers/net/wireless/ath/ath5k/debug.c           |    4 +
 drivers/net/wireless/ath/ath9k/debug.c           |    4 +
 drivers/net/wireless/b43/debugfs.c               |    2 +-
 drivers/net/wireless/b43legacy/debugfs.c         |    2 +-
 drivers/net/wireless/ipw2x00/ipw2100.c           |    4 +
 drivers/net/wireless/ipw2x00/libipw_rx.c         |    2 +
 drivers/net/wireless/iwlwifi/iwl-1000.c          |    2 +-
 drivers/net/wireless/iwlwifi/iwl-3945.c          |    2 +-
 drivers/net/wireless/iwlwifi/iwl-4965.c          |    2 +-
 drivers/net/wireless/iwlwifi/iwl-5000.c          |    4 +-
 drivers/net/wireless/iwlwifi/iwl-6000.c          |    2 +-
 drivers/net/wireless/iwlwifi/iwl-agn-rs.c        |    4 +
 drivers/net/wireless/iwlwifi/iwl-debugfs.c       |    4 +
 drivers/net/wireless/iwlwifi/iwl-dev.h           |    2 +-
 drivers/net/wireless/iwmc3200wifi/debugfs.c      |    2 +
 drivers/net/wireless/libertas/debugfs.c          |    2 +-
 drivers/parisc/pdc_stable.c                      |    2 +-
 drivers/pci/hotplug/acpiphp_glue.c               |    2 +-
 drivers/pci/hotplug/fakephp.c                    |    2 +-
 drivers/pci/intel-iommu.c                        |   16 +-
 drivers/pci/proc.c                               |    9 +
 drivers/pci/slot.c                               |    2 +-
 drivers/platform/x86/acer-wmi.c                  |    2 +-
 drivers/platform/x86/asus-laptop.c               |    2 +-
 drivers/platform/x86/asus_acpi.c                 |    2 +-
 drivers/platform/x86/compal-laptop.c             |    2 +-
 drivers/platform/x86/dell-laptop.c               |    2 +-
 drivers/platform/x86/eeepc-laptop.c              |    2 +-
 drivers/platform/x86/fujitsu-laptop.c            |    2 +-
 drivers/platform/x86/msi-laptop.c                |    2 +-
 drivers/platform/x86/panasonic-laptop.c          |    2 +-
 drivers/platform/x86/sony-laptop.c               |    2 +-
 drivers/platform/x86/thinkpad_acpi.c             |    2 +-
 drivers/platform/x86/toshiba_acpi.c              |    2 +-
 drivers/rtc/rtc-dev.c                            |    3 +
 drivers/scsi/BusLogic.c                          |    2 +
 drivers/scsi/aacraid/commctrl.c                  |    1 +
 drivers/scsi/aic94xx/aic94xx_init.c              |    2 +-
 drivers/scsi/dpt_i2o.c                           |    4 +
 drivers/scsi/eata.c                              |    2 +
 drivers/scsi/fcoe/libfcoe.c                      |    2 +
 drivers/scsi/gdth.c                              |    9 +
 drivers/scsi/gdth_proc.c                         |    5 +
 drivers/scsi/ipr.c                               |    2 +-
 drivers/scsi/libsas/sas_ata.c                    |    2 +-
 drivers/scsi/lpfc/lpfc_debugfs.c                 |    2 +
 drivers/scsi/megaraid/megaraid_mbox.c            |    2 +
 drivers/scsi/osd/osd_initiator.c                 |    2 +
 drivers/scsi/scsi_debug.c                        |    4 +
 drivers/scsi/sg.c                                |    2 +-
 drivers/scsi/sym53c8xx_2/sym_glue.c              |    2 +
 drivers/serial/kgdboc.c                          |    4 +-
 drivers/staging/android/binder.c                 |    2 +-
 drivers/staging/b3dfg/b3dfg.c                    |    4 +-
 drivers/staging/comedi/comedi_fops.c             |    2 +-
 drivers/staging/dream/qdsp5/adsp_driver.c        |    2 +-
 drivers/staging/dream/qdsp5/audio_aac.c          |    2 +-
 drivers/staging/dream/qdsp5/audio_amrnb.c        |    2 +-
 drivers/staging/dream/qdsp5/audio_evrc.c         |    2 +-
 drivers/staging/dream/qdsp5/audio_in.c           |    4 +-
 drivers/staging/dream/qdsp5/audio_mp3.c          |    2 +-
 drivers/staging/dream/qdsp5/audio_out.c          |    4 +-
 drivers/staging/dream/qdsp5/audio_qcelp.c        |    2 +-
 drivers/staging/dream/qdsp5/snd.c                |    2 +-
 drivers/staging/dream/smd/smd_qmi.c              |    2 +-
 drivers/staging/dream/smd/smd_rpcrouter_device.c |    4 +-
 drivers/staging/dst/dcore.c                      |    2 +-
 drivers/staging/go7007/go7007-v4l2.c             |    2 +-
 drivers/staging/hv/blkvsc_drv.c                  |    2 +-
 drivers/staging/panel/panel.c                    |    4 +-
 drivers/staging/phison/phison.c                  |    2 +-
 drivers/staging/poch/poch.c                      |    2 +-
 drivers/staging/sep/sep_driver.c                 |    2 +-
 drivers/staging/vme/devices/vme_user.c           |    2 +-
 drivers/telephony/ixj.c                          |    2 +
 drivers/uio/uio.c                                |    4 +-
 drivers/usb/core/hcd.c                           |    4 +-
 drivers/usb/core/hcd.h                           |   10 +-
 drivers/usb/misc/appledisplay.c                  |    2 +-
 drivers/usb/mon/mon_main.c                       |    2 +-
 drivers/uwb/wlp/sysfs.c                          |    3 +-
 drivers/video/atmel_lcdfb.c                      |    2 +-
 drivers/video/aty/aty128fb.c                     |    2 +-
 drivers/video/aty/atyfb_base.c                   |    2 +-
 drivers/video/aty/radeon_backlight.c             |    2 +-
 drivers/video/backlight/adp5520_bl.c             |    2 +-
 drivers/video/backlight/adx_bl.c                 |    2 +-
 drivers/video/backlight/atmel-pwm-bl.c           |    2 +-
 drivers/video/backlight/backlight.c              |    2 +-
 drivers/video/backlight/corgi_lcd.c              |    2 +-
 drivers/video/backlight/cr_bllcd.c               |    2 +-
 drivers/video/backlight/da903x_bl.c              |    2 +-
 drivers/video/backlight/generic_bl.c             |    2 +-
 drivers/video/backlight/hp680_bl.c               |    2 +-
 drivers/video/backlight/jornada720_bl.c          |    2 +-
 drivers/video/backlight/kb3886_bl.c              |    2 +-
 drivers/video/backlight/locomolcd.c              |    2 +-
 drivers/video/backlight/mbp_nvidia_bl.c          |    2 +-
 drivers/video/backlight/omap1_bl.c               |    2 +-
 drivers/video/backlight/progear_bl.c             |    2 +-
 drivers/video/backlight/pwm_bl.c                 |    2 +-
 drivers/video/backlight/tosa_bl.c                |    2 +-
 drivers/video/backlight/wm831x_bl.c              |    2 +-
 drivers/video/bf54x-lq043fb.c                    |    2 +-
 drivers/video/bfin-t350mcqb-fb.c                 |    2 +-
 drivers/video/fbmem.c                            |    4 +
 drivers/video/logo/logo_linux_clut224.ppm        | 2721 ++++++---------
 drivers/video/nvidia/nv_backlight.c              |    2 +-
 drivers/video/riva/fbdev.c                       |    2 +-
 drivers/xen/sys-hypervisor.c                     |    2 +-
 fs/aio.c                                         |    2 +
 fs/attr.c                                        |    1 +
 fs/binfmt_aout.c                                 |   11 +-
 fs/binfmt_elf.c                                  |   31 +-
 fs/btrfs/disk-io.c                               |    4 +-
 fs/btrfs/extent-tree.c                           |    4 +
 fs/btrfs/extent_io.h                             |   30 +-
 fs/btrfs/inode.c                                 |   17 +-
 fs/btrfs/sysfs.c                                 |    4 +-
 fs/buffer.c                                      |    1 +
 fs/cifs/cifs_debug.c                             |    8 +-
 fs/compat.c                                      |   94 +-
 fs/dlm/lockspace.c                               |    2 +-
 fs/exec.c                                        |  104 +-
 fs/ext2/balloc.c                                 |    2 +-
 fs/ext3/balloc.c                                 |    2 +-
 fs/ext4/balloc.c                                 |    2 +-
 fs/ext4/file.c                                   |    4 +-
 fs/ext4/mballoc.c                                |    2 +
 fs/ext4/super.c                                  |    2 +-
 fs/fcntl.c                                       |    6 +
 fs/file.c                                        |    3 +
 fs/filesystems.c                                 |    5 +
 fs/fs_struct.c                                   |    6 +
 fs/gfs2/ops_inode.c                              |    2 +
 fs/gfs2/sys.c                                    |    4 +-
 fs/hfs/btree.c                                   |   21 +-
 fs/hfsplus/catalog.c                             |    6 +
 fs/hfsplus/dir.c                                 |    2 +
 fs/hfsplus/inode.c                               |    4 +
 fs/hfsplus/ioctl.c                               |    4 +
 fs/hfsplus/super.c                               |    2 +
 fs/hugetlbfs/inode.c                             |    2 +-
 fs/jbd/checkpoint.c                              |    2 +
 fs/jffs2/compr_rtime.c                           |    4 +
 fs/jffs2/compr_rubin.c                           |    2 +
 fs/jffs2/xattr.c                                 |    2 +
 fs/lockd/clntproc.c                              |    2 +
 fs/lockd/svc.c                                   |    2 +-
 fs/locks.c                                       |   30 +-
 fs/namei.c                                       |  203 +-
 fs/namespace.c                                   |   25 +
 fs/ncpfs/dir.c                                   |   14 +-
 fs/ncpfs/inode.c                                 |    2 +
 fs/nfsd/lockd.c                                  |    2 +-
 fs/nfsd/nfs4state.c                              |    2 +
 fs/nfsd/nfs4xdr.c                                |    2 +
 fs/notify/dnotify/dnotify.c                      |    2 +-
 fs/ocfs2/cluster/masklog.c                       |    2 +-
 fs/ocfs2/namei.c                                 |    2 +
 fs/open.c                                        |   67 +-
 fs/partitions/ldm.c                              |    3 +-
 fs/partitions/mac.c                              |    2 +-
 fs/pipe.c                                        |    2 +-
 fs/proc/Kconfig                                  |   10 +-
 fs/proc/array.c                                  |   49 +-
 fs/proc/base.c                                   |  194 +-
 fs/proc/cmdline.c                                |    4 +
 fs/proc/devices.c                                |    4 +
 fs/proc/inode.c                                  |   18 +
 fs/proc/internal.h                               |    3 +
 fs/proc/kcore.c                                  |    5 +
 fs/proc/meminfo.c                                |    2 +
 fs/proc/proc_net.c                               |   11 +
 fs/proc/proc_sysctl.c                            |   26 +-
 fs/proc/root.c                                   |    8 +
 fs/proc/task_mmu.c                               |   43 +-
 fs/readdir.c                                     |   19 +
 fs/reiserfs/dir.c                                |    2 +
 fs/reiserfs/item_ops.c                           |   12 +-
 fs/reiserfs/journal.c                            |    2 +
 fs/reiserfs/namei.c                              |    2 +
 fs/reiserfs/procfs.c                             |    2 +
 fs/reiserfs/stree.c                              |   10 +
 fs/reiserfs/super.c                              |    2 +
 fs/select.c                                      |    8 +
 fs/splice.c                                      |    6 +
 fs/sysfs/file.c                                  |    8 +-
 fs/sysfs/mount.c                                 |    4 +
 fs/udf/inode.c                                   |    2 +
 fs/utimes.c                                      |    7 +
 fs/xattr.c                                       |   20 +-
 fs/xfs/linux-2.6/xfs_ioctl.c                     |    2 +-
 fs/xfs/linux-2.6/xfs_ioctl32.c                   |    1 +
 fs/xfs/xfs_vnodeops.c                            |   10 +-
 grsecurity/Kconfig                               | 1036 ++++++
 grsecurity/Makefile                              |   36 +
 grsecurity/gracl.c                               | 4141 ++++++++++++++++++++++
 grsecurity/gracl_alloc.c                         |  105 +
 grsecurity/gracl_cap.c                           |  101 +
 grsecurity/gracl_fs.c                            |  433 +++
 grsecurity/gracl_ip.c                            |  382 ++
 grsecurity/gracl_learn.c                         |  208 ++
 grsecurity/gracl_res.c                           |   67 +
 grsecurity/gracl_segv.c                          |  284 ++
 grsecurity/gracl_shm.c                           |   40 +
 grsecurity/grsec_chdir.c                         |   19 +
 grsecurity/grsec_chroot.c                        |  386 ++
 grsecurity/grsec_disabled.c                      |  439 +++
 grsecurity/grsec_exec.c                          |  204 ++
 grsecurity/grsec_fifo.c                          |   24 +
 grsecurity/grsec_fork.c                          |   23 +
 grsecurity/grsec_init.c                          |  270 ++
 grsecurity/grsec_link.c                          |   43 +
 grsecurity/grsec_log.c                           |  322 ++
 grsecurity/grsec_mem.c                           |   33 +
 grsecurity/grsec_mount.c                         |   62 +
 grsecurity/grsec_pax.c                           |   36 +
 grsecurity/grsec_ptrace.c                        |   14 +
 grsecurity/grsec_sig.c                           |  205 ++
 grsecurity/grsec_sock.c                          |  275 ++
 grsecurity/grsec_sysctl.c                        |  479 +++
 grsecurity/grsec_time.c                          |   16 +
 grsecurity/grsec_tpe.c                           |   39 +
 grsecurity/grsum.c                               |   61 +
 include/acpi/acpi_drivers.h                      |    8 +-
 include/asm-generic/bug.h                        |    4 +-
 include/asm-generic/dma-mapping-common.h         |   24 +-
 include/asm-generic/emergency-restart.h          |    2 +-
 include/drm/drmP.h                               |    4 +-
 include/linux/backlight.h                        |   12 +-
 include/linux/capability.h                       |    1 +
 include/linux/dma-mapping.h                      |   28 +-
 include/linux/fs.h                               |   98 +-
 include/linux/gracl.h                            |  317 ++
 include/linux/gralloc.h                          |    9 +
 include/linux/grdefs.h                           |  140 +
 include/linux/grinternal.h                       |  218 ++
 include/linux/grmsg.h                            |  108 +
 include/linux/grsecurity.h                       |  218 ++
 include/linux/kallsyms.h                         |   12 +-
 include/linux/kgdb.h                             |    6 +-
 include/linux/kmod.h                             |    2 +
 include/linux/kobject.h                          |   14 +-
 include/linux/libata.h                           |   12 +-
 include/linux/lockd/bind.h                       |    6 +-
 include/linux/netfilter/xt_gradm.h               |    9 +
 include/linux/pagemap.h                          |    1 +
 include/linux/proc_fs.h                          |   13 +
 include/linux/ptrace.h                           |    4 +-
 include/linux/reiserfs_fs.h                      |   24 +-
 include/linux/sched.h                            |   61 +-
 include/linux/security.h                         |    1 +
 include/linux/shm.h                              |    4 +
 include/linux/skbuff.h                           |    1 +
 include/linux/suspend.h                          |   46 +-
 include/linux/sysctl.h                           |    3 +
 include/linux/sysfs.h                            |    4 +-
 include/linux/tty.h                              |    1 -
 include/linux/vermagic.h                         |    9 +-
 include/net/netlink.h                            |    2 +-
 include/net/secure_seq.h                         |    8 +-
 include/net/sock.h                               |    2 +-
 include/sound/ac97_codec.h                       |   16 +-
 init/main.c                                      |    3 +
 ipc/mqueue.c                                     |    1 +
 ipc/sem.c                                        |    4 +
 ipc/shm.c                                        |   28 +
 kernel/audit.c                                   |    6 +-
 kernel/capability.c                              |   18 +-
 kernel/cgroup.c                                  |    2 +
 kernel/configs.c                                 |   11 +
 kernel/cred.c                                    |   36 +-
 kernel/exit.c                                    |   54 +-
 kernel/fork.c                                    |   16 +-
 kernel/futex.c                                   |   12 +
 kernel/futex_compat.c                            |   11 +-
 kernel/kallsyms.c                                |    8 +
 kernel/kgdb.c                                    |    6 +-
 kernel/kmod.c                                    |   65 +-
 kernel/module.c                                  |   70 +-
 kernel/panic.c                                   |    4 +-
 kernel/params.c                                  |    4 +-
 kernel/pid.c                                     |   15 +-
 kernel/posix-cpu-timers.c                        |    1 +
 kernel/posix-timers.c                            |   12 +-
 kernel/power/hibernate.c                         |    4 +-
 kernel/power/suspend.c                           |    4 +-
 kernel/printk.c                                  |    5 +
 kernel/ptrace.c                                  |   52 +-
 kernel/relay.c                                   |    2 +
 kernel/resource.c                                |   10 +
 kernel/sched.c                                   |   10 +-
 kernel/signal.c                                  |   39 +-
 kernel/softirq.c                                 |    2 +-
 kernel/sys.c                                     |   49 +-
 kernel/sysctl.c                                  |   88 +-
 kernel/sysctl_check.c                            |    2 +
 kernel/taskstats.c                               |    6 +
 kernel/time.c                                    |    5 +
 kernel/time/timekeeping.c                        |    3 +
 kernel/time/timer_list.c                         |   12 +
 kernel/time/timer_stats.c                        |    8 +
 kernel/trace/trace.c                             |    4 +
 kernel/trace/trace_workqueue.c                   |    2 +-
 kernel/user.c                                    |    1 +
 lib/Kconfig.debug                                |    2 +-
 lib/kobject.c                                    |    6 +-
 lib/kobject_uevent.c                             |    2 +-
 lib/vsprintf.c                                   |   15 +-
 localversion-grsec                               |    1 +
 mm/Kconfig                                       |    6 +-
 mm/backing-dev.c                                 |    2 +-
 mm/filemap.c                                     |    1 +
 mm/kmemleak.c                                    |    2 +-
 mm/mempolicy.c                                   |   11 +-
 mm/migrate.c                                     |   13 +-
 mm/mlock.c                                       |    3 +
 mm/mmap.c                                        |   28 +-
 mm/mprotect.c                                    |    8 +
 mm/page_alloc.c                                  |    2 +
 mm/shmem.c                                       |    4 +-
 mm/slab.c                                        |   10 +-
 mm/slub.c                                        |   20 +-
 mm/vmstat.c                                      |   18 +-
 net/atm/mpoa_caches.c                            |    2 +
 net/atm/proc.c                                   |    9 +
 net/bridge/br_private.h                          |    2 +-
 net/bridge/br_sysfs_if.c                         |    2 +-
 net/bridge/netfilter/ebtables.c                  |    2 +
 net/can/bcm.c                                    |    6 +
 net/core/dev.c                                   |    4 +
 net/core/secure_seq.c                            |    3 +-
 net/core/skbuff.c                                |    2 +
 net/econet/Kconfig                               |    2 +-
 net/ipv4/inet_diag.c                             |   20 +
 net/ipv4/inet_hashtables.c                       |    5 +
 net/ipv4/inetpeer.c                              |    2 +
 net/ipv4/ip_sockglue.c                           |    2 +
 net/ipv4/netfilter/arp_tables.c                  |    1 +
 net/ipv4/netfilter/ip_queue.c                    |    6 +-
 net/ipv4/netfilter/ip_tables.c                   |    1 +
 net/ipv4/raw.c                                   |   14 +-
 net/ipv4/tcp.c                                   |    4 +
 net/ipv4/tcp_ipv4.c                              |   41 +-
 net/ipv4/tcp_minisocks.c                         |    8 +
 net/ipv4/tcp_output.c                            |    2 +
 net/ipv4/tcp_timer.c                             |   11 +
 net/ipv4/udp.c                                   |   31 +-
 net/ipv6/ipv6_sockglue.c                         |    4 +
 net/ipv6/netfilter/ip6_queue.c                   |    6 +-
 net/ipv6/netfilter/ip6_tables.c                  |    1 +
 net/ipv6/raw.c                                   |   12 +-
 net/ipv6/tcp_ipv6.c                              |   46 +-
 net/ipv6/udp.c                                   |   14 +-
 net/key/af_key.c                                 |    6 +
 net/mac80211/cfg.c                               |    2 +-
 net/mac80211/cfg.h                               |    2 +-
 net/mac80211/debugfs_key.c                       |    6 +-
 net/mac80211/debugfs_sta.c                       |    2 +
 net/mac80211/mlme.c                              |    2 +
 net/netfilter/Kconfig                            |   10 +
 net/netfilter/Makefile                           |    1 +
 net/netfilter/ipvs/ip_vs_ctl.c                   |    2 +
 net/netfilter/xt_gradm.c                         |   51 +
 net/netlink/af_netlink.c                         |    8 +
 net/netrom/af_netrom.c                           |    2 +-
 net/packet/af_packet.c                           |    4 +
 net/phonet/af_phonet.c                           |    4 +-
 net/phonet/socket.c                              |    7 +-
 net/rds/Kconfig                                  |    2 +-
 net/rds/iw_rdma.c                                |    2 +
 net/rxrpc/ar-ack.c                               |    2 +
 net/rxrpc/ar-key.c                               |    8 +-
 net/rxrpc/rxkad.c                                |    4 +
 net/sctp/proc.c                                  |   14 +-
 net/socket.c                                     |   77 +-
 net/sysctl_net.c                                 |    2 +-
 net/unix/af_unix.c                               |   24 +
 net/xfrm/xfrm_user.c                             |    4 +
 samples/kobject/kset-example.c                   |    2 +-
 security/Kconfig                                 |  101 +-
 security/commoncap.c                             |   14 +-
 security/min_addr.c                              |    2 +
 security/security.c                              |    4 +-
 security/selinux/ss/services.c                   |    2 +
 sound/pci/ac97/ac97_codec.c                      |    2 +-
 sound/pci/ac97/ac97_patch.c                      |   64 +-
 tools/gcc/Makefile                               |    2 +-
 743 files changed, 15840 insertions(+), 2861 deletions(-)

commit 6536f7d9837920f0cba1a3071e707c8d9cec03c2
Author: Brad Spengler <spender@grsecurity.net>
Date:   Sat Dec 3 20:21:33 2011 -0500

    Import of pax-linux-2.6.32.48-test130.patch

 arch/x86/include/asm/uaccess_64.h |    1 +
 1 files changed, 1 insertions(+), 0 deletions(-)

commit aec65dc958432a54264c94bbfd947e234aa14869
Author: Brad Spengler <spender@grsecurity.net>
Date:   Sat Dec 10 19:49:18 2011 -0500

    Import changes from pax-linux-2.6.32.50-test133.patch

 arch/x86/include/asm/pgtable_64.h |    3 ++-
 arch/x86/xen/mmu.c                |    6 ++++--
 mm/vmalloc.c                      |    3 ++-
 3 files changed, 8 insertions(+), 4 deletions(-)

commit 290e037ede8cb6ed9214469aea9f72f781fc6fea
Author: Brad Spengler <spender@grsecurity.net>
Date:   Sat Dec 10 17:57:43 2011 -0500

    Fix PaX build error on x64

 arch/x86/lib/rwlock_64.S |    1 +
 1 files changed, 1 insertions(+), 0 deletions(-)

commit f470e9ac2d237bab10bdcb057bb35d5e2bbc1fb8
Author: Brad Spengler <spender@grsecurity.net>
Date:   Sat Dec 10 16:30:30 2011 -0500

    Import changes from pax-linux-2.6.32.48-test132.patch

 arch/x86/include/asm/uaccess_64.h |   45 ++++++++++++++++++-------------------
 arch/x86/kernel/entry_64.S        |    7 ++---
 arch/x86/kernel/head_64.S         |   13 +++++++++-
 arch/x86/lib/rwlock_64.S          |   40 ++++++++++++++++++++++++++++++++
 arch/x86/lib/usercopy_64.c        |    4 +-
 fs/partitions/efi.c               |    8 +++---
 include/asm-generic/atomic64.h    |   12 ++++++++++
 tools/gcc/constify_plugin.c       |    6 ++--
 tools/gcc/stackleak_plugin.c      |    6 ++--
 9 files changed, 100 insertions(+), 41 deletions(-)

commit 165d4688063c2793d2730e15d4c02450e6c55325
Author: Brad Spengler <spender@grsecurity.net>
Date:   Sun Dec 4 17:05:21 2011 -0500

    Import changes from pax-linux-2.6.32.48-test131.patch

 arch/x86/include/asm/alternative-asm.h |    2 +-
 arch/x86/kernel/entry_64.S             |   43 ++++++++++++++++++++------------
 2 files changed, 28 insertions(+), 17 deletions(-)

commit 99b49cb6a851b4b85fb0fb78d6e3573f86d35112
Author: Brad Spengler <spender@grsecurity.net>
Date:   Sat Dec 3 20:25:39 2011 -0500

    Port pax-linux-2.6.32.48-test130.patch to 2.6.32.49 kernel

 include/linux/vmalloc.h |    5 +++++
 mm/vmalloc.c            |    7 +++++++
 2 files changed, 12 insertions(+), 0 deletions(-)

commit 02e2d04453c2ef47294dad8cd4f79f38566389a2
Author: Brad Spengler <spender@grsecurity.net>
Date:   Sat Dec 3 20:21:33 2011 -0500

    Import of pax-linux-2.6.32.48-test130.patch

 Documentation/dontdiff                             |   36 ++-
 Documentation/kernel-parameters.txt                |    7 +
 Makefile                                           |   76 ++-
 arch/alpha/include/asm/elf.h                       |    7 +
 arch/alpha/include/asm/pgtable.h                   |   11 +
 arch/alpha/kernel/module.c                         |    2 +-
 arch/alpha/kernel/osf_sys.c                        |   10 +-
 arch/alpha/mm/fault.c                              |  141 +++++-
 arch/arm/include/asm/elf.h                         |    9 +-
 arch/arm/include/asm/kmap_types.h                  |    1 +
 arch/arm/include/asm/uaccess.h                     |   27 +-
 arch/arm/kernel/armksyms.c                         |    4 +-
 arch/arm/lib/copy_from_user.S                      |    6 +-
 arch/arm/lib/copy_to_user.S                        |    6 +-
 arch/arm/lib/uaccess.S                             |   12 +-
 arch/arm/lib/uaccess_with_memcpy.c                 |    2 +-
 arch/arm/mm/fault.c                                |   34 ++
 arch/arm/mm/mmap.c                                 |   19 +-
 arch/avr32/include/asm/elf.h                       |    8 +-
 arch/avr32/include/asm/kmap_types.h                |    3 +-
 arch/avr32/mm/fault.c                              |   27 +
 arch/frv/include/asm/kmap_types.h                  |    1 +
 arch/frv/mm/elf-fdpic.c                            |    7 +-
 arch/ia64/ia32/binfmt_elf32.c                      |    7 +
 arch/ia64/ia32/ia32priv.h                          |    9 +-
 arch/ia64/include/asm/elf.h                        |    7 +
 arch/ia64/include/asm/pgtable.h                    |   13 +-
 arch/ia64/include/asm/spinlock.h                   |    2 +-
 arch/ia64/include/asm/uaccess.h                    |    4 +-
 arch/ia64/kernel/module.c                          |   48 ++-
 arch/ia64/kernel/pci-dma.c                         |   10 +-
 arch/ia64/kernel/sys_ia64.c                        |   13 +-
 arch/ia64/kernel/vmlinux.lds.S                     |    2 +-
 arch/ia64/mm/fault.c                               |   33 +-
 arch/ia64/mm/hugetlbpage.c                         |    2 +-
 arch/ia64/mm/init.c                                |   13 +
 arch/m32r/lib/usercopy.c                           |    6 +
 arch/mips/include/asm/elf.h                        |    7 +
 arch/mips/include/asm/page.h                       |    2 +-
 arch/mips/include/asm/system.h                     |    2 +-
 arch/mips/kernel/binfmt_elfn32.c                   |    7 +
 arch/mips/kernel/binfmt_elfo32.c                   |    7 +
 arch/mips/kernel/process.c                         |   12 -
 arch/mips/kernel/syscall.c                         |   12 +-
 arch/mips/mm/fault.c                               |   17 +
 arch/parisc/include/asm/elf.h                      |    7 +
 arch/parisc/include/asm/pgtable.h                  |   11 +
 arch/parisc/kernel/module.c                        |   50 ++-
 arch/parisc/kernel/sys_parisc.c                    |    6 +-
 arch/parisc/kernel/traps.c                         |    4 +-
 arch/parisc/mm/fault.c                             |  140 +++++-
 arch/powerpc/include/asm/elf.h                     |   18 +-
 arch/powerpc/include/asm/kmap_types.h              |    1 +
 arch/powerpc/include/asm/page.h                    |    8 +-
 arch/powerpc/include/asm/page_64.h                 |    7 +-
 arch/powerpc/include/asm/pgtable.h                 |    1 +
 arch/powerpc/include/asm/pte-hash32.h              |    1 +
 arch/powerpc/include/asm/reg.h                     |    1 +
 arch/powerpc/include/asm/system.h                  |    2 +-
 arch/powerpc/include/asm/uaccess.h                 |  142 +++--
 arch/powerpc/kernel/exceptions-64e.S               |    4 +-
 arch/powerpc/kernel/exceptions-64s.S               |    2 +-
 arch/powerpc/kernel/kgdb.c                         |    2 +-
 arch/powerpc/kernel/module.c                       |   20 +
 arch/powerpc/kernel/module_32.c                    |   13 +-
 arch/powerpc/kernel/process.c                      |   55 --
 arch/powerpc/kernel/signal_32.c                    |    2 +-
 arch/powerpc/kernel/signal_64.c                    |    2 +-
 arch/powerpc/kernel/sys_ppc32.c                    |    4 +-
 arch/powerpc/kernel/vdso.c                         |    5 +-
 arch/powerpc/kernel/vio.c                          |    3 +-
 arch/powerpc/lib/usercopy_64.c                     |   18 -
 arch/powerpc/mm/fault.c                            |   55 ++-
 arch/powerpc/mm/mmap_64.c                          |   12 +
 arch/powerpc/mm/slice.c                            |   23 +-
 arch/powerpc/platforms/pseries/Kconfig             |    2 +
 arch/s390/Kconfig                                  |   18 +-
 arch/s390/include/asm/elf.h                        |    7 +
 arch/s390/include/asm/setup.h                      |    4 +-
 arch/s390/include/asm/uaccess.h                    |   11 +
 arch/s390/kernel/module.c                          |   22 +-
 arch/s390/kernel/setup.c                           |   32 -
 arch/s390/mm/mmap.c                                |   24 +
 arch/score/include/asm/system.h                    |    2 +-
 arch/score/kernel/process.c                        |    5 -
 arch/sh/mm/mmap.c                                  |   24 +-
 arch/sparc/include/asm/atomic_64.h                 |  108 ++++-
 arch/sparc/include/asm/cache.h                     |    2 +-
 arch/sparc/include/asm/elf_32.h                    |    7 +
 arch/sparc/include/asm/elf_64.h                    |    6 +
 arch/sparc/include/asm/pgtable_32.h                |   17 +
 arch/sparc/include/asm/pgtsrmmu.h                  |    7 +
 arch/sparc/include/asm/spinlock_64.h               |   31 +-
 arch/sparc/include/asm/thread_info_32.h            |    2 +
 arch/sparc/include/asm/thread_info_64.h            |    2 +
 arch/sparc/include/asm/uaccess.h                   |    8 +
 arch/sparc/include/asm/uaccess_32.h                |   27 +-
 arch/sparc/include/asm/uaccess_64.h                |   19 +-
 arch/sparc/kernel/Makefile                         |    2 +-
 arch/sparc/kernel/sys_sparc_32.c                   |    4 +-
 arch/sparc/kernel/sys_sparc_64.c                   |   52 +-
 arch/sparc/kernel/traps_64.c                       |   13 +-
 arch/sparc/kernel/una_asm_64.S                     |    2 +-
 arch/sparc/lib/Makefile                            |    2 +-
 arch/sparc/lib/atomic_64.S                         |  148 +++++-
 arch/sparc/lib/ksyms.c                             |    6 +
 arch/sparc/lib/rwsem_64.S                          |   49 ++-
 arch/sparc/mm/Makefile                             |    2 +-
 arch/sparc/mm/fault_32.c                           |  282 +++++++++
 arch/sparc/mm/fault_64.c                           |  476 +++++++++++++++
 arch/sparc/mm/hugetlbpage.c                        |   16 +-
 arch/sparc/mm/init_32.c                            |   15 +-
 arch/sparc/mm/srmmu.c                              |    7 +
 arch/um/Makefile                                   |    4 +
 arch/um/include/asm/kmap_types.h                   |    1 +
 arch/um/include/asm/page.h                         |    3 +
 arch/um/kernel/process.c                           |   16 -
 arch/um/sys-i386/shared/sysdep/system.h            |    2 +-
 arch/um/sys-i386/syscalls.c                        |   15 +
 arch/um/sys-x86_64/shared/sysdep/system.h          |    2 +-
 arch/x86/Kconfig                                   |    9 +-
 arch/x86/Kconfig.cpu                               |    6 +-
 arch/x86/Kconfig.debug                             |    2 +-
 arch/x86/Makefile                                  |   10 +
 arch/x86/boot/Makefile                             |    3 +
 arch/x86/boot/bitops.h                             |    4 +-
 arch/x86/boot/boot.h                               |    4 +-
 arch/x86/boot/compressed/Makefile                  |    3 +
 arch/x86/boot/compressed/head_32.S                 |    7 +-
 arch/x86/boot/compressed/head_64.S                 |    4 +-
 arch/x86/boot/compressed/misc.c                    |    4 +-
 arch/x86/boot/compressed/mkpiggy.c                 |    2 +-
 arch/x86/boot/compressed/relocs.c                  |   86 +++-
 arch/x86/boot/cpucheck.c                           |   28 +-
 arch/x86/boot/header.S                             |    2 +-
 arch/x86/boot/memory.c                             |    2 +-
 arch/x86/boot/video-vesa.c                         |    1 +
 arch/x86/boot/video.c                              |    2 +-
 arch/x86/crypto/aes-x86_64-asm_64.S                |    4 +
 arch/x86/crypto/aesni-intel_asm.S                  |   23 +
 arch/x86/crypto/salsa20-x86_64-asm_64.S            |    5 +
 arch/x86/crypto/twofish-x86_64-asm_64.S            |    3 +
 arch/x86/ia32/ia32_signal.c                        |   20 +-
 arch/x86/ia32/ia32entry.S                          |  130 +++--
 arch/x86/ia32/sys_ia32.c                           |   16 +-
 arch/x86/include/asm/alternative-asm.h             |   39 ++
 arch/x86/include/asm/alternative.h                 |    2 +-
 arch/x86/include/asm/apic.h                        |    2 +-
 arch/x86/include/asm/apm.h                         |    4 +-
 arch/x86/include/asm/atomic_32.h                   |  337 +++++++++++-
 arch/x86/include/asm/atomic_64.h                   |  446 ++++++++++++++-
 arch/x86/include/asm/bitops.h                      |    2 +-
 arch/x86/include/asm/boot.h                        |    7 +-
 arch/x86/include/asm/cache.h                       |    3 +-
 arch/x86/include/asm/cacheflush.h                  |    4 +-
 arch/x86/include/asm/calling.h                     |   42 +-
 arch/x86/include/asm/checksum_32.h                 |   12 +-
 arch/x86/include/asm/desc.h                        |   62 ++-
 arch/x86/include/asm/desc_defs.h                   |    6 +
 arch/x86/include/asm/device.h                      |    2 +-
 arch/x86/include/asm/e820.h                        |    2 +-
 arch/x86/include/asm/elf.h                         |   27 +-
 arch/x86/include/asm/emergency-restart.h           |    2 +-
 arch/x86/include/asm/futex.h                       |   20 +-
 arch/x86/include/asm/hw_irq.h                      |    4 +-
 arch/x86/include/asm/i387.h                        |   21 +-
 arch/x86/include/asm/io_32.h                       |   12 +
 arch/x86/include/asm/io_64.h                       |   11 +
 arch/x86/include/asm/irqflags.h                    |    5 +
 arch/x86/include/asm/kprobes.h                     |    9 +-
 arch/x86/include/asm/kvm_host.h                    |    2 +-
 arch/x86/include/asm/local.h                       |   94 +++-
 arch/x86/include/asm/mman.h                        |   10 +
 arch/x86/include/asm/mmu.h                         |   17 +-
 arch/x86/include/asm/mmu_context.h                 |   76 +++-
 arch/x86/include/asm/module.h                      |   28 +-
 arch/x86/include/asm/page_64_types.h               |    2 +-
 arch/x86/include/asm/paravirt.h                    |   44 ++-
 arch/x86/include/asm/paravirt_types.h              |   19 +-
 arch/x86/include/asm/percpu.h                      |    1 +
 arch/x86/include/asm/pgalloc.h                     |    7 +
 arch/x86/include/asm/pgtable-2level.h              |    2 +
 arch/x86/include/asm/pgtable-3level.h              |    4 +
 arch/x86/include/asm/pgtable.h                     |  110 ++++-
 arch/x86/include/asm/pgtable_32.h                  |   14 +-
 arch/x86/include/asm/pgtable_32_types.h            |   15 +-
 arch/x86/include/asm/pgtable_64.h                  |   16 +-
 arch/x86/include/asm/pgtable_64_types.h            |    5 +
 arch/x86/include/asm/pgtable_types.h               |   44 +-
 arch/x86/include/asm/processor.h                   |   35 +-
 arch/x86/include/asm/ptrace.h                      |   13 +-
 arch/x86/include/asm/reboot.h                      |   12 +-
 arch/x86/include/asm/rwsem.h                       |   68 +++-
 arch/x86/include/asm/segment.h                     |   24 +-
 arch/x86/include/asm/smp.h                         |   14 +-
 arch/x86/include/asm/spinlock.h                    |   37 ++-
 arch/x86/include/asm/stackprotector.h              |    4 +-
 arch/x86/include/asm/system.h                      |   10 +-
 arch/x86/include/asm/thread_info.h                 |   81 ++--
 arch/x86/include/asm/uaccess.h                     |   94 +++-
 arch/x86/include/asm/uaccess_32.h                  |   79 +++-
 arch/x86/include/asm/uaccess_64.h                  |  241 ++++++--
 arch/x86/include/asm/vdso.h                        |    2 +-
 arch/x86/include/asm/vgtod.h                       |    1 +
 arch/x86/include/asm/vmi.h                         |    1 +
 arch/x86/include/asm/vmi_time.h                    |    2 +-
 arch/x86/include/asm/vsyscall.h                    |    7 +-
 arch/x86/include/asm/x86_init.h                    |   18 +-
 arch/x86/include/asm/xsave.h                       |   13 +-
 arch/x86/kernel/acpi/realmode/Makefile             |    3 +
 arch/x86/kernel/acpi/realmode/wakeup.S             |    2 +-
 arch/x86/kernel/acpi/sleep.c                       |   17 +-
 arch/x86/kernel/acpi/wakeup_32.S                   |    6 +-
 arch/x86/kernel/alternative.c                      |   42 +-
 arch/x86/kernel/apic/apic.c                        |    4 +-
 arch/x86/kernel/apic/io_apic.c                     |   12 +-
 arch/x86/kernel/apm_32.c                           |   21 +-
 arch/x86/kernel/asm-offsets_32.c                   |    9 +-
 arch/x86/kernel/asm-offsets_64.c                   |   16 +
 arch/x86/kernel/cpu/Makefile                       |    4 -
 arch/x86/kernel/cpu/amd.c                          |    2 +-
 arch/x86/kernel/cpu/common.c                       |   74 +--
 arch/x86/kernel/cpu/intel.c                        |    2 +-
 arch/x86/kernel/cpu/mcheck/mce-inject.c            |    4 +-
 arch/x86/kernel/cpu/mcheck/mce.c                   |   27 +-
 arch/x86/kernel/cpu/mcheck/p5.c                    |    2 +
 arch/x86/kernel/cpu/mcheck/winchip.c               |    2 +
 arch/x86/kernel/cpu/mtrr/mtrr.h                    |    2 +-
 arch/x86/kernel/cpu/perf_event.c                   |   10 +-
 arch/x86/kernel/crash.c                            |    2 +-
 arch/x86/kernel/doublefault_32.c                   |    8 +-
 arch/x86/kernel/dumpstack.c                        |   21 +-
 arch/x86/kernel/dumpstack.h                        |    2 +-
 arch/x86/kernel/dumpstack_32.c                     |   34 +-
 arch/x86/kernel/dumpstack_64.c                     |   58 ++-
 arch/x86/kernel/e820.c                             |    2 +-
 arch/x86/kernel/early_printk.c                     |    1 +
 arch/x86/kernel/efi_32.c                           |   66 +--
 arch/x86/kernel/efi_stub_32.S                      |   48 +-
 arch/x86/kernel/efi_stub_64.S                      |    8 +
 arch/x86/kernel/entry_32.S                         |  364 ++++++++++--
 arch/x86/kernel/entry_64.S                         |  498 +++++++++++++++--
 arch/x86/kernel/ftrace.c                           |   22 +-
 arch/x86/kernel/head32.c                           |    3 +-
 arch/x86/kernel/head_32.S                          |  254 +++++++--
 arch/x86/kernel/head_64.S                          |  147 ++++--
 arch/x86/kernel/i386_ksyms_32.c                    |    8 +
 arch/x86/kernel/i8259.c                            |    2 +-
 arch/x86/kernel/init_task.c                        |    7 +-
 arch/x86/kernel/ioport.c                           |    2 +-
 arch/x86/kernel/irq.c                              |   10 +-
 arch/x86/kernel/irq_32.c                           |   70 +--
 arch/x86/kernel/kgdb.c                             |    6 +-
 arch/x86/kernel/kprobes.c                          |   31 +-
 arch/x86/kernel/kvm.c                              |    1 +
 arch/x86/kernel/ldt.c                              |   31 +-
 arch/x86/kernel/machine_kexec_32.c                 |    6 +-
 arch/x86/kernel/microcode_intel.c                  |    4 +-
 arch/x86/kernel/module.c                           |   75 +++-
 arch/x86/kernel/paravirt-spinlocks.c               |    2 +-
 arch/x86/kernel/paravirt.c                         |   43 +-
 arch/x86/kernel/process.c                          |   73 ++-
 arch/x86/kernel/process_32.c                       |   27 +-
 arch/x86/kernel/process_64.c                       |   20 +-
 arch/x86/kernel/ptrace.c                           |   20 +-
 arch/x86/kernel/reboot.c                           |   37 +-
 arch/x86/kernel/relocate_kernel_64.S               |    2 +
 arch/x86/kernel/setup.c                            |   10 +-
 arch/x86/kernel/setup_percpu.c                     |   27 +-
 arch/x86/kernel/signal.c                           |   21 +-
 arch/x86/kernel/smpboot.c                          |   23 +-
 arch/x86/kernel/step.c                             |   12 +-
 arch/x86/kernel/sys_i386_32.c                      |  239 +++++++-
 arch/x86/kernel/sys_x86_64.c                       |   52 ++-
 arch/x86/kernel/syscall_table_32.S                 |    1 +
 arch/x86/kernel/tboot.c                            |   12 +-
 arch/x86/kernel/time.c                             |   14 +-
 arch/x86/kernel/tls.c                              |    5 +
 arch/x86/kernel/trampoline_32.S                    |    8 +-
 arch/x86/kernel/trampoline_64.S                    |    4 +-
 arch/x86/kernel/traps.c                            |   77 ++-
 arch/x86/kernel/vm86_32.c                          |    6 +-
 arch/x86/kernel/vmi_32.c                           |   63 ++-
 arch/x86/kernel/vmlinux.lds.S                      |  163 ++++--
 arch/x86/kernel/vsyscall_64.c                      |    3 +-
 arch/x86/kernel/x8664_ksyms_64.c                   |    2 -
 arch/x86/kernel/xsave.c                            |    6 +-
 arch/x86/kvm/emulate.c                             |    8 +-
 arch/x86/kvm/lapic.c                               |    2 +-
 arch/x86/kvm/paging_tmpl.h                         |    1 +
 arch/x86/kvm/svm.c                                 |    4 +
 arch/x86/kvm/vmx.c                                 |   37 +-
 arch/x86/kvm/x86.c                                 |   25 +-
 arch/x86/lguest/boot.c                             |    3 +-
 arch/x86/lib/atomic64_32.c                         |  148 +++++-
 arch/x86/lib/checksum_32.S                         |  116 +++-
 arch/x86/lib/clear_page_64.S                       |    5 +-
 arch/x86/lib/copy_page_64.S                        |   13 +-
 arch/x86/lib/copy_user_64.S                        |   49 +--
 arch/x86/lib/copy_user_nocache_64.S                |   20 +-
 arch/x86/lib/csum-copy_64.S                        |    2 +
 arch/x86/lib/csum-wrappers_64.c                    |   16 +-
 arch/x86/lib/getuser.S                             |   68 +++-
 arch/x86/lib/iomap_copy_64.S                       |    2 +
 arch/x86/lib/memcpy_64.S                           |    5 +-
 arch/x86/lib/memset_64.S                           |    9 +-
 arch/x86/lib/mmx_32.c                              |  243 ++++++---
 arch/x86/lib/msr-reg.S                             |   18 +-
 arch/x86/lib/putuser.S                             |   87 +++-
 arch/x86/lib/rwlock_64.S                           |    2 +
 arch/x86/lib/rwsem_64.S                            |    6 +-
 arch/x86/lib/thunk_64.S                            |    5 +-
 arch/x86/lib/usercopy_32.c                         |  367 ++++++++-----
 arch/x86/lib/usercopy_64.c                         |   30 +-
 arch/x86/mm/extable.c                              |   59 ++-
 arch/x86/mm/fault.c                                |  526 ++++++++++++++++-
 arch/x86/mm/gup.c                                  |    2 +-
 arch/x86/mm/highmem_32.c                           |    3 +
 arch/x86/mm/hugetlbpage.c                          |  111 ++--
 arch/x86/mm/init.c                                 |   96 +++-
 arch/x86/mm/init_32.c                              |  128 +++--
 arch/x86/mm/init_64.c                              |   20 +-
 arch/x86/mm/iomap_32.c                             |    4 +
 arch/x86/mm/ioremap.c                              |   16 +-
 arch/x86/mm/kmemcheck/kmemcheck.c                  |    4 +-
 arch/x86/mm/mmap.c                                 |   41 ++-
 arch/x86/mm/mmio-mod.c                             |    6 +-
 arch/x86/mm/numa_32.c                              |    1 -
 arch/x86/mm/pageattr-test.c                        |    2 +-
 arch/x86/mm/pageattr.c                             |   33 +-
 arch/x86/mm/pat.c                                  |   12 +-
 arch/x86/mm/pf_in.c                                |   10 +-
 arch/x86/mm/pgtable.c                              |  127 +++--
 arch/x86/mm/pgtable_32.c                           |    3 +
 arch/x86/mm/setup_nx.c                             |   31 +-
 arch/x86/mm/tlb.c                                  |    4 +
 arch/x86/oprofile/backtrace.c                      |    4 +-
 arch/x86/oprofile/op_model_p4.c                    |    2 +-
 arch/x86/pci/pcbios.c                              |  146 ++++--
 arch/x86/power/cpu.c                               |    4 +-
 arch/x86/vdso/Makefile                             |    2 +-
 arch/x86/vdso/vclock_gettime.c                     |   54 ++-
 arch/x86/vdso/vdso.lds.S                           |    6 +
 arch/x86/vdso/vdso32-setup.c                       |   23 +-
 arch/x86/vdso/vextern.h                            |    1 -
 arch/x86/vdso/vma.c                                |   40 +-
 arch/x86/xen/enlighten.c                           |   34 +-
 arch/x86/xen/mmu.c                                 |    7 +
 arch/x86/xen/smp.c                                 |   16 +-
 arch/x86/xen/xen-asm_32.S                          |   12 +-
 arch/x86/xen/xen-head.S                            |   11 +
 arch/x86/xen/xen-ops.h                             |    2 -
 block/blk-iopoll.c                                 |    2 +-
 block/blk-map.c                                    |    9 +-
 block/blk-softirq.c                                |    2 +-
 block/bsg.c                                        |   20 +-
 block/compat_ioctl.c                               |    2 +-
 block/scsi_ioctl.c                                 |   27 +-
 crypto/cryptd.c                                    |    2 +-
 crypto/gf128mul.c                                  |    4 +-
 drivers/acpi/acpi_pad.c                            |    2 +-
 drivers/acpi/osl.c                                 |    4 +
 drivers/acpi/power_meter.c                         |    2 -
 drivers/acpi/proc.c                                |   17 +-
 drivers/acpi/processor_core.c                      |    2 +-
 drivers/acpi/sbshc.c                               |    2 +-
 drivers/ata/libata-core.c                          |    8 +-
 drivers/atm/adummy.c                               |    2 +-
 drivers/atm/ambassador.c                           |    8 +-
 drivers/atm/atmtcp.c                               |   14 +-
 drivers/atm/eni.c                                  |   12 +-
 drivers/atm/firestream.c                           |    8 +-
 drivers/atm/fore200e.c                             |   14 +-
 drivers/atm/he.c                                   |   18 +-
 drivers/atm/horizon.c                              |    4 +-
 drivers/atm/idt77252.c                             |   36 +-
 drivers/atm/iphase.c                               |   34 +-
 drivers/atm/lanai.c                                |   12 +-
 drivers/atm/nicstar.c                              |   46 +-
 drivers/atm/solos-pci.c                            |    4 +-
 drivers/atm/suni.c                                 |    4 +-
 drivers/atm/uPD98402.c                             |   16 +-
 drivers/atm/zatm.c                                 |    6 +-
 drivers/block/cciss.c                              |   24 +-
 drivers/block/cciss.h                              |    2 +-
 drivers/block/cpqarray.c                           |   28 +-
 drivers/block/cpqarray.h                           |    2 +-
 drivers/block/loop.c                               |    2 +-
 drivers/char/agp/frontend.c                        |    2 +-
 drivers/char/hpet.c                                |    4 +-
 drivers/char/hvcs.c                                |   23 +-
 drivers/char/ipmi/ipmi_msghandler.c                |    8 +-
 drivers/char/ipmi/ipmi_si_intf.c                   |    8 +-
 drivers/char/keyboard.c                            |    2 +-
 drivers/char/mbcs.c                                |    2 +-
 drivers/char/mem.c                                 |   46 ++-
 drivers/char/pcmcia/ipwireless/tty.c               |   29 +-
 drivers/char/pty.c                                 |    4 +-
 drivers/char/random.c                              |    2 +-
 drivers/char/sonypi.c                              |    9 +-
 drivers/char/tpm/tpm.c                             |    2 +-
 drivers/char/tpm/tpm_bios.c                        |   14 +-
 drivers/char/tty_io.c                              |    8 +-
 drivers/char/tty_ldisc.c                           |   10 +-
 drivers/char/virtio_console.c                      |   16 +-
 drivers/char/vt.c                                  |    2 +-
 drivers/cpuidle/sysfs.c                            |    2 +-
 drivers/dma/ioat/dma_v3.c                          |    8 +-
 drivers/edac/amd64_edac.c                          |    2 +-
 drivers/edac/amd76x_edac.c                         |    2 +-
 drivers/edac/e752x_edac.c                          |    2 +-
 drivers/edac/e7xxx_edac.c                          |    2 +-
 drivers/edac/edac_pci_sysfs.c                      |   20 +-
 drivers/edac/i3000_edac.c                          |    2 +-
 drivers/edac/i3200_edac.c                          |    2 +-
 drivers/edac/i5000_edac.c                          |    2 +-
 drivers/edac/i5100_edac.c                          |    2 +-
 drivers/edac/i5400_edac.c                          |    2 +-
 drivers/edac/i82443bxgx_edac.c                     |    2 +-
 drivers/edac/i82860_edac.c                         |    2 +-
 drivers/edac/i82875p_edac.c                        |    2 +-
 drivers/edac/i82975x_edac.c                        |    2 +-
 drivers/edac/r82600_edac.c                         |    2 +-
 drivers/edac/x38_edac.c                            |    2 +-
 drivers/firewire/core-card.c                       |    2 +-
 drivers/firewire/core-cdev.c                       |    3 +-
 drivers/firewire/core-transaction.c                |    1 +
 drivers/firewire/core.h                            |    1 +
 drivers/firmware/dmi_scan.c                        |    7 +-
 drivers/gpio/vr41xx_giu.c                          |    2 +-
 drivers/gpu/drm/drm_crtc.c                         |   18 +-
 drivers/gpu/drm/drm_crtc_helper.c                  |    2 +-
 drivers/gpu/drm/drm_drv.c                          |    2 +-
 drivers/gpu/drm/drm_fops.c                         |   14 +-
 drivers/gpu/drm/drm_gem.c                          |   10 +-
 drivers/gpu/drm/drm_info.c                         |   20 +-
 drivers/gpu/drm/drm_ioc32.c                        |    4 +-
 drivers/gpu/drm/drm_ioctl.c                        |    2 +-
 drivers/gpu/drm/drm_lock.c                         |    4 +-
 drivers/gpu/drm/i810/i810_dma.c                    |    8 +-
 drivers/gpu/drm/i810/i810_drv.h                    |    4 +-
 drivers/gpu/drm/i830/i830_drv.h                    |    4 +-
 drivers/gpu/drm/i830/i830_irq.c                    |   14 +-
 drivers/gpu/drm/i915/i915_debugfs.c                |    2 +-
 drivers/gpu/drm/i915/i915_drv.h                    |    4 +-
 drivers/gpu/drm/i915/i915_gem.c                    |   26 +-
 drivers/gpu/drm/i915/i915_irq.c                    |    4 +-
 drivers/gpu/drm/i915/intel_sdvo.c                  |    4 +-
 drivers/gpu/drm/mga/mga_drv.h                      |    4 +-
 drivers/gpu/drm/mga/mga_irq.c                      |    8 +-
 drivers/gpu/drm/r128/r128_cce.c                    |    2 +-
 drivers/gpu/drm/r128/r128_drv.h                    |    4 +-
 drivers/gpu/drm/r128/r128_irq.c                    |    4 +-
 drivers/gpu/drm/r128/r128_state.c                  |    4 +-
 drivers/gpu/drm/radeon/mkregtable.c                |    4 +-
 drivers/gpu/drm/radeon/radeon.h                    |    4 +-
 drivers/gpu/drm/radeon/radeon_atombios.c           |    5 +-
 drivers/gpu/drm/radeon/radeon_display.c            |    2 +-
 drivers/gpu/drm/radeon/radeon_drv.h                |    2 +-
 drivers/gpu/drm/radeon/radeon_fence.c              |    4 +-
 drivers/gpu/drm/radeon/radeon_ioc32.c              |    2 +-
 drivers/gpu/drm/radeon/radeon_irq.c                |    6 +-
 drivers/gpu/drm/radeon/radeon_state.c              |    2 +-
 drivers/gpu/drm/radeon/radeon_ttm.c                |   32 +-
 drivers/gpu/drm/radeon/rs690.c                     |    4 +-
 drivers/gpu/drm/ttm/ttm_bo_vm.c                    |    6 +-
 drivers/gpu/drm/ttm/ttm_global.c                   |   14 +-
 drivers/gpu/drm/via/via_drv.h                      |    4 +-
 drivers/gpu/drm/via/via_irq.c                      |   18 +-
 drivers/hid/hid-core.c                             |    4 +-
 drivers/hid/usbhid/hiddev.c                        |    2 +-
 drivers/hwmon/lis3lv02d.c                          |    8 +-
 drivers/hwmon/lis3lv02d.h                          |    2 +-
 drivers/hwmon/sht15.c                              |   12 +-
 drivers/hwmon/w83791d.c                            |    4 +-
 drivers/i2c/busses/i2c-amd756-s4882.c              |    2 +-
 drivers/i2c/busses/i2c-nforce2-s4985.c             |    2 +-
 drivers/ide/aec62xx.c                              |    2 +-
 drivers/ide/alim15x3.c                             |    2 +-
 drivers/ide/amd74xx.c                              |    2 +-
 drivers/ide/atiixp.c                               |    2 +-
 drivers/ide/cmd64x.c                               |    2 +-
 drivers/ide/cs5520.c                               |    2 +-
 drivers/ide/cs5530.c                               |    2 +-
 drivers/ide/cs5535.c                               |    2 +-
 drivers/ide/cy82c693.c                             |    2 +-
 drivers/ide/hpt366.c                               |   24 +-
 drivers/ide/ide-cd.c                               |    2 +-
 drivers/ide/ide-pci-generic.c                      |    2 +-
 drivers/ide/it8172.c                               |    2 +-
 drivers/ide/it8213.c                               |    2 +-
 drivers/ide/it821x.c                               |    2 +-
 drivers/ide/jmicron.c                              |    2 +-
 drivers/ide/ns87415.c                              |    2 +-
 drivers/ide/opti621.c                              |    2 +-
 drivers/ide/pdc202xx_new.c                         |    2 +-
 drivers/ide/pdc202xx_old.c                         |    2 +-
 drivers/ide/piix.c                                 |    2 +-
 drivers/ide/rz1000.c                               |    2 +-
 drivers/ide/sc1200.c                               |    2 +-
 drivers/ide/scc_pata.c                             |    2 +-
 drivers/ide/serverworks.c                          |    2 +-
 drivers/ide/siimage.c                              |    2 +-
 drivers/ide/sis5513.c                              |    2 +-
 drivers/ide/sl82c105.c                             |    2 +-
 drivers/ide/slc90e66.c                             |    2 +-
 drivers/ide/tc86c001.c                             |    2 +-
 drivers/ide/triflex.c                              |    2 +-
 drivers/ide/trm290.c                               |    2 +-
 drivers/ide/via82cxxx.c                            |    2 +-
 drivers/ieee1394/dv1394.c                          |    2 +-
 drivers/ieee1394/hosts.c                           |    1 +
 drivers/ieee1394/init_ohci1394_dma.c               |    2 +-
 drivers/ieee1394/ohci1394.c                        |    4 +-
 drivers/ieee1394/sbp2.c                            |    2 +-
 drivers/infiniband/core/cm.c                       |   32 +-
 drivers/infiniband/core/fmr_pool.c                 |   20 +-
 drivers/infiniband/hw/nes/nes.c                    |    4 +-
 drivers/infiniband/hw/nes/nes.h                    |   32 +-
 drivers/infiniband/hw/nes/nes_cm.c                 |   54 +-
 drivers/infiniband/hw/nes/nes_nic.c                |   32 +-
 drivers/infiniband/hw/nes/nes_verbs.c              |   10 +-
 drivers/input/gameport/gameport.c                  |    4 +-
 drivers/input/input.c                              |    4 +-
 drivers/input/joystick/sidewinder.c                |    1 +
 drivers/input/joystick/xpad.c                      |    4 +-
 drivers/input/serio/serio.c                        |    4 +-
 drivers/isdn/gigaset/common.c                      |    2 +-
 drivers/isdn/gigaset/gigaset.h                     |    3 +-
 drivers/isdn/gigaset/interface.c                   |   22 +-
 drivers/isdn/hardware/avm/b1.c                     |    4 +-
 drivers/isdn/hardware/eicon/divasync.h             |    2 +-
 drivers/isdn/hardware/eicon/xdi_adapter.h          |    2 +-
 drivers/isdn/icn/icn.c                             |    2 +-
 drivers/lguest/core.c                              |   10 +-
 drivers/lguest/x86/core.c                          |   12 +-
 drivers/lguest/x86/switcher_32.S                   |   27 +-
 drivers/macintosh/macio_asic.c                     |    2 +-
 drivers/md/dm-ioctl.c                              |    2 +-
 drivers/md/dm-raid1.c                              |   16 +-
 drivers/md/dm-stripe.c                             |   10 +-
 drivers/md/dm-table.c                              |    2 +-
 drivers/md/dm.c                                    |   16 +-
 drivers/md/md.c                                    |   28 +-
 drivers/md/md.h                                    |    6 +-
 drivers/md/raid1.c                                 |    4 +-
 drivers/md/raid10.c                                |    4 +-
 drivers/md/raid5.c                                 |   10 +-
 drivers/media/dvb/dvb-core/dvb_demux.h             |    2 +-
 drivers/media/dvb/dvb-core/dvbdev.c                |    2 +-
 drivers/media/dvb/dvb-usb/cxusb.c                  |    2 +-
 drivers/media/dvb/dvb-usb/dib0700_devices.c        |    2 +-
 drivers/media/dvb/frontends/dib3000.h              |    2 +-
 drivers/media/radio/radio-cadet.c                  |    2 +-
 drivers/media/video/cx18/cx18-driver.c             |    4 +-
 drivers/media/video/ivtv/ivtv-driver.c             |    2 +-
 drivers/media/video/omap24xxcam.c                  |    2 +-
 drivers/media/video/omap24xxcam.h                  |    2 +-
 drivers/media/video/pvrusb2/pvrusb2-hdw-internal.h |    2 +-
 drivers/media/video/usbvideo/ibmcam.c              |   18 +-
 drivers/media/video/usbvideo/konicawc.c            |   22 +-
 drivers/media/video/usbvideo/quickcam_messenger.c  |    2 +-
 drivers/media/video/usbvideo/ultracam.c            |   16 +-
 drivers/media/video/usbvideo/usbvideo.c            |   10 +-
 drivers/media/video/usbvideo/usbvideo.h            |    2 +-
 drivers/media/video/v4l2-device.c                  |    4 +-
 drivers/message/fusion/mptsas.c                    |   34 +-
 drivers/message/fusion/mptscsih.c                  |   19 +-
 drivers/message/i2o/i2o_proc.c                     |   44 +-
 drivers/message/i2o/iop.c                          |    8 +-
 drivers/mfd/ab3100-core.c                          |    2 +-
 drivers/misc/sgi-gru/gruhandles.c                  |    4 +-
 drivers/misc/sgi-gru/gruprocfs.c                   |    8 +-
 drivers/misc/sgi-gru/grutables.h                   |  158 +++---
 drivers/misc/sgi-xp/xp.h                           |    2 +-
 drivers/misc/sgi-xp/xpc.h                          |    3 +-
 drivers/misc/sgi-xp/xpc_main.c                     |    2 +-
 drivers/mmc/host/sdhci-pci.c                       |    2 +-
 drivers/mtd/devices/doc2000.c                      |    2 +-
 drivers/mtd/devices/doc2001.c                      |    2 +-
 drivers/mtd/nftlmount.c                            |    1 +
 drivers/mtd/ubi/build.c                            |   16 +-
 drivers/net/atlx/atl2.c                            |    2 +-
 drivers/net/cxgb3/l2t.h                            |    2 +-
 drivers/net/e1000e/82571.c                         |    2 +-
 drivers/net/e1000e/es2lan.c                        |    2 +-
 drivers/net/e1000e/hw.h                            |    9 +-
 drivers/net/fealnx.c                               |    2 +-
 drivers/net/igb/e1000_hw.h                         |   12 +-
 drivers/net/igbvf/vf.h                             |    6 +-
 drivers/net/ixgbe/ixgbe_type.h                     |    9 +-
 drivers/net/mlx4/main.c                            |    1 +
 drivers/net/pcnet32.c                              |  200 ++++----
 drivers/net/sis190.c                               |    2 +-
 drivers/net/sundance.c                             |    2 +-
 drivers/net/tg3.h                                  |    1 +
 drivers/net/tokenring/abyss.c                      |    8 +-
 drivers/net/tokenring/madgemc.c                    |    8 +-
 drivers/net/tokenring/proteon.c                    |    8 +-
 drivers/net/tokenring/skisa.c                      |    8 +-
 drivers/net/tulip/de4x5.c                          |    4 +-
 drivers/net/tulip/eeprom.c                         |    2 +-
 drivers/net/tulip/winbond-840.c                    |    2 +-
 drivers/net/usb/hso.c                              |   23 +-
 drivers/net/vxge/vxge-config.h                     |    2 +-
 drivers/net/vxge/vxge-traffic.h                    |    2 +-
 drivers/net/wan/hdlc_x25.c                         |   16 +-
 drivers/net/wireless/iwlwifi/iwl-agn.c             |    4 +-
 drivers/net/wireless/iwlwifi/iwl-debug.h           |    4 +-
 drivers/net/wireless/iwlwifi/iwl3945-base.c        |    4 +-
 drivers/net/wireless/rndis_wlan.c                  |    2 +-
 drivers/oprofile/buffer_sync.c                     |    8 +-
 drivers/oprofile/event_buffer.c                    |    2 +-
 drivers/oprofile/oprof.c                           |    2 +-
 drivers/oprofile/oprofile_stats.c                  |   10 +-
 drivers/oprofile/oprofile_stats.h                  |   10 +-
 drivers/oprofile/oprofilefs.c                      |    2 +-
 drivers/parport/procfs.c                           |    4 +-
 drivers/pci/hotplug/cpci_hotplug.h                 |    2 +-
 drivers/pci/hotplug/cpqphp_nvram.c                 |    4 +
 drivers/pci/pcie/aspm.c                            |    6 +-
 drivers/pci/probe.c                                |    4 +-
 drivers/pcmcia/pcmcia_ioctl.c                      |    2 +-
 drivers/platform/x86/thinkpad_acpi.c               |    2 +-
 drivers/pnp/pnpbios/bioscalls.c                    |   14 +-
 drivers/pnp/resource.c                             |    4 +-
 drivers/power/bq27x00_battery.c                    |    2 +-
 drivers/s390/cio/qdio_perf.c                       |   46 +-
 drivers/s390/cio/qdio_perf.h                       |   50 +-
 drivers/scsi/aacraid/aacraid.h                     |    2 +-
 drivers/scsi/aacraid/linit.c                       |    2 +-
 drivers/scsi/aic94xx/aic94xx_init.c                |    2 +-
 drivers/scsi/bfa/bfa_ioc.h                         |    2 +-
 drivers/scsi/bfa/bfa_iocfc.h                       |    2 +-
 drivers/scsi/fnic/fnic_main.c                      |    2 +-
 drivers/scsi/hosts.c                               |    4 +-
 drivers/scsi/ips.h                                 |    2 +-
 drivers/scsi/libfc/fc_exch.c                       |   38 +-
 drivers/scsi/lpfc/lpfc.h                           |    8 +-
 drivers/scsi/lpfc/lpfc_debugfs.c                   |   18 +-
 drivers/scsi/lpfc/lpfc_init.c                      |    6 +-
 drivers/scsi/lpfc/lpfc_scsi.c                      |   16 +-
 drivers/scsi/pmcraid.c                             |   14 +-
 drivers/scsi/pmcraid.h                             |    6 +-
 drivers/scsi/qla2xxx/qla_def.h                     |    2 +-
 drivers/scsi/qla4xxx/ql4_def.h                     |    2 +-
 drivers/scsi/qla4xxx/ql4_init.c                    |    4 +-
 drivers/scsi/qla4xxx/ql4_os.c                      |    4 +-
 drivers/scsi/scsi.c                                |    2 +-
 drivers/scsi/scsi_lib.c                            |    6 +-
 drivers/scsi/scsi_sysfs.c                          |    2 +-
 drivers/scsi/scsi_tgt_lib.c                        |    2 +-
 drivers/scsi/scsi_transport_fc.c                   |    6 +-
 drivers/scsi/scsi_transport_iscsi.c                |    6 +-
 drivers/scsi/scsi_transport_srp.c                  |    6 +-
 drivers/scsi/sg.c                                  |    4 +-
 drivers/serial/kgdboc.c                            |    2 +-
 drivers/spi/spi.c                                  |    2 +-
 drivers/staging/dst/dcore.c                        |    2 +-
 drivers/staging/dst/trans.c                        |    2 +-
 drivers/staging/et131x/et1310_tx.c                 |    6 +-
 drivers/staging/et131x/et131x_adapter.h            |    6 +-
 drivers/staging/hv/Channel.c                       |    4 +-
 drivers/staging/hv/Hv.c                            |    2 +-
 drivers/staging/hv/VmbusApi.h                      |    2 +-
 drivers/staging/hv/VmbusPrivate.h                  |    2 +-
 drivers/staging/hv/vmbus_drv.c                     |    4 +-
 drivers/staging/iio/ring_generic.h                 |    2 +-
 drivers/staging/octeon/ethernet-rx.c               |   12 +-
 drivers/staging/octeon/ethernet.c                  |    8 +-
 drivers/staging/otus/80211core/pub_zfi.h           |    2 +-
 drivers/staging/pohmelfs/inode.c                   |    4 +-
 drivers/staging/pohmelfs/mcache.c                  |    2 +-
 drivers/staging/pohmelfs/netfs.h                   |    4 +-
 drivers/staging/pohmelfs/trans.c                   |    2 +-
 drivers/staging/usbip/usbip_common.h               |    2 +-
 drivers/staging/usbip/vhci.h                       |    2 +-
 drivers/staging/usbip/vhci_hcd.c                   |    6 +-
 drivers/staging/usbip/vhci_rx.c                    |    2 +-
 drivers/staging/vt6655/hostap.c                    |    2 +-
 drivers/staging/vt6656/hostap.c                    |    2 +-
 drivers/staging/wlan-ng/hfa384x_usb.c              |    2 +-
 drivers/uio/uio.c                                  |   21 +-
 drivers/usb/atm/usbatm.c                           |   24 +-
 drivers/usb/class/cdc-wdm.c                        |    2 +-
 drivers/usb/core/message.c                         |    4 +-
 drivers/usb/wusbcore/wa-hc.h                       |    4 +-
 drivers/usb/wusbcore/wa-xfer.c                     |    2 +-
 drivers/uwb/wlp/messages.c                         |    2 +-
 drivers/video/aty/aty128fb.c                       |    2 +-
 drivers/video/fbcmap.c                             |    3 +-
 drivers/video/fbmem.c                              |    6 +-
 drivers/video/geode/gx1fb_core.c                   |    2 +-
 drivers/video/gxt4500.c                            |    4 +-
 drivers/video/i810/i810_accel.c                    |    1 +
 drivers/video/i810/i810_main.c                     |    2 +-
 drivers/video/uvesafb.c                            |   36 ++-
 drivers/video/vesafb.c                             |   51 ++-
 fs/9p/vfs_inode.c                                  |    2 +-
 fs/Kconfig.binfmt                                  |    2 +-
 fs/aio.c                                           |    9 +-
 fs/autofs/root.c                                   |    3 +-
 fs/autofs4/symlink.c                               |    2 +-
 fs/autofs4/waitq.c                                 |    2 +-
 fs/befs/linuxvfs.c                                 |    2 +-
 fs/binfmt_aout.c                                   |   23 +-
 fs/binfmt_elf.c                                    |  431 +++++++++++++-
 fs/binfmt_flat.c                                   |    6 +
 fs/bio.c                                           |    4 +-
 fs/block_dev.c                                     |    2 +-
 fs/btrfs/ctree.c                                   |   10 +-
 fs/btrfs/free-space-cache.c                        |    4 +-
 fs/btrfs/relocation.c                              |    2 +-
 fs/cachefiles/bind.c                               |    6 +-
 fs/cachefiles/daemon.c                             |    6 +-
 fs/cachefiles/internal.h                           |   12 +-
 fs/cachefiles/namei.c                              |    2 +-
 fs/cachefiles/proc.c                               |   12 +-
 fs/cachefiles/rdwr.c                               |    2 +-
 fs/cifs/cifs_debug.c                               |   86 ++--
 fs/cifs/cifsfs.c                                   |    8 +-
 fs/cifs/cifsglob.h                                 |   50 +-
 fs/cifs/link.c                                     |    2 +-
 fs/cifs/misc.c                                     |    4 +-
 fs/coda/cache.c                                    |   10 +-
 fs/compat.c                                        |   12 +-
 fs/compat_binfmt_elf.c                             |    2 +
 fs/compat_ioctl.c                                  |    6 +-
 fs/configfs/dir.c                                  |   10 +-
 fs/dcache.c                                        |    4 +-
 fs/ecryptfs/inode.c                                |    4 +-
 fs/exec.c                                          |  297 +++++++++--
 fs/ext4/ext4.h                                     |   20 +-
 fs/ext4/mballoc.c                                  |   44 +-
 fs/fcntl.c                                         |    4 +-
 fs/fifo.c                                          |   22 +-
 fs/fs_struct.c                                     |   12 +-
 fs/fscache/cookie.c                                |   34 +-
 fs/fscache/internal.h                              |  182 +++---
 fs/fscache/object.c                                |   26 +-
 fs/fscache/operation.c                             |   28 +-
 fs/fscache/page.c                                  |  106 ++--
 fs/fscache/stats.c                                 |  330 ++++++------
 fs/fuse/cuse.c                                     |   10 +-
 fs/fuse/dev.c                                      |   17 +-
 fs/fuse/dir.c                                      |    2 +-
 fs/ioctl.c                                         |    6 +-
 fs/jffs2/erase.c                                   |    3 +-
 fs/jffs2/wbuf.c                                    |    3 +-
 fs/jfs/super.c                                     |    2 +-
 fs/libfs.c                                         |   10 +-
 fs/lockd/clntproc.c                                |    4 +-
 fs/locks.c                                         |    8 +-
 fs/mbcache.c                                       |    4 +-
 fs/namei.c                                         |   13 +-
 fs/nfs/inode.c                                     |    8 +-
 fs/nfsd/vfs.c                                      |    6 +-
 fs/nilfs2/ioctl.c                                  |    2 +-
 fs/notify/notification.c                           |    4 +-
 fs/ntfs/dir.c                                      |    2 +-
 fs/ntfs/file.c                                     |    4 +-
 fs/ocfs2/localalloc.c                              |    2 +-
 fs/ocfs2/ocfs2.h                                   |   10 +-
 fs/ocfs2/suballoc.c                                |   10 +-
 fs/ocfs2/super.c                                   |   20 +-
 fs/pipe.c                                          |   33 +-
 fs/proc/array.c                                    |   20 +
 fs/proc/base.c                                     |    2 +-
 fs/proc/kcore.c                                    |   32 +-
 fs/proc/meminfo.c                                  |    2 +-
 fs/proc/nommu.c                                    |    2 +-
 fs/proc/task_mmu.c                                 |   41 +-
 fs/proc/task_nommu.c                               |    4 +-
 fs/readdir.c                                       |    2 +-
 fs/reiserfs/do_balan.c                             |    2 +-
 fs/reiserfs/procfs.c                               |    2 +-
 fs/seq_file.c                                      |   14 +-
 fs/smbfs/proc.c                                    |   10 +-
 fs/smbfs/symlink.c                                 |    2 +-
 fs/splice.c                                        |   36 +-
 fs/sysfs/file.c                                    |   10 +-
 fs/sysfs/symlink.c                                 |    2 +-
 fs/udf/balloc.c                                    |    8 +-
 fs/udf/misc.c                                      |    2 +-
 fs/xattr_acl.c                                     |    4 +-
 fs/xfs/linux-2.6/xfs_ioctl.c                       |    4 +-
 fs/xfs/linux-2.6/xfs_iops.c                        |    2 +-
 fs/xfs/xfs_bmap.c                                  |    2 +-
 fs/xfs/xfs_dir2_sf.c                               |   10 +-
 include/acpi/acpi_bus.h                            |    2 +-
 include/asm-generic/atomic-long.h                  |  163 ++++++
 include/asm-generic/cache.h                        |    4 +-
 include/asm-generic/futex.h                        |    4 +-
 include/asm-generic/int-l64.h                      |    2 +
 include/asm-generic/int-ll64.h                     |    2 +
 include/asm-generic/kmap_types.h                   |    3 +-
 include/asm-generic/pgtable-nopmd.h                |   18 +-
 include/asm-generic/pgtable-nopud.h                |   14 +-
 include/asm-generic/pgtable.h                      |    8 +
 include/asm-generic/vmlinux.lds.h                  |   13 +-
 include/drm/drmP.h                                 |   11 +-
 include/drm/drm_crtc_helper.h                      |    4 +-
 include/drm/ttm/ttm_memory.h                       |    2 +-
 include/linux/a.out.h                              |    8 +
 include/linux/atmdev.h                             |    2 +-
 include/linux/binfmts.h                            |    1 +
 include/linux/blkdev.h                             |    2 +-
 include/linux/blktrace_api.h                       |    2 +-
 include/linux/byteorder/little_endian.h            |   24 +-
 include/linux/cache.h                              |    4 +
 include/linux/compiler-gcc4.h                      |   12 +
 include/linux/compiler.h                           |   51 ++-
 include/linux/crypto.h                             |    6 +-
 include/linux/dcache.h                             |    2 +
 include/linux/decompress/mm.h                      |    2 +-
 include/linux/dma-mapping.h                        |    2 +-
 include/linux/dst.h                                |    2 +-
 include/linux/elf.h                                |   30 +
 include/linux/fs.h                                 |    5 +-
 include/linux/fs_struct.h                          |    2 +-
 include/linux/fscache-cache.h                      |    4 +-
 include/linux/ftrace_event.h                       |    2 +-
 include/linux/genhd.h                              |    2 +-
 include/linux/hdpu_features.h                      |    2 +-
 include/linux/highmem.h                            |   12 +
 include/linux/i2c.h                                |    1 +
 include/linux/i2o.h                                |    2 +-
 include/linux/init_task.h                          |    7 +
 include/linux/intel-iommu.h                        |    2 +-
 include/linux/interrupt.h                          |    6 +-
 include/linux/irq.h                                |    2 +-
 include/linux/kgdb.h                               |    8 +-
 include/linux/kvm_host.h                           |    4 +-
 include/linux/libata.h                             |    2 +-
 include/linux/mca.h                                |    2 +-
 include/linux/memory.h                             |    2 +-
 include/linux/mm.h                                 |   29 +-
 include/linux/mm_types.h                           |   20 +
 include/linux/mmu_notifier.h                       |    6 +-
 include/linux/mmzone.h                             |    2 +-
 include/linux/mod_devicetable.h                    |    4 +-
 include/linux/module.h                             |   51 ++-
 include/linux/moduleloader.h                       |   12 +
 include/linux/moduleparam.h                        |    4 +-
 include/linux/mutex.h                              |    2 +-
 include/linux/namei.h                              |    6 +-
 include/linux/netdevice.h                          |    1 +
 include/linux/nodemask.h                           |    8 +-
 include/linux/oprofile.h                           |    4 +-
 include/linux/pagemap.h                            |    1 +
 include/linux/perf_event.h                         |    8 +-
 include/linux/pipe_fs_i.h                          |    6 +-
 include/linux/poison.h                             |    4 +-
 include/linux/posix-timers.h                       |    2 +-
 include/linux/preempt.h                            |    2 +-
 include/linux/proc_fs.h                            |    2 +-
 include/linux/random.h                             |    5 +
 include/linux/reboot.h                             |   14 +-
 include/linux/reiserfs_fs.h                        |    2 +-
 include/linux/reiserfs_fs_sb.h                     |    2 +-
 include/linux/relay.h                              |    2 +-
 include/linux/rfkill.h                             |    1 +
 include/linux/sched.h                              |   71 +++-
 include/linux/screen_info.h                        |    3 +-
 include/linux/seq_file.h                           |    1 +
 include/linux/skbuff.h                             |    8 +-
 include/linux/slab.h                               |   51 ++-
 include/linux/slab_def.h                           |    8 +-
 include/linux/slub_def.h                           |    4 +-
 include/linux/sonet.h                              |    2 +-
 include/linux/sunrpc/cache.h                       |    2 +-
 include/linux/sunrpc/clnt.h                        |    8 +-
 include/linux/sunrpc/svc_rdma.h                    |   18 +-
 include/linux/sysctl.h                             |    6 +-
 include/linux/thread_info.h                        |    2 +-
 include/linux/tty_ldisc.h                          |    2 +-
 include/linux/types.h                              |   16 +
 include/linux/uaccess.h                            |   10 +-
 include/linux/unaligned/access_ok.h                |   12 +-
 include/linux/vermagic.h                           |   21 +-
 include/linux/vmalloc.h                            |   77 +++
 include/linux/vmstat.h                             |   20 +-
 include/media/saa7146_vv.h                         |    2 +-
 include/media/v4l2-dev.h                           |    3 +-
 include/media/v4l2-device.h                        |    2 +-
 include/media/v4l2-ioctl.h                         |    1 +
 include/net/flow.h                                 |    2 +-
 include/net/inetpeer.h                             |    2 +-
 include/net/ip_vs.h                                |    4 +-
 include/net/irda/ircomm_core.h                     |    2 +-
 include/net/irda/ircomm_tty.h                      |    5 +-
 include/net/iucv/af_iucv.h                         |    2 +-
 include/net/lapb.h                                 |    2 +-
 include/net/neighbour.h                            |    2 +-
 include/net/netlink.h                              |    2 +-
 include/net/netns/ipv4.h                           |    2 +-
 include/net/sctp/sctp.h                            |    4 +-
 include/net/sock.h                                 |    2 +-
 include/net/tcp.h                                  |    4 +-
 include/net/udp.h                                  |    4 +-
 include/rdma/iw_cm.h                               |    2 +-
 include/scsi/libfc.h                               |    3 +-
 include/scsi/scsi_device.h                         |    6 +-
 include/scsi/scsi_transport_fc.h                   |    2 +-
 include/sound/ak4xxx-adda.h                        |    2 +-
 include/sound/hwdep.h                              |    2 +-
 include/sound/info.h                               |    2 +-
 include/sound/pcm.h                                |    1 +
 include/sound/sb16_csp.h                           |    2 +-
 include/sound/ymfpci.h                             |    2 +-
 include/trace/events/irq.h                         |    8 +-
 include/video/uvesafb.h                            |    1 +
 init/Kconfig                                       |    2 +-
 init/do_mounts.c                                   |   14 +-
 init/do_mounts.h                                   |    8 +-
 init/do_mounts_initrd.c                            |   30 +-
 init/do_mounts_md.c                                |    6 +-
 init/initramfs.c                                   |   40 +-
 init/main.c                                        |   78 ++-
 init/noinitramfs.c                                 |    4 +-
 ipc/msg.c                                          |   11 +-
 ipc/sem.c                                          |   11 +-
 ipc/shm.c                                          |   11 +-
 kernel/acct.c                                      |    2 +-
 kernel/audit.c                                     |    8 +-
 kernel/auditsc.c                                   |    4 +-
 kernel/compat.c                                    |   42 +-
 kernel/cpu.c                                       |    2 +-
 kernel/exit.c                                      |    4 +-
 kernel/fork.c                                      |   38 +-
 kernel/futex.c                                     |   13 +-
 kernel/gcov/base.c                                 |    7 +-
 kernel/hrtimer.c                                   |    2 +-
 kernel/kallsyms.c                                  |   39 ++-
 kernel/kexec.c                                     |    3 +-
 kernel/kgdb.c                                      |   16 +-
 kernel/kmod.c                                      |    2 +-
 kernel/kprobes.c                                   |    8 +-
 kernel/lockdep.c                                   |   38 +-
 kernel/lockdep_internals.h                         |   40 +-
 kernel/lockdep_proc.c                              |    2 +-
 kernel/module.c                                    |  272 ++++++---
 kernel/mutex-debug.c                               |   14 +-
 kernel/mutex-debug.h                               |    6 +-
 kernel/mutex.c                                     |    9 +-
 kernel/mutex.h                                     |    2 +-
 kernel/panic.c                                     |    3 +-
 kernel/perf_event.c                                |   68 ++--
 kernel/pid.c                                       |    2 +-
 kernel/posix-cpu-timers.c                          |    4 +-
 kernel/posix-timers.c                              |   26 +-
 kernel/power/poweroff.c                            |    2 +-
 kernel/power/process.c                             |   15 +-
 kernel/profile.c                                   |   14 +-
 kernel/ptrace.c                                    |    8 +-
 kernel/rcutorture.c                                |   56 +-
 kernel/rcutree.c                                   |    2 +-
 kernel/rcutree_plugin.h                            |    4 +-
 kernel/relay.c                                     |    3 +-
 kernel/rtmutex-tester.c                            |   24 +-
 kernel/rtmutex.c                                   |    2 +-
 kernel/sched.c                                     |   12 +-
 kernel/signal.c                                    |    8 +-
 kernel/smp.c                                       |    8 +-
 kernel/softirq.c                                   |   14 +-
 kernel/sys.c                                       |   10 +-
 kernel/sysctl.c                                    |   32 +
 kernel/time.c                                      |    4 +-
 kernel/time/tick-broadcast.c                       |    2 +-
 kernel/time/timekeeping.c                          |    2 +-
 kernel/time/timer_stats.c                          |   10 +-
 kernel/timer.c                                     |    2 +-
 kernel/trace/blktrace.c                            |    6 +-
 kernel/trace/ftrace.c                              |    9 +-
 kernel/trace/ring_buffer.c                         |    2 +-
 kernel/trace/trace.c                               |    6 +-
 kernel/trace/trace_events.c                        |   26 +-
 kernel/trace/trace_mmiotrace.c                     |    8 +-
 kernel/trace/trace_output.c                        |    2 +-
 kernel/trace/trace_stack.c                         |    2 +-
 kernel/trace/trace_workqueue.c                     |    6 +-
 lib/bitmap.c                                       |    4 +-
 lib/bug.c                                          |    2 +
 lib/debugobjects.c                                 |    2 +-
 lib/devres.c                                       |    4 +-
 lib/dma-debug.c                                    |    2 +-
 lib/idr.c                                          |    2 +-
 lib/inflate.c                                      |    2 +-
 lib/kref.c                                         |    2 +-
 lib/parser.c                                       |    2 +-
 lib/radix-tree.c                                   |    2 +-
 lib/random32.c                                     |    2 +-
 lib/vsprintf.c                                     |   16 +-
 mm/Kconfig                                         |    6 +-
 mm/backing-dev.c                                   |    2 +-
 mm/filemap.c                                       |    2 +-
 mm/fremap.c                                        |    7 +-
 mm/highmem.c                                       |    7 +-
 mm/hugetlb.c                                       |   51 ++
 mm/internal.h                                      |    1 +
 mm/maccess.c                                       |    8 +-
 mm/madvise.c                                       |   41 ++
 mm/memory-failure.c                                |    6 +-
 mm/memory.c                                        |  345 ++++++++++--
 mm/mempolicy.c                                     |   27 +-
 mm/mlock.c                                         |   37 +-
 mm/mmap.c                                          |  605 +++++++++++++++++---
 mm/mprotect.c                                      |  133 +++++-
 mm/mremap.c                                        |   45 ++-
 mm/nommu.c                                         |   10 -
 mm/page_alloc.c                                    |   21 +-
 mm/percpu.c                                        |    2 +-
 mm/rmap.c                                          |   11 +
 mm/shmem.c                                         |    7 +-
 mm/slab.c                                          |   79 ++-
 mm/slob.c                                          |  180 +++++-
 mm/slub.c                                          |   77 ++-
 mm/swap.c                                          |    3 +
 mm/util.c                                          |    6 +
 mm/vmalloc.c                                       |   93 +++-
 mm/vmstat.c                                        |    6 +-
 net/8021q/vlan.c                                   |    3 +-
 net/9p/trans_fd.c                                  |    2 +-
 net/atm/atm_misc.c                                 |    8 +-
 net/atm/lec.h                                      |    2 +-
 net/atm/mpc.h                                      |    2 +-
 net/atm/proc.c                                     |    6 +-
 net/atm/resources.c                                |    4 +-
 net/bridge/br_stp_if.c                             |    2 +-
 net/compat.c                                       |   26 +-
 net/core/dev.c                                     |    6 +-
 net/core/flow.c                                    |   14 +-
 net/core/rtnetlink.c                               |    2 +-
 net/core/scm.c                                     |    8 +-
 net/core/sock.c                                    |    8 +-
 net/decnet/sysctl_net_decnet.c                     |    4 +-
 net/ieee802154/dgram.c                             |    2 +-
 net/ieee802154/raw.c                               |    2 +-
 net/ipv4/inetpeer.c                                |    2 +-
 net/ipv4/ip_fragment.c                             |    2 +-
 net/ipv4/ip_sockglue.c                             |    2 +-
 net/ipv4/ipconfig.c                                |    6 +-
 net/ipv4/netfilter/nf_nat_snmp_basic.c             |    2 +-
 net/ipv4/raw.c                                     |   16 +-
 net/ipv4/route.c                                   |    6 +-
 net/ipv4/tcp_probe.c                               |    2 +-
 net/ipv4/udp.c                                     |    4 +-
 net/ipv6/addrconf.c                                |    2 +-
 net/ipv6/inet6_connection_sock.c                   |    4 +-
 net/ipv6/inet6_hashtables.c                        |    2 +-
 net/ipv6/ipv6_sockglue.c                           |    2 +-
 net/ipv6/raw.c                                     |   23 +-
 net/ipv6/udp.c                                     |    4 +-
 net/irda/ircomm/ircomm_tty.c                       |   38 +-
 net/iucv/af_iucv.c                                 |    4 +-
 net/lapb/lapb_iface.c                              |   26 +-
 net/mac80211/ieee80211_i.h                         |    3 +-
 net/mac80211/iface.c                               |   12 +-
 net/mac80211/main.c                                |    2 +-
 net/mac80211/pm.c                                  |    2 +-
 net/mac80211/rate.c                                |    2 +-
 net/mac80211/tx.c                                  |    2 +-
 net/mac80211/util.c                                |    2 +-
 net/netfilter/ipvs/ip_vs_app.c                     |    2 +-
 net/netfilter/ipvs/ip_vs_conn.c                    |   12 +-
 net/netfilter/ipvs/ip_vs_core.c                    |    4 +-
 net/netfilter/ipvs/ip_vs_ctl.c                     |   14 +-
 net/netfilter/ipvs/ip_vs_sync.c                    |    2 +-
 net/netfilter/ipvs/ip_vs_xmit.c                    |    4 +-
 net/netfilter/nf_conntrack_netlink.c               |    2 +-
 net/netfilter/nfnetlink_log.c                      |    4 +-
 net/netlink/af_netlink.c                           |    4 +-
 net/phonet/datagram.c                              |    2 +-
 net/phonet/pep.c                                   |    6 +-
 net/phonet/socket.c                                |    2 +-
 net/rds/cong.c                                     |    6 +-
 net/rds/tcp.c                                      |    2 +-
 net/rds/tcp_send.c                                 |    2 +-
 net/rxrpc/af_rxrpc.c                               |    2 +-
 net/rxrpc/ar-ack.c                                 |   14 +-
 net/rxrpc/ar-call.c                                |    2 +-
 net/rxrpc/ar-connection.c                          |    2 +-
 net/rxrpc/ar-connevent.c                           |    2 +-
 net/rxrpc/ar-input.c                               |    4 +-
 net/rxrpc/ar-internal.h                            |    8 +-
 net/rxrpc/ar-local.c                               |    2 +-
 net/rxrpc/ar-output.c                              |    4 +-
 net/rxrpc/ar-peer.c                                |    2 +-
 net/rxrpc/ar-proc.c                                |    4 +-
 net/rxrpc/ar-transport.c                           |    2 +-
 net/rxrpc/rxkad.c                                  |    4 +-
 net/sctp/socket.c                                  |    1 -
 net/socket.c                                       |    2 +-
 net/sunrpc/sched.c                                 |    4 +-
 net/sunrpc/xprtrdma/svc_rdma.c                     |   38 +-
 net/sunrpc/xprtrdma/svc_rdma_recvfrom.c            |    6 +-
 net/sunrpc/xprtrdma/svc_rdma_sendto.c              |    2 +-
 net/sunrpc/xprtrdma/svc_rdma_transport.c           |   10 +-
 net/tipc/link.c                                    |    4 +-
 net/tipc/subscr.c                                  |    2 +-
 net/wireless/core.h                                |    2 +-
 net/wireless/wext.c                                |   19 +-
 net/xfrm/xfrm_policy.c                             |   20 +-
 scripts/Makefile.build                             |    2 +-
 scripts/Makefile.clean                             |    3 +-
 scripts/Makefile.host                              |    2 +
 scripts/basic/fixdep.c                             |   10 +-
 scripts/gcc-plugin.sh                              |    2 +
 scripts/mod/file2alias.c                           |   14 +-
 scripts/mod/modpost.c                              |   25 +-
 scripts/mod/modpost.h                              |    6 +-
 scripts/mod/sumversion.c                           |    2 +-
 scripts/package/mkspec                             |    2 +-
 scripts/pnmtologo.c                                |    6 +-
 scripts/tags.sh                                    |    9 +
 security/Kconfig                                   |  582 +++++++++++++++++++-
 security/capability.c                              |    2 +-
 security/integrity/ima/ima.h                       |    4 +-
 security/integrity/ima/ima_api.c                   |    2 +-
 security/integrity/ima/ima_fs.c                    |    4 +-
 security/integrity/ima/ima_queue.c                 |    2 +-
 security/keys/keyring.c                            |    6 +-
 security/root_plug.c                               |    2 +-
 security/security.c                                |    4 +-
 security/selinux/hooks.c                           |    6 +-
 security/selinux/include/xfrm.h                    |    2 +-
 security/smack/smack_lsm.c                         |    2 +-
 security/tomoyo/tomoyo.c                           |    2 +-
 sound/aoa/codecs/onyx.c                            |    7 +-
 sound/aoa/codecs/onyx.h                            |    1 +
 sound/core/oss/pcm_oss.c                           |    4 +-
 sound/core/pcm_compat.c                            |    2 +-
 sound/core/pcm_native.c                            |    4 +-
 sound/core/seq/seq_device.c                        |    8 +-
 sound/drivers/mts64.c                              |   14 +-
 sound/drivers/opl4/opl4_lib.c                      |    2 +-
 sound/drivers/portman2x4.c                         |    3 +-
 sound/isa/cmi8330.c                                |    2 +-
 sound/oss/sb_audio.c                               |    2 +-
 sound/oss/swarm_cs4297a.c                          |    6 +-
 sound/pci/hda/hda_codec.h                          |    7 +-
 sound/pci/hda/patch_atihdmi.c                      |    2 +-
 sound/pci/hda/patch_intelhdmi.c                    |   10 +-
 sound/pci/hda/patch_nvhdmi.c                       |    4 +-
 sound/pci/hda/patch_sigmatel.c                     |    4 +-
 sound/pci/ice1712/ice1712.h                        |    4 +-
 sound/pci/intel8x0m.c                              |    2 +-
 sound/pci/ymfpci/ymfpci_main.c                     |   12 +-
 sound/soc/soc-core.c                               |    2 +-
 sound/usb/usbaudio.c                               |   18 +-
 tools/gcc/Makefile                                 |   21 +
 tools/gcc/checker_plugin.c                         |  171 ++++++
 tools/gcc/constify_plugin.c                        |  303 ++++++++++
 tools/gcc/kallocstat_plugin.c                      |  167 ++++++
 tools/gcc/kernexec_plugin.c                        |  348 +++++++++++
 tools/gcc/stackleak_plugin.c                       |  291 ++++++++++
 usr/gen_init_cpio.c                                |    7 +-
 virt/kvm/kvm_main.c                                |   14 +-
 1158 files changed, 17506 insertions(+), 5814 deletions(-)
